(()=>{var __webpack_modules__={466:(e,t,n)=>{"use strict";const{Duplex:r,Readable:i,Writable:s}=n(781);const{CHANNEL_EXTENDED_DATATYPE:{STDERR:o}}=n(480);const{bufferSlice:f}=n(775);const h=32*1024;const u=2*1024*1024;const l=u/2;class ClientStderr extends i{constructor(e,t){super(t);this._channel=e}_read(e){if(this._channel._waitChanDrain){this._channel._waitChanDrain=false;if(this._channel.incoming.window<=l)windowAdjust(this._channel)}}}class ServerStderr extends s{constructor(e){super({highWaterMark:u});this._channel=e}_write(e,t,n){const r=this._channel;const i=r._client._protocol;const s=r.outgoing;const h=s.packetSize;const u=s.id;let l=s.window;const g=e.length;let p=0;if(s.state!=="open")return;while(g-p>0&&l>0){let t=g-p;if(t>l)t=l;if(t>h)t=h;if(p===0&&t===g)i.channelExtData(u,e,o);else i.channelExtData(u,f(e,p,p+t),o);p+=t;l-=t}s.window=l;if(g-p>0){if(l===0)r._waitWindow=true;if(p>0)r._chunkErr=f(e,p,g);else r._chunkErr=e;r._chunkcbErr=n;return}n()}}class Channel extends r{constructor(e,t,n){const r={highWaterMark:u,allowHalfOpen:!n||n&&n.allowHalfOpen!==false,emitClose:false};super(r);this.allowHalfOpen=r.allowHalfOpen;const i=!!(n&&n.server);this.server=i;this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this._callbacks=[];this._client=e;this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this.stdin=this.stdout=this;if(i)this.stderr=new ServerStderr(this);else this.stderr=new ClientStderr(this,r);this._waitWindow=false;this._waitChanDrain=false;this._chunk=undefined;this._chunkcb=undefined;this._chunkErr=undefined;this._chunkcbErr=undefined;this.on("finish",onFinish).on("prefinish",onFinish);this.on("end",onEnd).on("close",onEnd)}_read(e){if(this._waitChanDrain){this._waitChanDrain=false;if(this.incoming.window<=l)windowAdjust(this)}}_write(e,t,n){const r=this._client._protocol;const i=this.outgoing;const s=i.packetSize;const o=i.id;let h=i.window;const u=e.length;let l=0;if(i.state!=="open")return;while(u-l>0&&h>0){let t=u-l;if(t>h)t=h;if(t>s)t=s;if(l===0&&t===u)r.channelData(o,e);else r.channelData(o,f(e,l,l+t));l+=t;h-=t}i.window=h;if(u-l>0){if(h===0)this._waitWindow=true;if(l>0)this._chunk=f(e,l,u);else this._chunk=e;this._chunkcb=n;return}n()}eof(){if(this.outgoing.state==="open"){this.outgoing.state="eof";this._client._protocol.channelEOF(this.outgoing.id)}}close(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._client._protocol.channelClose(this.outgoing.id)}}destroy(){this.end();this.close();return this}setWindow(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"){this._client._protocol.windowChange(this.outgoing.id,e,t,n,r)}}signal(e){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){this._client._protocol.signal(this.outgoing.id,e)}}exit(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){if(typeof e==="number"){this._client._protocol.exitStatus(this.outgoing.id,e)}else{this._client._protocol.exitSignal(this.outgoing.id,e,t,n)}}}}function onFinish(){this.eof();if(this.server||!this.allowHalfOpen)this.close();this.writable=false}function onEnd(){this.readable=false}function windowAdjust(e){if(e.outgoing.state==="closed")return;const t=u-e.incoming.window;if(t<=0)return;e.incoming.window+=t;e._client._protocol.channelWindowAdjust(e.outgoing.id,t)}e.exports={Channel:Channel,MAX_WINDOW:u,PACKET_SIZE:h,windowAdjust:windowAdjust,WINDOW_THRESHOLD:l}},997:(e,t,n)=>{"use strict";const{Socket:r}=n(808);const{Duplex:i}=n(781);const{resolve:s}=n(17);const{readFile:o}=n(147);const{execFile:f,spawn:h}=n(81);const{isParsedKey:u,parseKey:l}=n(613);const{makeBufferParser:g,readUInt32BE:p,writeUInt32BE:_,writeUInt32LE:E}=n(775);function once(e){let t=false;return(...n)=>{if(t)return;t=true;e(...n)}}function concat(e,t){const n=Buffer.allocUnsafe(e.length+t.length);e.copy(n,0);t.copy(n,e.length);return n}function noop(){}const y=Buffer.alloc(0);const I=g();class BaseAgent{getIdentities(e){e(new Error("Missing getIdentities() implementation"))}sign(e,t,n,r){if(typeof n==="function")r=n;r(new Error("Missing sign() implementation"))}}class OpenSSHAgent extends BaseAgent{constructor(e){super();this.socketPath=e}getStream(e){e=once(e);const t=new r;t.on("connect",(()=>{e(null,t)}));t.on("close",onFail).on("end",onFail).on("error",onFail);t.connect(this.socketPath);function onFail(){try{t.destroy()}catch{}e(new Error("Failed to connect to agent"))}}getIdentities(e){e=once(e);this.getStream(((t,n)=>{function onFail(t){if(n){try{n.destroy()}catch{}}if(!t)t=new Error("Failed to retrieve identities from agent");e(t)}if(t)return onFail(t);const r=new C(true);r.on("error",onFail);r.pipe(n).pipe(r);n.on("close",onFail).on("end",onFail).on("error",onFail);r.getIdentities(((t,r)=>{if(t)return onFail(t);try{n.destroy()}catch{}e(null,r)}))}))}sign(e,t,n,r){if(typeof n==="function"){r=n;n=undefined}else if(typeof n!=="object"||n===null){n=undefined}r=once(r);this.getStream(((i,s)=>{function onFail(e){if(s){try{s.destroy()}catch{}}if(!e)e=new Error("Failed to sign data with agent");r(e)}if(i)return onFail(i);const o=new C(true);o.on("error",onFail);o.pipe(s).pipe(o);s.on("close",onFail).on("end",onFail).on("error",onFail);o.sign(e,t,n,((e,t)=>{if(e)return onFail(e);try{s.destroy()}catch{}r(null,t)}))}))}}const b=(()=>{const e=10;const t=11;const n=12;const r=13;const o=14;const f=15;const u=s(__dirname,"..","util/pagent.exe");const l={[e]:new Error("Invalid pagent.exe arguments"),[t]:new Error("Pageant is not running"),[n]:new Error("pagent.exe could not create an mmap"),[r]:new Error("pagent.exe could not set mode for stdin"),[o]:new Error("pagent.exe could not set mode for stdout"),[f]:new Error("pagent.exe did not get expected input payload")};function destroy(e){e.buffer=null;if(e.proc){e.proc.kill();e.proc=undefined}}class PageantSocket extends i{constructor(){super();this.proc=undefined;this.buffer=null}_read(e){}_write(e,t,n){if(this.buffer===null){this.buffer=e}else{const t=Buffer.allocUnsafe(this.buffer.length+e.length);this.buffer.copy(t,0);e.copy(t,this.buffer.length);this.buffer=t}if(this.buffer.length<4)return n();const r=p(this.buffer,0);if(this.buffer.length-4<r)return n();e=this.buffer.slice(0,4+r);if(this.buffer.length>4+r)return n(new Error("Unexpected multiple agent requests"));this.buffer=null;let i;const s=this.proc=h(u,[e.length]);s.stdout.on("data",(e=>{this.push(e)}));s.on("error",(e=>{i=e;n(i)}));s.on("close",(e=>{this.proc=undefined;if(!i){if(i=l[e])return n(i);n()}}));s.stdin.end(e)}_final(e){destroy(this);e()}_destroy(e,t){destroy(this);t()}}return class PageantAgent extends OpenSSHAgent{getStream(e){e(null,new PageantSocket)}}})();const w=(()=>{const e=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class CygwinAgent extends OpenSSHAgent{getStream(t){t=once(t);let n=this.socketPath;let i=false;o(n,(function readCygsocket(s,h){if(s){if(i)return t(new Error("Invalid cygwin unix socket path"));f("cygpath",["-w",n],((e,r,s)=>{if(e||r.length===0)return t(new Error("Invalid cygwin unix socket path"));i=true;n=r.toString().replace(/[\r\n]/g,"");o(n,readCygsocket)}));return}const u=e.exec(h.toString("ascii"));if(!u)return t(new Error("Malformed cygwin unix socket file"));let l;let g=0;let _=false;const y=[];let I;let b=Buffer.alloc(12);const w=parseInt(u[1],10);const m=u[2].replace(/-/g,"");const C=Buffer.allocUnsafe(16);for(let e=0,t=0;t<32;++e,t+=2)C[e]=parseInt(m.substring(t,t+2),16);for(let e=0;e<16;e+=4)E(C,p(C,e),e);tryConnect();function _onconnect(){g=0;l="secret";I.write(C)}function _ondata(e){g+=e.length;if(l==="secret"){if(g===16){g=0;l="creds";I.write(b)}return}if(l==="creds"){if(!_)y.push(e);if(g===12){I.removeListener("connect",_onconnect);I.removeListener("data",_ondata);I.removeListener("error",onFail);I.removeListener("end",onFail);I.removeListener("close",onFail);if(_)return t(null,I);_=true;b=Buffer.concat(y);E(b,process.pid,0);I.on("error",(()=>{}));I.destroy();tryConnect()}}}function onFail(){t(new Error("Problem negotiating cygwin unix socket security"))}function tryConnect(){I=new r;I.on("connect",_onconnect);I.on("data",_ondata);I.on("error",onFail);I.on("end",onFail);I.on("close",onFail);I.connect(w)}}))}}})();const m=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function createAgent(e){if(process.platform==="win32"&&!m.test(e)){return e==="pageant"?new b:new w(e)}return new OpenSSHAgent(e)}const C=(()=>{const e=11;const t=13;const n=5;const r=12;const s=14;const o=1<<1;const f=1<<2;const h=0;const g=1;function processResponses(e){let t;while(e[m].length){const n=e[m][0][b];if(n===undefined)break;e[m].shift();t=e.push(n)}return t}const E=Symbol("Inbound Request Type");const b=Symbol("Inbound Request Response");const w=Symbol("Inbound Request Context");class AgentInboundRequest{constructor(e,t){this[E]=e;this[b]=undefined;this[w]=t}hasResponded(){return this[b]!==undefined}getType(){return this[E]}getContext(){return this[w]}}function respond(e,t,n){t[b]=n;return processResponses(e)}function cleanup(e){e[B]=null;if(e[C]===h){const t=e[m];if(t&&t.length){e[m]=[];for(const e of t)e.cb(new Error("No reply from server"))}}try{e.end()}catch{}setImmediate((()=>{if(!e[v])e.emit("end");if(!e[R])e.emit("close")}))}function onClose(){this[R]=true}function onEnd(){this[v]=true}const m=Symbol("Requests");const C=Symbol("Agent Protocol Role");const B=Symbol("Agent Protocol Buffer");const k=Symbol("Agent Protocol Current Message Length");const R=Symbol("Agent Protocol Closed");const v=Symbol("Agent Protocol Ended");return class AgentProtocol extends i{constructor(e){super({autoDestroy:true,emitClose:false});this[C]=e?h:g;this[m]=[];this[B]=null;this[k]=-1;this.once("end",onEnd);this.once("close",onClose)}_read(e){}_write(i,u,g){if(this[B]===null)this[B]=i;else this[B]=concat(this[B],i);let _=this[B];let E=_.length;let y=0;while(y<E){if(E<5)break;if(this[k]===-1)this[k]=p(_,y);if(E<4+this[k])break;const i=_[y+=4];++y;if(this[C]===h){if(this[m].length===0)return g(new Error("Received unexpected message from server"));const o=this[m].shift();switch(i){case n:o.cb(new Error("Agent responded with failure"));break;case r:{if(o.type!==e)return g(new Error("Agent responded with wrong message type"));I.init(_,y);const t=I.readUInt32BE();if(t===undefined){I.clear();return g(new Error("Malformed agent response"))}const n=[];for(let e=0;e<t;++e){let e=I.readString();if(e===undefined){I.clear();return g(new Error("Malformed agent response"))}const t=I.readString(true);if(t===undefined){I.clear();return g(new Error("Malformed agent response"))}e=l(e);if(e instanceof Error)continue;e.comment=e.comment||t;n.push(e)}y=I.pos();I.clear();o.cb(null,n);break}case s:{if(o.type!==t)return g(new Error("Agent responded with wrong message type"));I.init(_,y);let e=I.readString();y=I.pos();I.clear();if(e===undefined)return g(new Error("Malformed agent response"));I.init(e,0);I.readString(true);e=I.readString();I.clear();if(e===undefined)return g(new Error("Malformed OpenSSH signature format"));o.cb(null,e);break}default:return g(new Error("Agent responded with unsupported message type"))}}else{switch(i){case e:{const e=new AgentInboundRequest(i);this[m].push(e);this.emit("identities",e);break}case t:{I.init(_,y);let e=I.readString();const t=I.readString();const n=I.readUInt32BE();y=I.pos();I.clear();if(n===undefined){const e=new AgentInboundRequest(i);this[m].push(e);return this.failureReply(e)}e=l(e);if(e instanceof Error){const e=new AgentInboundRequest(i);this[m].push(e);return this.failureReply(e)}const r={hash:undefined};let s;if(e.type==="ssh-rsa"){if(n&o){s="rsa-sha2-256";r.hash="sha256"}else if(n&f){s="rsa-sha2-512";r.hash="sha512"}}if(s===undefined)s=e.type;const h=new AgentInboundRequest(i,s);this[m].push(h);this.emit("sign",h,e,t,r);break}default:{const e=new AgentInboundRequest(i);this[m].push(e);this.failureReply(e)}}}this[k]=-1;if(y===E){this[B]=null;break}else{this[B]=_=_.slice(y);E=_.length;y=0}}g()}_destroy(e,t){cleanup(this);t()}_final(e){cleanup(this);e()}sign(e,n,r,i){if(this[C]!==h)throw new Error("Client-only method called with server role");if(typeof r==="function"){i=r;r=undefined}else if(typeof r!=="object"||r===null){r=undefined}let s=0;e=l(e);if(e instanceof Error)throw new Error("Invalid public key argument");if(e.type==="ssh-rsa"&&r){switch(r.hash){case"sha256":s=o;break;case"sha512":s=f;break}}e=e.getPublicSSH();const u=t;const g=e.length;const p=n.length;let E=0;const y=Buffer.allocUnsafe(4+1+4+g+4+p+4);_(y,y.length-4,E);y[E+=4]=u;_(y,g,++E);e.copy(y,E+=4);_(y,p,E+=g);n.copy(y,E+=4);_(y,s,E+=p);if(typeof i!=="function")i=noop;this[m].push({type:u,cb:i});return this.push(y)}getIdentities(t){if(this[C]!==h)throw new Error("Client-only method called with server role");const n=e;let r=0;const i=Buffer.allocUnsafe(4+1);_(i,i.length-4,r);i[r+=4]=n;if(typeof t!=="function")t=noop;this[m].push({type:n,cb:t});return this.push(i)}failureReply(e){if(this[C]!==g)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;let t=0;const r=Buffer.allocUnsafe(4+1);_(r,r.length-4,t);r[t+=4]=n;return respond(this,e,r)}getIdentitiesReply(t,n){if(this[C]!==g)throw new Error("Server-only method called with client role");if(!(t instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(t.hasResponded())return true;if(t.getType()!==e)throw new Error("Invalid response to request");if(!Array.isArray(n))throw new Error("Keys argument must be an array");let i=4;const s=[];for(let e=0;e<n.length;++e){const t=n[e];if(typeof t!=="object"||t===null)throw new Error(`Invalid key entry: ${t}`);let r;let o;if(u(t)){r=t}else if(u(t.pubKey)){r=t.pubKey}else{if(typeof t.pubKey!=="object"||t.pubKey===null)continue;({pubKey:r,comment:o}=t.pubKey);r=l(r);if(r instanceof Error)continue}o=r.comment||o;r=r.getPublicSSH();i+=4+r.length;if(o&&typeof o==="string")o=Buffer.from(o);else if(!Buffer.isBuffer(o))o=y;i+=4+o.length;s.push({pubKey:r,comment:o})}let o=0;const f=Buffer.allocUnsafe(4+1+i);_(f,f.length-4,o);f[o+=4]=r;_(f,s.length,++o);o+=4;for(let e=0;e<s.length;++e){const{pubKey:t,comment:n}=s[e];_(f,t.length,o);t.copy(f,o+=4);_(f,n.length,o+=t.length);o+=4;if(n.length){n.copy(f,o);o+=n.length}}return respond(this,t,f)}signReply(e,n){if(this[C]!==g)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;if(e.getType()!==t)throw new Error("Invalid response to request");if(!Buffer.isBuffer(n))throw new Error("Signature argument must be a Buffer");if(n.length===0)throw new Error("Signature argument must be non-empty");let r=0;const i=e.getContext();const o=Buffer.byteLength(i);const f=Buffer.allocUnsafe(4+1+4+4+o+4+n.length);_(f,f.length-4,r);f[r+=4]=s;_(f,4+o+4+n.length,++r);_(f,o,r+=4);f.utf8Write(i,r+=4,o);_(f,n.length,r+=o);n.copy(f,r+=4);return respond(this,e,f)}}})();const B=Symbol("Agent");const k=Symbol("Agent Keys");const R=Symbol("Agent Keys Index");const v=Symbol("Agent Init Callbacks");class AgentContext{constructor(e){if(typeof e==="string")e=createAgent(e);else if(!isAgent(e))throw new Error("Invalid agent argument");this[B]=e;this[k]=null;this[R]=-1;this[v]=null}init(e){if(typeof e!=="function")e=noop;if(this[k]===null){if(this[v]===null){this[v]=[e];const doCbs=(...e)=>{process.nextTick((()=>{const t=this[v];this[v]=null;for(const n of t)n(...e)}))};this[B].getIdentities(once(((e,t)=>{if(e)return doCbs(e);if(!Array.isArray(t)){return doCbs(new Error("Agent implementation failed to provide keys"))}const n=[];for(let e of t){e=l(e);if(e instanceof Error){continue}n.push(e)}this[k]=n;this[R]=-1;doCbs()})))}else{this[v].push(e)}}else{process.nextTick(e)}}nextKey(){if(this[k]===null||++this[R]>=this[k].length){return false}return this[k][this[R]]}currentKey(){if(this[k]===null||this[R]>=this[k].length){return null}return this[k][this[R]]}pos(){if(this[k]===null||this[R]>=this[k].length){return-1}return this[R]}reset(){this[R]=-1}sign(...e){this[B].sign(...e)}}function isAgent(e){return e instanceof BaseAgent}e.exports={AgentContext:AgentContext,AgentProtocol:C,BaseAgent:BaseAgent,createAgent:createAgent,CygwinAgent:w,isAgent:isAgent,OpenSSHAgent:OpenSSHAgent,PageantAgent:b}},221:(e,t,n)=>{"use strict";const{createHash:r,getHashes:i,randomFillSync:s}=n(113);const{Socket:o}=n(808);const{lookup:f}=n(523);const h=n(361);const u=i();const{COMPAT:l,CHANNEL_EXTENDED_DATATYPE:{STDERR:g},CHANNEL_OPEN_FAILURE:p,DEFAULT_CIPHER:_,DEFAULT_COMPRESSION:E,DEFAULT_KEX:y,DEFAULT_MAC:I,DEFAULT_SERVER_HOST_KEY:b,DISCONNECT_REASON:w,DISCONNECT_REASON_BY_VALUE:m,SUPPORTED_CIPHER:C,SUPPORTED_COMPRESSION:B,SUPPORTED_KEX:k,SUPPORTED_MAC:R,SUPPORTED_SERVER_HOST_KEY:v}=n(480);const{init:T}=n(92);const U=n(664);const{parseKey:P}=n(613);const{SFTP:O}=n(593);const{bufferCopy:L,makeBufferParser:D,makeError:Q,readUInt32BE:x,sigSSHToASN1:W,writeUInt32BE:q}=n(775);const{AgentContext:G,createAgent:$,isAgent:Y}=n(997);const{Channel:V,MAX_WINDOW:j,PACKET_SIZE:z,windowAdjust:J,WINDOW_THRESHOLD:ee}=n(466);const{ChannelManager:te,generateAlgorithmList:ne,isWritable:re,onChannelOpenFailure:ie,onCHANNEL_CLOSE:se}=n(996);const oe=D();const ae=D();const ce=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/;const noop=e=>{};class Client extends h{constructor(){super();this.config={host:undefined,port:undefined,localAddress:undefined,localPort:undefined,forceIPv4:undefined,forceIPv6:undefined,keepaliveCountMax:undefined,keepaliveInterval:undefined,readyTimeout:undefined,ident:undefined,username:undefined,password:undefined,privateKey:undefined,tryKeyboard:undefined,agent:undefined,allowAgentFwd:undefined,authHandler:undefined,hostHashAlgo:undefined,hostHashCb:undefined,strictVendor:undefined,debug:undefined};this._agent=undefined;this._readyTimeout=undefined;this._chanMgr=undefined;this._callbacks=undefined;this._forwarding=undefined;this._forwardingUnix=undefined;this._acceptX11=undefined;this._agentFwdEnabled=undefined;this._remoteVer=undefined;this._protocol=undefined;this._sock=undefined;this._resetKA=undefined}connect(e){if(this._sock&&re(this._sock)){this.once("close",(()=>{this.connect(e)}));this.end();return this}this.config.host=e.hostname||e.host||"localhost";this.config.port=e.port||22;this.config.localAddress=typeof e.localAddress==="string"?e.localAddress:undefined;this.config.localPort=typeof e.localPort==="string"||typeof e.localPort==="number"?e.localPort:undefined;this.config.forceIPv4=e.forceIPv4||false;this.config.forceIPv6=e.forceIPv6||false;this.config.keepaliveCountMax=typeof e.keepaliveCountMax==="number"&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3;this.config.keepaliveInterval=typeof e.keepaliveInterval==="number"&&e.keepaliveInterval>0?e.keepaliveInterval:0;this.config.readyTimeout=typeof e.readyTimeout==="number"&&e.readyTimeout>=0?e.readyTimeout:2e4;this.config.ident=typeof e.ident==="string"||Buffer.isBuffer(e.ident)?e.ident:undefined;const t={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:[]},sc:undefined};let n=true;if(typeof e.algorithms==="object"&&e.algorithms!==null){t.kex=ne(e.algorithms.kex,y,k);if(t.kex!==y)n=false;t.serverHostKey=ne(e.algorithms.serverHostKey,b,v);if(t.serverHostKey!==b)n=false;t.cs.cipher=ne(e.algorithms.cipher,_,C);if(t.cs.cipher!==_)n=false;t.cs.mac=ne(e.algorithms.hmac,I,R);if(t.cs.mac!==I)n=false;t.cs.compress=ne(e.algorithms.compress,E,B);if(t.cs.compress!==E)n=false;if(!n)t.sc=t.cs}if(typeof e.username==="string")this.config.username=e.username;else if(typeof e.user==="string")this.config.username=e.user;else throw new Error("Invalid username");this.config.password=typeof e.password==="string"?e.password:undefined;this.config.privateKey=typeof e.privateKey==="string"||Buffer.isBuffer(e.privateKey)?e.privateKey:undefined;this.config.localHostname=typeof e.localHostname==="string"?e.localHostname:undefined;this.config.localUsername=typeof e.localUsername==="string"?e.localUsername:undefined;this.config.tryKeyboard=e.tryKeyboard===true;if(typeof e.agent==="string"&&e.agent.length)this.config.agent=$(e.agent);else if(Y(e.agent))this.config.agent=e.agent;else this.config.agent=undefined;this.config.allowAgentFwd=e.agentForward===true&&this.config.agent!==undefined;let i=this.config.authHandler=typeof e.authHandler==="function"||Array.isArray(e.authHandler)?e.authHandler:undefined;this.config.strictVendor=typeof e.strictVendor==="boolean"?e.strictVendor:true;const s=this.config.debug=typeof e.debug==="function"?e.debug:undefined;if(e.agentForward===true&&!this.config.allowAgentFwd){throw new Error("You must set a valid agent path to allow agent forwarding")}let h=this._callbacks=[];this._chanMgr=new te(this);this._forwarding={};this._forwardingUnix={};this._acceptX11=0;this._agentFwdEnabled=false;this._agent=this.config.agent?this.config.agent:undefined;this._remoteVer=undefined;let l;if(this.config.privateKey){l=P(this.config.privateKey,e.passphrase);if(l instanceof Error)throw new Error(`Cannot parse privateKey: ${l.message}`);if(Array.isArray(l)){l=l[0]}if(l.getPrivatePEM()===null){throw new Error("privateKey value does not contain a (valid) private key")}}let p;if(typeof e.hostVerifier==="function"){const t=e.hostVerifier;let n;if(u.indexOf(e.hostHash)!==-1){n=e.hostHash}p=(e,i)=>{if(n)e=r(n).update(e).digest("hex");const s=t(e,i);if(s!==undefined)i(s)}}const L=this._sock=e.sock||new o;let D=false;let x=false;if(this._protocol)this._protocol.cleanup();const W=!s?undefined:(e,t,n)=>{s(`Debug output from server: ${JSON.stringify(n)}`)};let q;const oe=this._protocol=new U({ident:this.config.ident,offer:n?undefined:t,onWrite:e=>{if(re(L))L.write(e)},onError:e=>{if(e.level==="handshake")clearTimeout(this._readyTimeout);if(!oe._destruct)L.removeAllListeners("data");this.emit("error",e);try{L.end()}catch{}},onHeader:e=>{x=true;this._remoteVer=e.versions.software;if(e.greeting)this.emit("greeting",e.greeting)},onHandshakeComplete:e=>{this.emit("handshake",e);if(!D){D=true;oe.service("ssh-userauth")}},debug:s,hostVerifier:p,messageHandlers:{DEBUG:W,DISCONNECT:(e,t,n)=>{if(t!==w.BY_APPLICATION){if(!n){n=m[t];if(n===undefined)n=`Unexpected disconnection reason: ${t}`}const e=new Error(n);e.code=t;this.emit("error",e)}L.end()},SERVICE_ACCEPT:(e,t)=>{if(t==="ssh-userauth")tryNextAuth()},EXT_INFO:(e,t)=>{if(q===undefined){for(const e of t){if(e.name==="server-sig-algs"){q=e.algs;return}}q=null}},USERAUTH_BANNER:(e,t)=>{this.emit("banner",t)},USERAUTH_SUCCESS:e=>{resetKA();clearTimeout(this._readyTimeout);this.emit("ready")},USERAUTH_FAILURE:(e,t,n)=>{if(Ae.keyAlgos){const e=Ae.keyAlgos[0][0];if(s)s(`Client: ${Ae.type} (${e}) auth failed`);Ae.keyAlgos.shift();if(Ae.keyAlgos.length){const[e,t]=Ae.keyAlgos[0];switch(Ae.type){case"agent":oe.authPK(Ae.username,Ae.agentCtx.currentKey(),e);return;case"publickey":oe.authPK(Ae.username,Ae.key,e);return;case"hostbased":oe.authHostbased(Ae.username,Ae.key,Ae.localHostname,Ae.localUsername,e,((e,n)=>{const r=Ae.key.sign(e,t);if(r instanceof Error){r.message=`Error while signing with key: ${r.message}`;r.level="client-authentication";this.emit("error",r);return tryNextAuth()}n(r)}));return}}else{Ae.keyAlgos=undefined}}if(Ae.type==="agent"){const e=Ae.agentCtx.pos();s&&s(`Client: Agent key #${e+1} failed`);return tryNextAgentKey()}s&&s(`Client: ${Ae.type} auth failed`);ge=n;pe=t;tryNextAuth()},USERAUTH_PASSWD_CHANGEREQ:(e,t)=>{if(Ae.type==="password"){this.emit("change password",t,(e=>{oe.authPassword(this.config.username,this.config.password,e)}))}},USERAUTH_PK_OK:e=>{let t;let n;if(Ae.keyAlgos)[t,n]=Ae.keyAlgos[0];if(Ae.type==="agent"){const e=Ae.agentCtx.currentKey();oe.authPK(Ae.username,e,t,((t,r)=>{const i={hash:n};Ae.agentCtx.sign(e,t,i,((e,t)=>{if(e){e.level="agent";this.emit("error",e)}else{return r(t)}tryNextAgentKey()}))}))}else if(Ae.type==="publickey"){oe.authPK(Ae.username,Ae.key,t,((e,t)=>{const r=Ae.key.sign(e,n);if(r instanceof Error){r.message=`Error signing data with key: ${r.message}`;r.level="client-authentication";this.emit("error",r);return tryNextAuth()}t(r)}))}},USERAUTH_INFO_REQUEST:(e,t,n,r)=>{if(Ae.type==="keyboard-interactive"){const e=Array.isArray(r)?r.length:0;if(e===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE");oe.authInfoRes();return}Ae.prompt(t,n,"",r,(e=>{oe.authInfoRes(e)}))}},REQUEST_SUCCESS:(e,t)=>{if(h.length)h.shift()(false,t)},REQUEST_FAILURE:e=>{if(h.length)h.shift()(true)},GLOBAL_REQUEST:(e,t,n,r)=>{switch(t){case"hostkeys-00@openssh.com":hostKeysProve(this,r,((e,t)=>{if(e)return;this.emit("hostkeys",t)}));if(n)oe.requestSuccess();break;default:if(n)oe.requestFailure()}},CHANNEL_OPEN:(e,t)=>{onCHANNEL_OPEN(this,t)},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const r=n.type==="sftp";const i=r?"session":n.type;const o={type:i,incoming:{id:t.recipient,window:j,packetSize:z,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const f=r?new O(this,o,{debug:s}):new V(this,o);this._chanMgr.update(t.recipient,f);n(undefined,f)},CHANNEL_OPEN_FAILURE:(e,t,n,r)=>{const i=this._chanMgr.get(t);if(typeof i!=="function")return;const s={reason:n,description:r};ie(this,t,s,i)},CHANNEL_DATA:(e,t,n)=>{const r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.incoming.window===0)return;r.incoming.window-=n.length;if(r.push(n)===false){r._waitChanDrain=true;return}if(r.incoming.window<=ee)J(r)},CHANNEL_EXTENDED_DATA:(e,t,n,r)=>{if(r!==g)return;const i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;if(i.incoming.window===0)return;i.incoming.window-=n.length;if(!i.stderr.push(n)){i._waitChanDrain=true;return}if(i.incoming.window<=ee)J(i)},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{const r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;r.outgoing.window+=n;if(r._waitWindow){r._waitWindow=false;if(r._chunk){r._write(r._chunk,null,r._chunkcb)}else if(r._chunkcb){r._chunkcb()}else if(r._chunkErr){r.stderr._write(r._chunkErr,null,r._chunkcbErr)}else if(r._chunkcbErr){r._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,r,i)=>{const s=this._chanMgr.get(t);if(typeof s!=="object"||s===null)return;const o=s._exit;if(o.code!==undefined)return;switch(n){case"exit-status":s.emit("exit",o.code=i);return;case"exit-signal":s.emit("exit",o.code=null,o.signal=`SIG${i.signal}`,o.dump=i.coreDumped,o.desc=i.errorMessage);return}if(r)e.channelFailure(s.outgoing.id)},CHANNEL_EOF:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null);if(n.stderr.readable)n.stderr.push(null)},CHANNEL_CLOSE:(e,t)=>{se(this,t,this._chanMgr.get(t))}}});L.pause();const ae=this.config.keepaliveInterval;const ce=this.config.keepaliveCountMax;let fe=0;let he;const sendKA=()=>{if(++fe>ce){clearInterval(he);if(L.readable){const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);L.destroy()}return}if(re(L)){h.push(resetKA);oe.ping()}else{clearInterval(he)}};function resetKA(){if(ae>0){fe=0;clearInterval(he);if(re(L))he=setInterval(sendKA,ae)}}this._resetKA=resetKA;const ue=(()=>{let e=false;return()=>{if(e)return;e=true;if(de&&!x){const e=Q("Connection lost before handshake","protocol",true);this.emit("error",e)}}})();const le=(()=>{let e=false;return()=>{if(e)return;e=true;de=true;s&&s("Socket connected");this.emit("connect");T.then((()=>{oe.start();L.on("data",(e=>{try{oe.parse(e,0,e.length)}catch(e){this.emit("error",e);try{if(re(L))L.end()}catch{}}}));if(L.stderr&&typeof L.stderr.resume==="function")L.stderr.resume();L.resume()})).catch((e=>{this.emit("error",e);try{if(re(L))L.end()}catch{}}))}})();let de=false;L.on("connect",le).on("timeout",(()=>{this.emit("timeout")})).on("error",(e=>{s&&s(`Socket error: ${e.message}`);clearTimeout(this._readyTimeout);e.level="client-socket";this.emit("error",e)})).on("end",(()=>{s&&s("Socket ended");ue();oe.cleanup();clearTimeout(this._readyTimeout);clearInterval(he);this.emit("end")})).on("close",(()=>{s&&s("Socket closed");ue();oe.cleanup();clearTimeout(this._readyTimeout);clearInterval(he);this.emit("close");const e=h;h=this._callbacks=[];const t=new Error("No response from server");for(let n=0;n<e.length;++n)e[n](t);this._chanMgr.cleanup(t)}));let Ae;let ge=null;let pe=null;const _e=["none"];if(this.config.password!==undefined)_e.push("password");if(l!==undefined)_e.push("publickey");if(this._agent!==undefined)_e.push("agent");if(this.config.tryKeyboard)_e.push("keyboard-interactive");if(l!==undefined&&this.config.localHostname!==undefined&&this.config.localUsername!==undefined){_e.push("hostbased")}if(Array.isArray(i))i=makeSimpleAuthHandler(i);else if(typeof i!=="function")i=makeSimpleAuthHandler(_e);let Ee=false;const doNextAuth=e=>{if(Ee)return;Ee=true;if(e===false){const e=new Error("All configured authentication methods failed");e.level="client-authentication";this.emit("error",e);this.end();return}if(typeof e==="string"){const t=e;if(_e.indexOf(t)===-1)return skipAuth(`Authentication method not allowed: ${t}`);const n=this.config.username;switch(t){case"password":e={type:t,username:n,password:this.config.password};break;case"publickey":e={type:t,username:n,key:l};break;case"hostbased":e={type:t,username:n,key:l,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":e={type:t,username:n,agentCtx:new G(this._agent)};break;case"keyboard-interactive":e={type:t,username:n,prompt:(...e)=>this.emit("keyboard-interactive",...e)};break;case"none":e={type:t,username:n};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}else if(typeof e!=="object"||e===null){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}else{const t=e.username;if(typeof t!=="string"){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}const n=e.type;switch(n){case"password":{const{password:r}=e;if(typeof r!=="string"&&!Buffer.isBuffer(r))return skipAuth("Skipping invalid password auth attempt");e={type:n,username:t,password:r};break}case"publickey":{const r=P(e.key,e.passphrase);if(r instanceof Error)return skipAuth("Skipping invalid key auth attempt");if(!r.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:r};break}case"hostbased":{const{localHostname:r,localUsername:i}=e;const s=P(e.key,e.passphrase);if(s instanceof Error||typeof r!=="string"||typeof i!=="string"){return skipAuth("Skipping invalid hostbased auth attempt")}if(!s.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:s,localHostname:r,localUsername:i};break}case"agent":{let r=e.agent;if(typeof r==="string"&&r.length){r=$(r)}else if(!Y(r)){return skipAuth(`Skipping invalid agent: ${e.agent}`)}e={type:n,username:t,agentCtx:new G(r)};break}case"keyboard-interactive":{const{prompt:r}=e;if(typeof r!=="function"){return skipAuth("Skipping invalid keyboard-interactive auth attempt")}e={type:n,username:t,prompt:r};break}case"none":e={type:n,username:t};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}Ae=e;try{const e=Ae.username;switch(Ae.type){case"password":oe.authPassword(e,Ae.password);break;case"publickey":{let t;Ae.keyAlgos=getKeyAlgos(this,Ae.key,q);if(Ae.keyAlgos){if(Ae.keyAlgos.length){t=Ae.keyAlgos[0][0]}else{return skipAuth("Skipping key authentication (no mutual hash algorithm)")}}oe.authPK(e,Ae.key,t);break}case"hostbased":{let t;let n;Ae.keyAlgos=getKeyAlgos(this,Ae.key,q);if(Ae.keyAlgos){if(Ae.keyAlgos.length){[t,n]=Ae.keyAlgos[0]}else{return skipAuth("Skipping hostbased authentication (no mutual hash algorithm)")}}oe.authHostbased(e,Ae.key,Ae.localHostname,Ae.localUsername,t,((e,t)=>{const r=Ae.key.sign(e,n);if(r instanceof Error){r.message=`Error while signing with key: ${r.message}`;r.level="client-authentication";this.emit("error",r);return tryNextAuth()}t(r)}));break}case"agent":Ae.agentCtx.init((e=>{if(e){e.level="agent";this.emit("error",e);return tryNextAuth()}tryNextAgentKey()}));break;case"keyboard-interactive":oe.authKeyboard(e);break;case"none":oe.authNone(e);break}}finally{Ee=false}};function skipAuth(e){s&&s(e);process.nextTick(tryNextAuth)}function tryNextAuth(){Ee=false;const e=i(pe,ge,doNextAuth);if(Ee||e===undefined)return;doNextAuth(e)}const tryNextAgentKey=()=>{if(Ae.type==="agent"){const e=Ae.agentCtx.nextKey();if(e===false){s&&s("Agent: No more keys left to try");s&&s("Client: agent auth failed");tryNextAuth()}else{const t=Ae.agentCtx.pos();let n;Ae.keyAlgos=getKeyAlgos(this,e,q);if(Ae.keyAlgos){if(Ae.keyAlgos.length){n=Ae.keyAlgos[0][0]}else{s&&s(`Agent: Skipping key #${t+1} (no mutual hash algorithm)`);tryNextAgentKey();return}}s&&s(`Agent: Trying key #${t+1}`);oe.authPK(Ae.username,e,n)}}};const startTimeout=()=>{if(this.config.readyTimeout>0){this._readyTimeout=setTimeout((()=>{const e=new Error("Timed out while waiting for handshake");e.level="client-timeout";this.emit("error",e);L.destroy()}),this.config.readyTimeout)}};if(!e.sock){let t=this.config.host;const n=this.config.forceIPv4;const r=this.config.forceIPv6;s&&s(`Client: Trying ${t} on port ${this.config.port} ...`);const doConnect=()=>{startTimeout();L.connect({host:t,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort});L.setMaxListeners(0);L.setTimeout(typeof e.timeout==="number"?e.timeout:0)};if(!n&&!r||n&&r){doConnect()}else{f(t,n?4:6,((e,r,i)=>{if(e){const r=n?"IPv4":"IPv6";const i=new Error(`Error while looking up ${r} address for '${t}': ${e}`);clearTimeout(this._readyTimeout);i.level="client-dns";this.emit("error",i);this.emit("close");return}t=r;doConnect()}))}}else{startTimeout();if(typeof L.connecting==="boolean"){if(!L.connecting){le()}}else{le()}}return this}end(){if(this._sock&&re(this._sock)){this._protocol.disconnect(w.BY_APPLICATION);this._sock.end()}return this}destroy(){this._sock&&re(this._sock)&&this._sock.destroy();return this}exec(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof t==="function"){n=t;t={}}const r={allowHalfOpen:t.allowHalfOpen!==false};openChannel(this,"session",r,((r,i)=>{if(r){n(r);return}const s=[];function reqCb(e){if(e){i.close();n(e);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(i,reqCb)))}if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(i,t.env);if(typeof t.pty==="object"&&t.pty!==null||t.pty===true){s.push((()=>reqPty(i,t.pty,reqCb)))}if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){s.push((()=>reqX11(i,t.x11,reqCb)))}}s.push((()=>reqExec(i,e,t,n)));s.shift()()}));return this}shell(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof e==="function"){n=e;e=t=undefined}else if(typeof t==="function"){n=t;t=undefined}if(e&&(e.x11!==undefined||e.env!==undefined)){t=e;e=undefined}openChannel(this,"session",((r,i)=>{if(r){n(r);return}const s=[];function reqCb(e){if(e){i.close();n(e);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(i,reqCb)))}if(e!==false)s.push((()=>reqPty(i,e,reqCb)));if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(i,t.env);if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){s.push((()=>reqX11(i,t.x11,reqCb)))}}s.push((()=>reqShell(i,n)));s.shift()()}));return this}subsys(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");openChannel(this,"session",((n,r)=>{if(n){t(n);return}reqSubsystem(r,e,((e,n)=>{if(e){t(e);return}t(undefined,n)}))}));return this}forwardIn(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");const r=typeof n==="function";if(r){this._callbacks.push(((r,i)=>{if(r){n(r!==true?r:new Error(`Unable to bind to ${e}:${t}`));return}let s=t;if(t===0&&i&&i.length>=4){s=x(i,0);if(!(this._protocol._compatFlags&l.DYN_RPORT_BUG))t=s}this._forwarding[`${e}:${t}`]=s;n(undefined,s)}))}this._protocol.tcpipForward(e,t,r);return this}unforwardIn(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");const r=typeof n==="function";if(r){this._callbacks.push((r=>{if(r){n(r!==true?r:new Error(`Unable to unbind from ${e}:${t}`));return}delete this._forwarding[`${e}:${t}`];n()}))}this._protocol.cancelTcpipForward(e,t,r);return this}forwardOut(e,t,n,r,i){if(!this._sock||!re(this._sock))throw new Error("Not connected");const s={srcIP:e,srcPort:t,dstIP:n,dstPort:r};if(typeof i!=="function")i=noop;openChannel(this,"direct-tcpip",s,i);return this}openssh_noMoreSessions(e){if(!this._sock||!re(this._sock))throw new Error("Not connected");const t=typeof e==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(t){this._callbacks.push((t=>{if(t){e(t!==true?t:new Error("Unable to disable future sessions"));return}e()}))}this._protocol.openssh_noMoreSessions(t);return this}if(!t)return this;process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardInStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to bind to ${e}`));return}this._forwardingUnix[e]=true;t()}))}this._protocol.openssh_streamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_unforwardInStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to unbind from ${e}`));return}delete this._forwardingUnix[e];t()}))}this._protocol.openssh_cancelStreamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardOutStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof t!=="function")t=noop;if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){openChannel(this,"direct-streamlocal@openssh.com",{socketPath:e},t);return this}process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}sftp(e){if(!this._sock||!re(this._sock))throw new Error("Not connected");openChannel(this,"sftp",((t,n)=>{if(t){e(t);return}reqSubsystem(n,"sftp",((t,r)=>{if(t){e(t);return}function removeListeners(){n.removeListener("ready",onReady);n.removeListener("error",onError);n.removeListener("exit",onExit);n.removeListener("close",onExit)}function onReady(){removeListeners();e(undefined,n)}function onError(t){removeListeners();e(t)}function onExit(t,n){removeListeners();let r;if(typeof t==="number")r=`Received exit code ${t} while establishing SFTP session`;else if(n!==undefined)r=`Received signal ${n} while establishing SFTP session`;else r="Received unexpected SFTP session termination";const i=new Error(r);i.code=t;i.signal=n;e(i)}n.on("ready",onReady).on("error",onError).on("exit",onExit).on("close",onExit);n._init()}))}));return this}setNoDelay(e){if(this._sock&&typeof this._sock.setNoDelay==="function")this._sock.setNoDelay(e);return this}}function openChannel(e,t,n,r){const i=j;const s=z;if(typeof n==="function"){r=n;n={}}const wrapper=(e,t)=>{r(e,t)};wrapper.type=t;const o=e._chanMgr.add(wrapper);if(o===-1){r(new Error("No free channels available"));return}switch(t){case"session":case"sftp":e._protocol.session(o,i,s);break;case"direct-tcpip":e._protocol.directTcpip(o,i,s,n);break;case"direct-streamlocal@openssh.com":e._protocol.openssh_directStreamLocal(o,i,s,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function reqX11(e,t,n){const r={single:false,protocol:"MIT-MAGIC-COOKIE-1",cookie:undefined,screen:0};if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.single==="boolean")r.single=t.single;if(typeof t.screen==="number")r.screen=t.screen;if(typeof t.protocol==="string")r.protocol=t.protocol;if(typeof t.cookie==="string")r.cookie=t.cookie;else if(Buffer.isBuffer(t.cookie))r.cookie=t.cookie.hexSlice(0,t.cookie.length)}if(r.cookie===undefined)r.cookie=fe();const i=typeof n==="function";if(e.outgoing.state!=="open"){if(i)n(new Error("Channel is not open"));return}if(i){e._callbacks.push((t=>{if(t){n(t!==true?t:new Error("Unable to request X11"));return}e._hasX11=true;++e._client._acceptX11;e.once("close",(()=>{if(e._client._acceptX11)--e._client._acceptX11}));n()}))}e._client._protocol.x11Forward(e.outgoing.id,r,i)}function reqPty(e,t,n){let r=24;let i=80;let s=640;let o=480;let f="vt100";let h=null;if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.rows==="number")r=t.rows;if(typeof t.cols==="number")i=t.cols;if(typeof t.width==="number")s=t.width;if(typeof t.height==="number")o=t.height;if(typeof t.term==="string")f=t.term;if(typeof t.modes==="object")h=t.modes}const u=typeof n==="function";if(e.outgoing.state!=="open"){if(u)n(new Error("Channel is not open"));return}if(u){e._callbacks.push((e=>{if(e){n(e!==true?e:new Error("Unable to request a pseudo-terminal"));return}n()}))}e._client._protocol.pty(e.outgoing.id,r,i,o,s,f,h,u)}function reqAgentFwd(e,t){const n=typeof t==="function";if(e.outgoing.state!=="open"){n&&t(new Error("Channel is not open"));return}if(e._client._agentFwdEnabled){n&&t(false);return}e._client._agentFwdEnabled=true;e._callbacks.push((r=>{if(r){e._client._agentFwdEnabled=false;if(n){t(r!==true?r:new Error("Unable to request agent forwarding"))}return}if(n)t()}));e._client._protocol.openssh_agentForward(e.outgoing.id,true)}function reqShell(e,t){if(e.outgoing.state!=="open"){t(new Error("Channel is not open"));return}e._callbacks.push((n=>{if(n){t(n!==true?n:new Error("Unable to open shell"));return}e.subtype="shell";t(undefined,e)}));e._client._protocol.shell(e.outgoing.id,true)}function reqExec(e,t,n,r){if(e.outgoing.state!=="open"){r(new Error("Channel is not open"));return}e._callbacks.push((t=>{if(t){r(t!==true?t:new Error("Unable to exec"));return}e.subtype="exec";e.allowHalfOpen=n.allowHalfOpen!==false;r(undefined,e)}));e._client._protocol.exec(e.outgoing.id,t,true)}function reqEnv(e,t){if(e.outgoing.state!=="open")return;const n=Object.keys(t||{});for(let r=0;r<n.length;++r){const i=n[r];const s=t[i];e._client._protocol.env(e.outgoing.id,i,s,false)}}function reqSubsystem(e,t,n){if(e.outgoing.state!=="open"){n(new Error("Channel is not open"));return}e._callbacks.push((r=>{if(r){n(r!==true?r:new Error(`Unable to start subsystem: ${t}`));return}e.subtype="subsystem";n(undefined,e)}));e._client._protocol.subsystem(e.outgoing.id,t,true)}function onCHANNEL_OPEN(e,t){let n=-1;let r;const accept=()=>{const r={type:t.type,incoming:{id:n,window:j,packetSize:z,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new V(e,r);e._chanMgr.update(n,i);e._protocol.channelOpenConfirm(t.sender,n,j,z);return i};const reject=()=>{if(r===undefined){if(n===-1)r=p.RESOURCE_SHORTAGE;else r=p.CONNECT_FAILED}if(n!==-1)e._chanMgr.remove(n);e._protocol.channelOpenFail(t.sender,r,"")};const reserveChannel=()=>{n=e._chanMgr.add();if(n===-1){r=p.RESOURCE_SHORTAGE;if(e.config.debug){e.config.debug("Client: Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const i=t.data;switch(t.type){case"forwarded-tcpip":{const t=e._forwarding[`${i.destIP}:${i.destPort}`];if(t!==undefined&&reserveChannel()){if(i.destPort===0)i.destPort=t;e.emit("tcp connection",i,accept,reject);return}break}case"forwarded-streamlocal@openssh.com":if(e._forwardingUnix[i.socketPath]!==undefined&&reserveChannel()){e.emit("unix connection",i,accept,reject);return}break;case"auth-agent@openssh.com":if(e._agentFwdEnabled&&typeof e._agent.getStream==="function"&&reserveChannel()){e._agent.getStream(((e,t)=>{if(e)return reject();const n=accept();n.pipe(t).pipe(n)}));return}break;case"x11":if(e._acceptX11!==0&&reserveChannel()){e.emit("x11",i,accept,reject);return}break;default:r=p.UNKNOWN_CHANNEL_TYPE;if(e.config.debug){e.config.debug("Client: Automatic rejection of unsupported incoming channel open "+`type: ${t.type}`)}}if(r===undefined){r=p.ADMINISTRATIVELY_PROHIBITED;if(e.config.debug){e.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)}}reject()}const fe=(()=>{const e=Buffer.allocUnsafe(16);return()=>{s(e,0,16);return e.hexSlice(0,16)}})();function makeSimpleAuthHandler(e){if(!Array.isArray(e))throw new Error("authList must be an array");let t=0;return(n,r,i)=>{if(t===e.length)return false;return e[t++]}}function hostKeysProve(e,t,n){if(!e._sock||!re(e._sock))return;if(typeof n!=="function")n=noop;if(!Array.isArray(t))throw new TypeError("Invalid keys argument type");const r=[];for(const e of t){const t=P(e);if(t instanceof Error)throw t;r.push(t)}if(!e.config.strictVendor||e.config.strictVendor&&ce.test(e._remoteVer)){e._callbacks.push(((t,i)=>{if(t){n(t!==true?t:new Error("Server failed to prove supplied keys"));return}const s=[];let o=0;oe.init(i,0);while(oe.avail()){if(o===r.length)break;const t=r[o++];const n=t.getPublicSSH();const i=oe.readString();ae.init(i,0);const f=ae.readString(true);let h=ae.readString();let u;if(f!==t.type){if(t.type==="ssh-rsa"){switch(f){case"rsa-sha2-256":u="sha256";break;case"rsa-sha2-512":u="sha512";break;default:continue}}else{continue}}const l=e._protocol._kex.sessionID;const g=Buffer.allocUnsafe(4+29+4+l.length+4+n.length);let p=0;q(g,29,p);g.utf8Write("hostkeys-prove-00@openssh.com",p+=4,29);q(g,l.length,p+=29);L(l,g,0,l.length,p+=4);q(g,n.length,p+=l.length);L(n,g,0,n.length,p+=4);if(!(h=W(h,f)))continue;if(t.verify(g,h,u)===true)s.push(t)}ae.clear();oe.clear();n(null,s)}));e._protocol.openssh_hostKeysProve(r);return}process.nextTick(n,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}function getKeyAlgos(e,t,n){switch(t.type){case"ssh-rsa":if(e._protocol._compatFlags&l.IMPLY_RSA_SHA2_SIGALGS){if(!Array.isArray(n))n=["rsa-sha2-256","rsa-sha2-512"];else n=["rsa-sha2-256","rsa-sha2-512",...n]}if(Array.isArray(n)){if(n.indexOf("rsa-sha2-256")!==-1)return[["rsa-sha2-256","sha256"]];if(n.indexOf("rsa-sha2-512")!==-1)return[["rsa-sha2-512","sha512"]];if(n.indexOf("ssh-rsa")===-1)return[]}return[["ssh-rsa","sha1"]]}}e.exports=Client},576:(e,t,n)=>{"use strict";const{Agent:r}=n(685);const{Agent:i}=n(687);const{connect:s}=n(404);let o;for(const e of[r,i]){class SSHAgent extends e{constructor(e,t){super(t);this._connectCfg=e;this._defaultSrcIP=t&&t.srcIP||"localhost"}createConnection(t,r){const i=t&&t.localAddress||this._defaultSrcIP;const s=t&&t.localPort||0;const f=t.host;const h=t.port;if(o===undefined)o=n(221);const u=new o;let l=false;u.on("ready",(()=>{u.forwardOut(i,s,f,h,((n,i)=>{l=true;if(n){u.end();return r(n)}i.once("close",(()=>u.end()));r(null,decorateStream(i,e,t))}))})).on("error",r).on("close",(()=>{if(!l)r(new Error("Unexpected connection close"))})).connect(this._connectCfg)}}t[e===r?"SSHTTPAgent":"SSHTTPSAgent"]=SSHAgent}function noop(){}function decorateStream(e,t,n){if(t===r){e.setKeepAlive=noop;e.setNoDelay=noop;e.setTimeout=noop;e.ref=noop;e.unref=noop;e.destroySoon=e.destroy;return e}n.socket=e;const i=s(n);const o=(()=>{let t=false;return()=>{if(t)return;t=true;if(e.isPaused())e.resume()}})();i.on("end",o).on("close",o);return i}},597:(e,t,n)=>{"use strict";const{AgentProtocol:r,BaseAgent:i,createAgent:s,CygwinAgent:o,OpenSSHAgent:f,PageantAgent:h}=n(997);const{SSHTTPAgent:u,SSHTTPSAgent:l}=n(576);const{parseKey:g}=n(613);const{flagsToString:p,OPEN_MODE:_,STATUS_CODE:E,stringToFlags:y}=n(593);e.exports={AgentProtocol:r,BaseAgent:i,createAgent:s,Client:n(221),CygwinAgent:o,HTTPAgent:u,HTTPSAgent:l,OpenSSHAgent:f,PageantAgent:h,Server:n(120),utils:{parseKey:g,...n(365),sftp:{flagsToString:p,OPEN_MODE:_,STATUS_CODE:E,stringToFlags:y}}}},365:(e,t,n)=>{"use strict";const{createCipheriv:r,generateKeyPair:i,generateKeyPairSync:s,getCurves:o,randomBytes:f}=n(113);const{Ber:h}=n(680);const u=n(583).pbkdf;const{CIPHER_INFO:l}=n(92);const g=16;const p=16;const _=o();const E=new Map(Object.entries(l));function makeArgs(e,t){if(typeof e!=="string")throw new TypeError("Key type must be a string");const n={type:"spki",format:"der"};const r={type:"pkcs8",format:"der"};switch(e.toLowerCase()){case"rsa":{if(typeof t!=="object"||t===null)throw new TypeError("Missing options object for RSA key");const e=t.bits;if(!Number.isInteger(e))throw new TypeError("RSA bits must be an integer");if(e<=0||e>16384)throw new RangeError("RSA bits must be non-zero and <= 16384");return["rsa",{modulusLength:e,publicKeyEncoding:n,privateKeyEncoding:r}]}case"ecdsa":{if(typeof t!=="object"||t===null)throw new TypeError("Missing options object for ECDSA key");if(!Number.isInteger(t.bits))throw new TypeError("ECDSA bits must be an integer");let e;switch(t.bits){case 256:e="prime256v1";break;case 384:e="secp384r1";break;case 521:e="secp521r1";break;default:throw new Error("ECDSA bits must be 256, 384, or 521")}if(!_.includes(e))throw new Error("Unsupported ECDSA bits value");return["ec",{namedCurve:e,publicKeyEncoding:n,privateKeyEncoding:r}]}case"ed25519":return["ed25519",{publicKeyEncoding:n,privateKeyEncoding:r}];default:throw new Error(`Unsupported key type: ${e}`)}}function parseDERs(e,t,n){switch(e){case"rsa":{let e=new h.Reader(n);e.readSequence();if(e.readInt()!==0)throw new Error("Unsupported version in RSA private key");e.readSequence();if(e.readOID()!=="1.2.840.113549.1.1.1")throw new Error("Bad RSA private OID");if(e.readByte()!==h.Null)throw new Error("Malformed RSA private key (expected null)");if(e.readByte()!==0){throw new Error("Malformed RSA private key (expected zero-length null)")}e=new h.Reader(e.readString(h.OctetString,true));e.readSequence();if(e.readInt()!==0)throw new Error("Unsupported version in RSA private key");const t=e.readString(h.Integer,true);const r=e.readString(h.Integer,true);const i=e.readString(h.Integer,true);const s=e.readString(h.Integer,true);const o=e.readString(h.Integer,true);e.readString(h.Integer,true);e.readString(h.Integer,true);const f=e.readString(h.Integer,true);const u=Buffer.from("ssh-rsa");const l=Buffer.allocUnsafe(4+u.length+4+t.length+4+r.length+4+i.length+4+f.length+4+s.length+4+o.length);let g=0;l.writeUInt32BE(u.length,g+=0);l.set(u,g+=4);l.writeUInt32BE(t.length,g+=u.length);l.set(t,g+=4);l.writeUInt32BE(r.length,g+=t.length);l.set(r,g+=4);l.writeUInt32BE(i.length,g+=r.length);l.set(i,g+=4);l.writeUInt32BE(f.length,g+=i.length);l.set(f,g+=4);l.writeUInt32BE(s.length,g+=f.length);l.set(s,g+=4);l.writeUInt32BE(o.length,g+=s.length);l.set(o,g+=4);const p=Buffer.allocUnsafe(4+u.length+4+r.length+4+t.length);g=0;p.writeUInt32BE(u.length,g+=0);p.set(u,g+=4);p.writeUInt32BE(r.length,g+=u.length);p.set(r,g+=4);p.writeUInt32BE(t.length,g+=r.length);p.set(t,g+=4);return{sshName:u.toString(),priv:l,pub:p}}case"ec":{let e=new h.Reader(t);e.readSequence();e.readSequence();if(e.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA public OID");e.readOID();let r=e.readString(h.BitString,true);{let e=0;for(;e<r.length&&r[e]===0;++e);if(e>0)r=r.slice(e)}e=new h.Reader(n);e.readSequence();if(e.readInt()!==0)throw new Error("Unsupported version in ECDSA private key");e.readSequence();if(e.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA private OID");const i=e.readOID();let s;switch(i){case"1.2.840.10045.3.1.7":s="nistp256";break;case"1.3.132.0.34":s="nistp384";break;case"1.3.132.0.35":s="nistp521";break;default:throw new Error("Unsupported curve in ECDSA private key")}e=new h.Reader(e.readString(h.OctetString,true));e.readSequence();if(e.readInt()!==1)throw new Error("Unsupported version in ECDSA private key");const o=Buffer.concat([Buffer.from([0]),e.readString(h.OctetString,true)]);const f=Buffer.from(`ecdsa-sha2-${s}`);s=Buffer.from(s);const u=Buffer.allocUnsafe(4+f.length+4+s.length+4+r.length+4+o.length);let l=0;u.writeUInt32BE(f.length,l+=0);u.set(f,l+=4);u.writeUInt32BE(s.length,l+=f.length);u.set(s,l+=4);u.writeUInt32BE(r.length,l+=s.length);u.set(r,l+=4);u.writeUInt32BE(o.length,l+=r.length);u.set(o,l+=4);const g=Buffer.allocUnsafe(4+f.length+4+s.length+4+r.length);l=0;g.writeUInt32BE(f.length,l+=0);g.set(f,l+=4);g.writeUInt32BE(s.length,l+=f.length);g.set(s,l+=4);g.writeUInt32BE(r.length,l+=s.length);g.set(r,l+=4);return{sshName:f.toString(),priv:u,pub:g}}case"ed25519":{let e=new h.Reader(t);e.readSequence();e.readSequence();if(e.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 public OID");let r=e.readString(h.BitString,true);{let e=0;for(;e<r.length&&r[e]===0;++e);if(e>0)r=r.slice(e)}e=new h.Reader(n);e.readSequence();if(e.readInt()!==0)throw new Error("Unsupported version in ED25519 private key");e.readSequence();if(e.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 private OID");e=new h.Reader(e.readString(h.OctetString,true));const i=e.readString(h.OctetString,true);const s=Buffer.from("ssh-ed25519");const o=Buffer.allocUnsafe(4+s.length+4+r.length+4+(i.length+r.length));let f=0;o.writeUInt32BE(s.length,f+=0);o.set(s,f+=4);o.writeUInt32BE(r.length,f+=s.length);o.set(r,f+=4);o.writeUInt32BE(i.length+r.length,f+=r.length);o.set(i,f+=4);o.set(r,f+=i.length);const u=Buffer.allocUnsafe(4+s.length+4+r.length);f=0;u.writeUInt32BE(s.length,f+=0);u.set(s,f+=4);u.writeUInt32BE(r.length,f+=s.length);u.set(r,f+=4);return{sshName:s.toString(),priv:o,pub:u}}}}function convertKeys(e,t,n,i){let s="new";let o;let h="";if(typeof i==="object"&&i!==null){if(typeof i.comment==="string"&&i.comment)h=i.comment;if(typeof i.format==="string"&&i.format)s=i.format;if(i.passphrase){let e;if(typeof i.passphrase==="string")e=Buffer.from(i.passphrase);else if(Buffer.isBuffer(i.passphrase))e=i.passphrase;else throw new Error("Invalid passphrase");if(i.cipher===undefined)throw new Error("Missing cipher name");const t=E.get(i.cipher);if(t===undefined)throw new Error("Invalid cipher name");if(s==="new"){let n=p;if(i.rounds!==undefined){if(!Number.isInteger(i.rounds))throw new TypeError("rounds must be an integer");if(i.rounds>0)n=i.rounds}const r=Buffer.allocUnsafe(t.keyLen+t.ivLen);const s=f(g);const h=u(e,e.length,s,s.length,r,r.length,n);if(h!==0)return new Error("Failed to generate information to encrypt key");const l=Buffer.allocUnsafe(4+s.length+4);{let e=0;l.writeUInt32BE(s.length,e+=0);l.set(s,e+=4);l.writeUInt32BE(n,e+=s.length)}o={cipher:t,cipherName:i.cipher,kdfName:"bcrypt",kdfOptions:l,key:r.slice(0,t.keyLen),iv:r.slice(t.keyLen)}}}}switch(s){case"new":{let i="-----BEGIN OPENSSH PRIVATE KEY-----\n";let s;const u=Buffer.from(o?o.cipherName:"none");const l=Buffer.from(o?o.kdfName:"none");const g=o?o.kdfOptions:Buffer.alloc(0);const p=o?o.cipher.blockLen:8;const _=parseDERs(e,t,n);const E=f(4);const y=Buffer.from(h);const I=4+4+_.priv.length+4+y.length;let b=[];for(let e=1;(I+b.length)%p;++e)b.push(e&255);b=Buffer.from(b);let w=Buffer.allocUnsafe(I+b.length);let m;{let e=0;w.set(E,e+=0);w.set(E,e+=4);w.set(_.priv,e+=4);w.writeUInt32BE(y.length,e+=_.priv.length);w.set(y,e+=4);w.set(b,e+=y.length)}if(o){const e={authTagLength:o.cipher.authLen};const t=r(o.cipher.sslName,o.key,o.iv,e);t.setAutoPadding(false);w=Buffer.concat([t.update(w),t.final()]);if(o.cipher.authLen>0)m=t.getAuthTag();else m=Buffer.alloc(0);o.key.fill(0);o.iv.fill(0)}else{m=Buffer.alloc(0)}const C=Buffer.from("openssh-key-v1\0");const B=Buffer.allocUnsafe(C.length+4+u.length+4+l.length+4+g.length+4+4+_.pub.length+4+w.length+m.length);{let e=0;B.set(C,e+=0);B.writeUInt32BE(u.length,e+=C.length);B.set(u,e+=4);B.writeUInt32BE(l.length,e+=u.length);B.set(l,e+=4);B.writeUInt32BE(g.length,e+=l.length);B.set(g,e+=4);B.writeUInt32BE(1,e+=g.length);B.writeUInt32BE(_.pub.length,e+=4);B.set(_.pub,e+=4);B.writeUInt32BE(w.length,e+=_.pub.length);B.set(w,e+=4);B.set(m,e+=w.length)}{const e=B.base64Slice(0,B.length);let t=e.replace(/.{64}/g,"$&\n");if(e.length&63)t+="\n";i+=t}{const e=_.pub.base64Slice(0,_.pub.length);s=`${_.sshName} ${e}${h?` ${h}`:""}`}i+="-----END OPENSSH PRIVATE KEY-----\n";return{private:i,public:s}}default:throw new Error("Invalid output key format")}}function noop(){}e.exports={generateKeyPair:(e,t,n)=>{if(typeof t==="function"){n=t;t=undefined}if(typeof n!=="function")n=noop;const r=makeArgs(e,t);i(...r,((e,i,s)=>{if(e)return n(e);let o;try{o=convertKeys(r[0],i,s,t)}catch(e){return n(e)}n(null,o)}))},generateKeyPairSync:(e,t)=>{const n=makeArgs(e,t);const{publicKey:r,privateKey:i}=s(...n);return convertKeys(n[0],r,i,t)}}},664:(e,t,n)=>{"use strict";const{inspect:r}=n(837);const{bindingAvailable:i,NullCipher:s,NullDecipher:o}=n(92);const{COMPAT_CHECKS:f,DISCONNECT_REASON:h,eddsaSupported:u,MESSAGE:l,SIGNALS:g,TERMINAL_MODE:p}=n(480);const{DEFAULT_KEXINIT_CLIENT:_,DEFAULT_KEXINIT_SERVER:E,KexInit:y,kexinit:I,onKEXPayload:b}=n(494);const{parseKey:w}=n(613);const m=n(374);const{bufferCopy:C,bufferFill:B,bufferSlice:k,convertSignature:R,sendPacket:v,writeUInt32BE:T}=n(775);const{PacketReader:U,PacketWriter:P,ZlibPacketReader:O,ZlibPacketWriter:L}=n(736);const D=n(876).i8;const Q=new Map(Object.values(h).map((e=>[e,1])));const x=Buffer.from(`SSH-2.0-ssh2js${D}`);const W=Buffer.from(`${x}\r\n`);const q=8192;const G=1024;const $=Buffer.from([l.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]);const Y=Buffer.from([p.TTY_OP_END]);function noop(){}class Protocol{constructor(e){const t=e.onWrite;if(typeof t!=="function")throw new Error("Missing onWrite function");this._onWrite=e=>{t(e)};const n=e.onError;if(typeof n!=="function")throw new Error("Missing onError function");this._onError=e=>{n(e)};const o=e.debug;this._debug=typeof o==="function"?e=>{o(e)}:undefined;const f=e.onHeader;this._onHeader=typeof f==="function"?(...e)=>{f(...e)}:noop;const h=e.onPacket;this._onPacket=typeof h==="function"?()=>{h()}:noop;let u=e.onHandshakeComplete;if(typeof u!=="function")u=noop;let l;this._onHandshakeComplete=(...e)=>{this._debug&&this._debug("Handshake completed");if(l===undefined)l=true;else l=false;const t=this._queue;if(t){this._queue=undefined;this._debug&&this._debug(`Draining outbound queue (${t.length}) ...`);for(let e=0;e<t.length;++e){const n=t[e];let r=this._packetRW.write.finalize(n);if(r===n){const e=this._cipher.allocPacket(n.length);e.set(n,5);r=e}v(this,r)}this._debug&&this._debug("... finished draining outbound queue")}if(l&&this._server&&this._kex.remoteExtInfoEnabled)sendExtInfo(this);u(...e)};this._queue=undefined;const g=e.messageHandlers;if(typeof g==="object"&&g!==null)this._handlers=g;else this._handlers={};this._onPayload=onPayload.bind(this);this._server=!!e.server;this._banner=undefined;let p;if(this._server){if(typeof e.hostKeys!=="object"||e.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=e.hostKeys;if(typeof e.greeting==="string"&&e.greeting.length){p=e.greeting.slice(-2)==="\r\n"?e.greeting:`${e.greeting}\r\n`}if(typeof e.banner==="string"&&e.banner.length){this._banner=e.banner.slice(-2)==="\r\n"?e.banner:`${e.banner}\r\n`}}else{this._hostKeys=undefined}let I=e.offer;if(typeof I!=="object"||I===null){I=this._server?E:_}else if(I.constructor!==y){if(this._server){I.kex=I.kex.concat(["kex-strict-s-v00@openssh.com"])}else{I.kex=I.kex.concat(["ext-info-c","kex-strict-c-v00@openssh.com"])}I=new y(I)}this._kex=undefined;this._strictMode=undefined;this._kexinit=undefined;this._offer=I;this._cipher=new s(0,this._onWrite);this._decipher=undefined;this._skipNextInboundPacket=false;this._packetRW={read:new U,write:new P(this)};this._hostVerifier=!this._server&&typeof e.hostVerifier==="function"?e.hostVerifier:undefined;this._parse=parseHeader;this._buffer=undefined;this._authsQueue=[];this._authenticated=false;this._remoteIdentRaw=undefined;let b;if(typeof e.ident==="string"){this._identRaw=Buffer.from(`SSH-2.0-${e.ident}`);b=Buffer.allocUnsafe(this._identRaw.length+2);b.set(this._identRaw,0);b[b.length-2]=13;b[b.length-1]=10}else if(Buffer.isBuffer(e.ident)){const t=Buffer.allocUnsafe(8+e.ident.length);t.latin1Write("SSH-2.0-",0,8);t.set(e.ident,8);this._identRaw=t;b=Buffer.allocUnsafe(t.length+2);b.set(t,0);b[b.length-2]=13;b[b.length-1]=10}else{this._identRaw=x;b=W}this._compatFlags=0;if(this._debug){if(i)this._debug("Custom crypto binding available");else this._debug("Custom crypto binding not available")}this._debug&&this._debug(`Local ident: ${r(this._identRaw.toString())}`);this.start=()=>{this.start=undefined;if(p)this._onWrite(p);this._onWrite(b)}}_destruct(e){this._packetRW.read.cleanup();this._packetRW.write.cleanup();this._cipher&&this._cipher.free();this._decipher&&this._decipher.free();if(typeof e!=="string"||e.length===0)e="fatal error";this.parse=()=>{throw new Error(`Instance unusable after ${e}`)};this._onWrite=()=>{throw new Error(`Instance unusable after ${e}`)};this._destruct=undefined}cleanup(){this._destruct&&this._destruct()}parse(e,t,n){while(t<n)t=this._parse(e,t,n)}disconnect(e){const t=1+4+4+4;let n=this._packetRW.write.allocStartKEX;const r=this._packetRW.write.alloc(t,true);const i=n+t;if(!Q.has(e))e=h.PROTOCOL_ERROR;r[n]=l.DISCONNECT;T(r,e,++n);r.fill(0,n+=4,i);this._debug&&this._debug(`Outbound: Sending DISCONNECT (${e})`);v(this,this._packetRW.write.finalize(r,true),true)}ping(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc($.length);t.set($,e);this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)");v(this,this._packetRW.write.finalize(t))}rekey(){if(this._kexinit===undefined){this._debug&&this._debug("Outbound: Initiated explicit rekey");this._queue=[];I(this)}else{this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}}requestSuccess(e){let t=this._packetRW.write.allocStart;let n;if(Buffer.isBuffer(e)){n=this._packetRW.write.alloc(1+e.length);n[t]=l.REQUEST_SUCCESS;n.set(e,++t)}else{n=this._packetRW.write.alloc(1);n[t]=l.REQUEST_SUCCESS}this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS");v(this,this._packetRW.write.finalize(n))}requestFailure(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=l.REQUEST_FAILURE;this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE");v(this,this._packetRW.write.finalize(t))}channelSuccess(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_SUCCESS;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${e})`);v(this,this._packetRW.write.finalize(n))}channelFailure(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_FAILURE;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${e})`);v(this,this._packetRW.write.finalize(n))}channelEOF(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_EOF;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${e})`);v(this,this._packetRW.write.finalize(n))}channelClose(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_CLOSE;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${e})`);v(this,this._packetRW.write.finalize(n))}channelWindowAdjust(e,t){let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4);r[n]=l.CHANNEL_WINDOW_ADJUST;T(r,e,++n);T(r,t,n+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${e}, ${t})`);v(this,this._packetRW.write.finalize(r))}channelData(e,t){const n=Buffer.isBuffer(t);const r=n?t.length:Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+r);s[i]=l.CHANNEL_DATA;T(s,e,++i);T(s,r,i+=4);if(n)s.set(t,i+=4);else s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${e}, ${r})`);v(this,this._packetRW.write.finalize(s))}channelExtData(e,t,n){const r=Buffer.isBuffer(t);const i=r?t.length:Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+i);o[s]=l.CHANNEL_EXTENDED_DATA;T(o,e,++s);T(o,n,s+=4);T(o,i,s+=4);if(r)o.set(t,s+=4);else o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${e})`);v(this,this._packetRW.write.finalize(o))}channelOpenConfirm(e,t,n,r){let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+4);s[i]=l.CHANNEL_OPEN_CONFIRMATION;T(s,e,++i);T(s,t,i+=4);T(s,n,i+=4);T(s,r,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${e}, l:${t})`);v(this,this._packetRW.write.finalize(s))}channelOpenFail(e,t,n){if(typeof n!=="string")n="";const r=Buffer.byteLength(n);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+r+4);s[i]=l.CHANNEL_OPEN_FAILURE;T(s,e,++i);T(s,t,i+=4);T(s,r,i+=4);i+=4;if(r){s.utf8Write(n,i,r);i+=r}T(s,0,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${e})`);v(this,this._packetRW.write.finalize(s))}service(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t);r[n]=l.SERVICE_REQUEST;T(r,t,++n);r.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${e})`);v(this,this._packetRW.write.finalize(r))}authPassword(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);const i=Buffer.byteLength(t);const s=n?Buffer.byteLength(n):0;let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+r+4+14+4+8+1+4+i+(n?4+s:0));f[o]=l.USERAUTH_REQUEST;T(f,r,++o);f.utf8Write(e,o+=4,r);T(f,14,o+=r);f.utf8Write("ssh-connection",o+=4,14);T(f,8,o+=14);f.utf8Write("password",o+=4,8);f[o+=8]=n?1:0;T(f,i,++o);if(Buffer.isBuffer(t))C(t,f,0,i,o+=4);else f.utf8Write(t,o+=4,i);if(n){T(f,s,o+=i);if(Buffer.isBuffer(n))C(n,f,0,s,o+=4);else f.utf8Write(n,o+=4,s);this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")}else{this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)")}this._authsQueue.push("password");v(this,this._packetRW.write.finalize(f))}authPK(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");t=w(t);if(t instanceof Error)throw new Error("Invalid key");const i=t.type;t=t.getPublicSSH();if(typeof n==="function"){r=n;n=undefined}if(!n)n=i;const s=Buffer.byteLength(e);const o=Buffer.byteLength(n);const f=t.length;const h=this._kex.sessionID;const u=h.length;const g=(r?4+u:0)+1+4+s+4+14+4+9+1+4+o+4+f;let p;let _;if(r){p=Buffer.allocUnsafe(g);_=0;T(p,u,_);p.set(h,_+=4);_+=u}else{p=this._packetRW.write.alloc(g);_=this._packetRW.write.allocStart}p[_]=l.USERAUTH_REQUEST;T(p,s,++_);p.utf8Write(e,_+=4,s);T(p,14,_+=s);p.utf8Write("ssh-connection",_+=4,14);T(p,9,_+=14);p.utf8Write("publickey",_+=4,9);p[_+=9]=r?1:0;T(p,o,++_);p.utf8Write(n,_+=4,o);T(p,f,_+=o);p.set(t,_+=4);if(!r){this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)");v(this,this._packetRW.write.finalize(p));return}r(p,(r=>{r=R(r,i);if(r===false)throw new Error("Error while converting handshake signature");const h=r.length;_=this._packetRW.write.allocStart;p=this._packetRW.write.alloc(1+4+s+4+14+4+9+1+4+o+4+f+4+4+o+4+h);p[_]=l.USERAUTH_REQUEST;T(p,s,++_);p.utf8Write(e,_+=4,s);T(p,14,_+=s);p.utf8Write("ssh-connection",_+=4,14);T(p,9,_+=14);p.utf8Write("publickey",_+=4,9);p[_+=9]=1;T(p,o,++_);p.utf8Write(n,_+=4,o);T(p,f,_+=o);p.set(t,_+=4);T(p,4+o+4+h,_+=f);T(p,o,_+=4);p.utf8Write(n,_+=4,o);T(p,h,_+=o);p.set(r,_+=4);this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)");v(this,this._packetRW.write.finalize(p))}))}authHostbased(e,t,n,r,i,s){if(this._server)throw new Error("Client-only method called in server mode");t=w(t);if(t instanceof Error)throw new Error("Invalid key");const o=t.type;t=t.getPublicSSH();if(typeof i==="function"){s=i;i=undefined}if(!i)i=o;const f=Buffer.byteLength(e);const h=Buffer.byteLength(i);const u=t.length;const g=this._kex.sessionID;const p=g.length;const _=Buffer.byteLength(n);const E=Buffer.byteLength(r);const y=Buffer.allocUnsafe(4+p+1+4+f+4+14+4+9+4+h+4+u+4+_+4+E);let I=0;T(y,p,I);y.set(g,I+=4);y[I+=p]=l.USERAUTH_REQUEST;T(y,f,++I);y.utf8Write(e,I+=4,f);T(y,14,I+=f);y.utf8Write("ssh-connection",I+=4,14);T(y,9,I+=14);y.utf8Write("hostbased",I+=4,9);T(y,h,I+=9);y.utf8Write(i,I+=4,h);T(y,u,I+=h);y.set(t,I+=4);T(y,_,I+=u);y.utf8Write(n,I+=4,_);T(y,E,I+=_);y.utf8Write(r,I+=4,E);s(y,(e=>{e=R(e,o);if(!e)throw new Error("Error while converting handshake signature");const t=e.length;const n=y.length-p-4;I=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(n+4+4+h+4+t);C(y,r,4+p,y.length,I);T(r,4+h+4+t,I+=n);T(r,h,I+=4);r.utf8Write(i,I+=4,h);T(r,t,I+=h);r.set(e,I+=4);this._authsQueue.push("hostbased");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)");v(this,this._packetRW.write.finalize(r))}))}authKeyboard(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4+14+4+20+4+4);r[n]=l.USERAUTH_REQUEST;T(r,t,++n);r.utf8Write(e,n+=4,t);T(r,14,n+=t);r.utf8Write("ssh-connection",n+=4,14);T(r,20,n+=14);r.utf8Write("keyboard-interactive",n+=4,20);T(r,0,n+=20);T(r,0,n+=4);this._authsQueue.push("keyboard-interactive");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)");v(this,this._packetRW.write.finalize(r))}authNone(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4+14+4+4);r[n]=l.USERAUTH_REQUEST;T(r,t,++n);r.utf8Write(e,n+=4,t);T(r,14,n+=t);r.utf8Write("ssh-connection",n+=4,14);T(r,4,n+=14);r.utf8Write("none",n+=4,4);this._authsQueue.push("none");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)");v(this,this._packetRW.write.finalize(r))}authInfoRes(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;let n;if(e){n=new Array(e.length);for(let r=0;r<e.length;++r){const i=Buffer.byteLength(e[r]);n[r]=i;t+=4+i}}let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t);i[r]=l.USERAUTH_INFO_RESPONSE;if(e){T(i,e.length,++r);r+=4;for(let t=0;t<e.length;++t){const s=n[t];T(i,s,r);r+=4;if(s){i.utf8Write(e[t],r,s);r+=s}}}else{T(i,0,++r)}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE");v(this,this._packetRW.write.finalize(i))}tcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+13+1+4+r+4);s[i]=l.GLOBAL_REQUEST;T(s,13,++i);s.utf8Write("tcpip-forward",i+=4,13);s[i+=13]=n===undefined||n===true?1:0;T(s,r,++i);s.utf8Write(e,i+=4,r);T(s,t,i+=r);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)");v(this,this._packetRW.write.finalize(s))}cancelTcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+20+1+4+r+4);s[i]=l.GLOBAL_REQUEST;T(s,20,++i);s.utf8Write("cancel-tcpip-forward",i+=4,20);s[i+=20]=n===undefined||n===true?1:0;T(s,r,++i);s.utf8Write(e,i+=4,r);T(s,t,i+=r);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)");v(this,this._packetRW.write.finalize(s))}openssh_streamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+31+1+4+n);i[r]=l.GLOBAL_REQUEST;T(i,31,++r);i.utf8Write("streamlocal-forward@openssh.com",r+=4,31);i[r+=31]=t===undefined||t===true?1:0;T(i,n,++r);i.utf8Write(e,r+=4,n);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)");v(this,this._packetRW.write.finalize(i))}openssh_cancelStreamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+38+1+4+n);i[r]=l.GLOBAL_REQUEST;T(i,38,++r);i.utf8Write("cancel-streamlocal-forward@openssh.com",r+=4,38);i[r+=38]=t===undefined||t===true?1:0;T(i,n,++r);i.utf8Write(e,r+=4,n);if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST "+"(cancel-streamlocal-forward@openssh.com)")}v(this,this._packetRW.write.finalize(i))}directTcpip(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r.srcIP);const s=Buffer.byteLength(r.dstIP);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+12+4+4+4+4+i+4+4+s+4);f[o]=l.CHANNEL_OPEN;T(f,12,++o);f.utf8Write("direct-tcpip",o+=4,12);T(f,e,o+=12);T(f,t,o+=4);T(f,n,o+=4);T(f,s,o+=4);f.utf8Write(r.dstIP,o+=4,s);T(f,r.dstPort,o+=s);T(f,i,o+=4);f.utf8Write(r.srcIP,o+=4,i);T(f,r.srcPort,o+=i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, direct-tcpip)`);v(this,this._packetRW.write.finalize(f))}openssh_directStreamLocal(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r.socketPath);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+30+4+4+4+4+i+4+4);o[s]=l.CHANNEL_OPEN;T(o,30,++s);o.utf8Write("direct-streamlocal@openssh.com",s+=4,30);T(o,e,s+=30);T(o,t,s+=4);T(o,n,s+=4);T(o,i,s+=4);o.utf8Write(r.socketPath,s+=4,i);B(o,0,s+=i,s+8);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, direct-streamlocal@openssh.com)`)}v(this,this._packetRW.write.finalize(o))}openssh_noMoreSessions(e){if(this._server)throw new Error("Client-only method called in server mode");let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4+28+1);n[t]=l.GLOBAL_REQUEST;T(n,28,++t);n.utf8Write("no-more-sessions@openssh.com",t+=4,28);n[t+=28]=e===undefined||e===true?1:0;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)");v(this,this._packetRW.write.finalize(n))}session(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+7+4+4+4);i[r]=l.CHANNEL_OPEN;T(i,7,++r);i.utf8Write("session",r+=4,7);T(i,e,r+=7);T(i,t,r+=4);T(i,n,r+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, session)`);v(this,this._packetRW.write.finalize(i))}windowChange(e,t,n,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);o[s]=l.CHANNEL_REQUEST;T(o,e,++s);T(o,13,s+=4);o.utf8Write("window-change",s+=4,13);o[s+=13]=0;T(o,n,++s);T(o,t,s+=4);T(o,i,s+=4);T(o,r,s+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, window-change)`);v(this,this._packetRW.write.finalize(o))}pty(e,t,n,r,i,s,o,f){if(this._server)throw new Error("Client-only method called in server mode");if(!s||!s.length)s="vt100";if(o&&!Buffer.isBuffer(o)&&!Array.isArray(o)&&typeof o==="object"&&o!==null){o=modesToBytes(o)}if(!o||!o.length)o=Y;const h=s.length;const u=o.length;let g=this._packetRW.write.allocStart;const p=this._packetRW.write.alloc(1+4+4+7+1+4+h+4+4+4+4+4+u);p[g]=l.CHANNEL_REQUEST;T(p,e,++g);T(p,7,g+=4);p.utf8Write("pty-req",g+=4,7);p[g+=7]=f===undefined||f===true?1:0;T(p,h,++g);p.utf8Write(s,g+=4,h);T(p,n,g+=h);T(p,t,g+=4);T(p,i,g+=4);T(p,r,g+=4);T(p,u,g+=4);g+=4;if(Array.isArray(o)){for(let e=0;e<u;++e)p[g++]=o[e]}else if(Buffer.isBuffer(o)){p.set(o,g)}this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, pty-req)`);v(this,this._packetRW.write.finalize(p))}shell(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+5+1);r[n]=l.CHANNEL_REQUEST;T(r,e,++n);T(r,5,n+=4);r.utf8Write("shell",n+=4,5);r[n+=5]=t===undefined||t===true?1:0;this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, shell)`);v(this,this._packetRW.write.finalize(r))}exec(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.isBuffer(t);const i=r?t.length:Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+1+4+i);o[s]=l.CHANNEL_REQUEST;T(o,e,++s);T(o,4,s+=4);o.utf8Write("exec",s+=4,4);o[s+=4]=n===undefined||n===true?1:0;T(o,i,++s);if(r)o.set(t,s+=4);else o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exec: ${t})`);v(this,this._packetRW.write.finalize(o))}signal(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=t;t=t.toUpperCase();if(t.slice(0,3)==="SIG")t=t.slice(3);if(g[t]!==1)throw new Error(`Invalid signal: ${n}`);const r=t.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+6+1+4+r);s[i]=l.CHANNEL_REQUEST;T(s,e,++i);T(s,6,i+=4);s.utf8Write("signal",i+=4,6);s[i+=6]=0;T(s,r,++i);s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, signal: ${t})`);v(this,this._packetRW.write.finalize(s))}env(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);const s=Buffer.isBuffer(n);const o=s?n.length:Buffer.byteLength(n);let f=this._packetRW.write.allocStart;const h=this._packetRW.write.alloc(1+4+4+3+1+4+i+4+o);h[f]=l.CHANNEL_REQUEST;T(h,e,++f);T(h,3,f+=4);h.utf8Write("env",f+=4,3);h[f+=3]=r===undefined||r===true?1:0;T(h,i,++f);h.utf8Write(t,f+=4,i);T(h,o,f+=i);if(s)h.set(n,f+=4);else h.utf8Write(n,f+=4,o);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, env: ${t}=${n})`);v(this,this._packetRW.write.finalize(h))}x11Forward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=t.protocol;const i=t.cookie;const s=Buffer.isBuffer(r);const o=s?r.length:Buffer.byteLength(r);const f=Buffer.isBuffer(i);const h=f?i.length:Buffer.byteLength(i);let u=this._packetRW.write.allocStart;const g=this._packetRW.write.alloc(1+4+4+7+1+1+4+o+4+h+4);g[u]=l.CHANNEL_REQUEST;T(g,e,++u);T(g,7,u+=4);g.utf8Write("x11-req",u+=4,7);g[u+=7]=n===undefined||n===true?1:0;g[++u]=t.single?1:0;T(g,o,++u);if(s)g.set(r,u+=4);else g.utf8Write(r,u+=4,o);T(g,h,u+=o);if(f)g.set(i,u+=4);else g.latin1Write(i,u+=4,h);T(g,t.screen||0,u+=h);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, x11-req)`);v(this,this._packetRW.write.finalize(g))}subsystem(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+9+1+4+r);s[i]=l.CHANNEL_REQUEST;T(s,e,++i);T(s,9,i+=4);s.utf8Write("subsystem",i+=4,9);s[i+=9]=n===undefined||n===true?1:0;T(s,r,++i);s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, subsystem: ${t})`);v(this,this._packetRW.write.finalize(s))}openssh_agentForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+26+1);r[n]=l.CHANNEL_REQUEST;T(r,e,++n);T(r,26,n+=4);r.utf8Write("auth-agent-req@openssh.com",n+=4,26);r[n+=26]=t===undefined||t===true?1:0;if(this._debug){this._debug("Outbound: Sending CHANNEL_REQUEST "+`(r:${e}, auth-agent-req@openssh.com)`)}v(this,this._packetRW.write.finalize(r))}openssh_hostKeysProve(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;const n=[];for(const r of e){const e=r.getPublicSSH();t+=4+e.length;n.push(e)}let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+29+1+t);i[r]=l.GLOBAL_REQUEST;T(i,29,++r);i.utf8Write("hostkeys-prove-00@openssh.com",r+=4,29);i[r+=29]=1;++r;for(const e of n){T(i,e.length,r);C(e,i,0,e.length,r+=4);r+=e.length}if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)")}v(this,this._packetRW.write.finalize(i))}serviceAccept(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t);r[n]=l.SERVICE_ACCEPT;T(r,t,++n);r.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${e})`);v(this,this._packetRW.write.finalize(r));if(this._server&&this._banner&&e==="ssh-userauth"){const e=this._banner;this._banner=undefined;const t=Buffer.byteLength(e);n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4);r[n]=l.USERAUTH_BANNER;T(r,t,++n);r.utf8Write(e,n+=4,t);T(r,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER");v(this,this._packetRW.write.finalize(r))}}forwardedTcpip(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.boundAddr);const s=Buffer.byteLength(r.remoteAddr);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+15+4+4+4+4+i+4+4+s+4);f[o]=l.CHANNEL_OPEN;T(f,15,++o);f.utf8Write("forwarded-tcpip",o+=4,15);T(f,e,o+=15);T(f,t,o+=4);T(f,n,o+=4);T(f,i,o+=4);f.utf8Write(r.boundAddr,o+=4,i);T(f,r.boundPort,o+=i);T(f,s,o+=4);f.utf8Write(r.remoteAddr,o+=4,s);T(f,r.remotePort,o+=s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, forwarded-tcpip)`);v(this,this._packetRW.write.finalize(f))}x11(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.originAddr);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+3+4+4+4+4+i+4);o[s]=l.CHANNEL_OPEN;T(o,3,++s);o.utf8Write("x11",s+=4,3);T(o,e,s+=3);T(o,t,s+=4);T(o,n,s+=4);T(o,i,s+=4);o.utf8Write(r.originAddr,s+=4,i);T(o,r.originPort,s+=i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, x11)`);v(this,this._packetRW.write.finalize(o))}openssh_authAgent(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+22+4+4+4);i[r]=l.CHANNEL_OPEN;T(i,22,++r);i.utf8Write("auth-agent@openssh.com",r+=4,22);T(i,e,r+=22);T(i,t,r+=4);T(i,n,r+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, auth-agent@openssh.com)`);v(this,this._packetRW.write.finalize(i))}openssh_forwardedStreamLocal(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.socketPath);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+33+4+4+4+4+i+4);o[s]=l.CHANNEL_OPEN;T(o,33,++s);o.utf8Write("forwarded-streamlocal@openssh.com",s+=4,33);T(o,e,s+=33);T(o,t,s+=4);T(o,n,s+=4);T(o,i,s+=4);o.utf8Write(r.socketPath,s+=4,i);T(o,0,s+=i);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, forwarded-streamlocal@openssh.com)`)}v(this,this._packetRW.write.finalize(o))}exitStatus(e,t){if(!this._server)throw new Error("Server-only method called in client mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+11+1+4);r[n]=l.CHANNEL_REQUEST;T(r,e,++n);T(r,11,n+=4);r.utf8Write("exit-status",n+=4,11);r[n+=11]=0;T(r,t,++n);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-status: ${t})`);v(this,this._packetRW.write.finalize(r))}exitSignal(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=t;if(typeof i!=="string"||!i)throw new Error(`Invalid signal: ${i}`);let s=t.toUpperCase();if(s.slice(0,3)==="SIG")s=s.slice(3);if(g[s]!==1)throw new Error(`Invalid signal: ${i}`);const o=Buffer.byteLength(s);const f=r?Buffer.byteLength(r):0;let h=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+4+11+1+4+o+1+4+f+4);u[h]=l.CHANNEL_REQUEST;T(u,e,++h);T(u,11,h+=4);u.utf8Write("exit-signal",h+=4,11);u[h+=11]=0;T(u,o,++h);u.utf8Write(s,h+=4,o);u[h+=o]=n?1:0;T(u,f,++h);h+=4;if(f){u.utf8Write(r,h,f);h+=f}T(u,0,h);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-signal: ${t})`);v(this,this._packetRW.write.finalize(u))}authFailure(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let n;if(typeof e==="boolean"){t=e;e=undefined}if(e){n=[];for(let t=0;t<e.length;++t){if(e[t].toLowerCase()==="none")continue;n.push(e[t])}n=n.join(",")}else{n=""}const r=n.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+r+1);s[i]=l.USERAUTH_FAILURE;T(s,r,++i);s.utf8Write(n,i+=4,r);s[i+=r]=t===true?1:0;this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE");v(this,this._packetRW.write.finalize(s))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=l.USERAUTH_SUCCESS;this._authsQueue.shift();this._authenticated=true;this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS");v(this,this._packetRW.write.finalize(t));if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.read=new O;if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.write=new L(this)}authPKOK(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');const n=Buffer.byteLength(e);const r=t.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+n+4+r);s[i]=l.USERAUTH_PK_OK;T(s,n,++i);s.utf8Write(e,i+=4,n);T(s,r,i+=n);s.set(t,i+=4);this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK");v(this,this._packetRW.write.finalize(s))}authPasswdChg(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4);r[n]=l.USERAUTH_PASSWD_CHANGEREQ;T(r,t,++n);r.utf8Write(e,n+=4,t);T(r,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ");v(this,this._packetRW.write.finalize(r))}authInfoReq(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let r=0;const i=e?Buffer.byteLength(e):0;const s=t?Buffer.byteLength(t):0;for(let e=0;e<n.length;++e)r+=4+Buffer.byteLength(n[e].prompt)+1;let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+i+4+s+4+4+r);f[o]=l.USERAUTH_INFO_REQUEST;T(f,i,++o);o+=4;if(e){f.utf8Write(e,o,i);o+=i}T(f,s,o);o+=4;if(t){f.utf8Write(t,o,s);o+=s}T(f,0,o);T(f,n.length,o+=4);o+=4;for(let e=0;e<n.length;++e){const t=n[e];const r=Buffer.byteLength(t.prompt);T(f,r,o);o+=4;if(r){f.utf8Write(t.prompt,o,r);o+=r}f[o++]=t.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST");v(this,this._packetRW.write.finalize(f))}}const V=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function parseHeader(e,t,n){let i;let s;if(this._buffer){i=Buffer.allocUnsafe(this._buffer.length+(n-t));i.set(this._buffer,0);if(t===0){i.set(e,this._buffer.length)}else{i.set(new Uint8Array(e.buffer,e.byteOffset+t,n-t),this._buffer.length)}s=this._buffer.length;t=0}else{i=e;s=0}const f=t;let h=t;let u=t;let l=false;let g=0;let p=0;for(;t<i.length;++t){const e=i[t];if(e===13){l=true;continue}if(e===10){if(u>h&&u-h>4&&i[h]===83&&i[h+1]===83&&i[h+2]===72&&i[h+3]===45){const e=i.latin1Slice(f,u+1);const l=h===f?e:e.slice(h-f);const g=V.exec(l);if(!g)throw new Error("Invalid identification string");const p={greeting:h===f?"":e.slice(0,h-f),identRaw:l,versions:{protocol:g[1],software:g[2]},comments:g[3]};this._remoteIdentRaw=Buffer.from(l);this._debug&&this._debug(`Remote ident: ${r(l)}`);this._compatFlags=getCompatFlags(p);this._buffer=undefined;this._decipher=new o(0,b.bind(this,{firstPacket:true}));this._parse=parsePacket;this._onHeader(p);if(!this._destruct){return n}I(this);return t+1-s}if(this._server)throw new Error("Greetings from clients not permitted");if(++p>G)throw new Error("Max greeting lines exceeded");l=false;h=t+1;g=0}else if(l){throw new Error("Invalid header: expected newline")}else if(++g>=q){throw new Error("Header line too long")}u=t}if(!this._buffer)this._buffer=k(i,f);return t-s}function parsePacket(e,t,n){return this._decipher.decrypt(e,t,n)}function onPayload(e){this._onPacket();if(e.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}e=this._packetRW.read.read(e);const t=e[0];if(t===l.USERAUTH_SUCCESS&&!this._server&&!this._authenticated){this._authenticated=true;if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.write=new L(this);if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.read=new O}const n=m[t];if(n===undefined){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return n(this,e)}function getCompatFlags(e){const t=e.versions.software;let n=0;for(const e of f){if(typeof e[0]==="string"){if(t===e[0])n|=e[1]}else if(e[0].test(t)){n|=e[1]}}return n}function modesToBytes(e){const t=Object.keys(e);const n=Buffer.allocUnsafe(5*t.length+1);let r=0;for(let i=0;i<t.length;++i){const s=t[i];if(s==="TTY_OP_END")continue;const o=p[s];if(o===undefined)continue;const f=e[s];if(typeof f==="number"&&isFinite(f)){n[r++]=o;n[r++]=f>>>24;n[r++]=f>>>16;n[r++]=f>>>8;n[r++]=f}}n[r++]=p.TTY_OP_END;if(r<n.length)return k(n,0,r);return n}function sendExtInfo(e){let t="ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521"+"rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss";if(u)t=`ssh-ed25519,${t}`;const n=Buffer.byteLength(t);let r=e._packetRW.write.allocStart;const i=e._packetRW.write.alloc(1+4+4+15+4+n);i[r]=l.EXT_INFO;T(i,1,++r);T(i,15,r+=4);i.utf8Write("server-sig-algs",r+=4,15);T(i,n,r+=15);i.utf8Write(t,r+=4,n);e._debug&&e._debug("Outbound: Sending EXT_INFO");v(e,e._packetRW.write.finalize(i))}e.exports=Protocol},593:(e,t,n)=>{"use strict";const r=n(361);const i=n(147);const{constants:s}=i;const{Readable:o,Writable:f}=n(781);const{inherits:h,types:{isDate:u}}=n(837);const l=Buffer[Symbol.species];const{bufferCopy:g,bufferSlice:p,makeBufferParser:_,writeUInt32BE:E}=n(775);const y={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648};const I=Buffer.alloc(28);const b={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};const w=new Map(Object.values(b).map((e=>[e,1])));const m={[b.OK]:"No error",[b.EOF]:"End of file",[b.NO_SUCH_FILE]:"No such file or directory",[b.PERMISSION_DENIED]:"Permission denied",[b.FAILURE]:"Failure",[b.BAD_MESSAGE]:"Bad message",[b.NO_CONNECTION]:"No connection",[b.CONNECTION_LOST]:"Connection lost",[b.OP_UNSUPPORTED]:"Operation unsupported"};const C={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};const B={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};const k={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};const R=2*1024;const v=2**32-1;const T=Buffer.from([0,0,0,5,C.INIT,0,0,0,3]);const U=Buffer.from([0,0,0,5,B.VERSION,0,0,0,3]);const P=/^SSH-2.0-(?:OpenSSH|dropbear)/;const O=256*1024;const L=_();const D={readable:false,writable:false,push:e=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function noop(){}class SFTP extends r{constructor(e,t,n){super();if(typeof n!=="object"||!n)n={};const r=e._protocol._remoteIdentRaw;this.server=!!n.server;this._debug=typeof n.debug==="function"?n.debug:undefined;this._isOpenSSH=r&&P.test(r);this._version=-1;this._extensions={};this._biOpt=n.biOpt;this._pktLenBytes=0;this._pktLen=0;this._pktPos=0;this._pktType=0;this._pktData=undefined;this._writeReqid=-1;this._requests={};this._maxInPktLen=O;this._maxOutPktLen=34e3;this._maxReadLen=(this._isOpenSSH?O:34e3)-R;this._maxWriteLen=(this._isOpenSSH?O:34e3)-R;this.maxOpenHandles=undefined;this._client=e;this._protocol=e._protocol;this._callbacks=[];this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this._waitWindow=false;this._chunkcb=undefined;this._buffer=[];this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this.stderr=D;this.readable=true}push(e){if(e===null){cleanupRequests(this);if(!this.readable)return;this.readable=false;this.emit("end");return}let t=0;while(t<e.length){if(this._pktLenBytes<4){let n=Math.min(4-this._pktLenBytes,e.length-t);this._pktLenBytes+=n;while(n--)this._pktLen=(this._pktLen<<8)+e[t++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return doFatalSFTPError(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){const e=this._maxInPktLen;return doFatalSFTPError(this,`Packet length ${this._pktLen} exceeds max length of ${e}`)}if(t>=e.length)return}if(this._pktPos<this._pktLen){const n=Math.min(this._pktLen-this._pktPos,e.length-t);if(t!==0||n!==e.length){if(n===this._pktLen){this._pkt=new l(e.buffer,e.byteOffset+t,n)}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(new Uint8Array(e.buffer,e.byteOffset+t,n),this._pktPos)}}else if(n===this._pktLen){this._pkt=e}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(e,this._pktPos)}t+=n;this._pktPos+=n;if(this._pktPos<this._pktLen)return}const n=this._pkt[0];const r=this._pkt;this._pktLen=0;this._pktLenBytes=0;this._pkt=undefined;this._pktPos=0;const i=this.server?q[n]:W[n];if(!i)return doFatalSFTPError(this,`Unknown packet type ${n}`);if(this._version===-1){if(this.server){if(n!==C.INIT)return doFatalSFTPError(this,`Expected INIT packet, got ${n}`)}else if(n!==B.VERSION){return doFatalSFTPError(this,`Expected VERSION packet, got ${n}`)}}if(i(this,r)===false)return}}end(){this.destroy()}destroy(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._protocol.channelClose(this.outgoing.id)}}_init(){this._init=noop;if(!this.server)sendOrBuffer(this,T)}createReadStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new ReadStream(this,e,t)}createWriteStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new WriteStream(this,e,t)}open(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");if(typeof n==="function"){r=n;n=undefined}const i=typeof t==="number"?t:stringToFlags(t);if(i===null)throw new Error(`Unknown flags string: ${t}`);let s=0;let o=0;if(typeof n==="string"||typeof n==="number")n={mode:n};if(typeof n==="object"&&n!==null){n=attrsToBytes(n);s=n.flags;o=n.nb}const f=Buffer.byteLength(e);let h=9;const u=Buffer.allocUnsafe(4+1+4+4+f+4+4+o);E(u,u.length-4,0);u[4]=C.OPEN;const l=this._writeReqid=this._writeReqid+1&v;E(u,l,5);E(u,f,h);u.utf8Write(e,h+=4,f);E(u,i,h+=f);E(u,s,h+=4);if(o){h+=4;if(o===I.length)u.set(I,h);else g(I,u,0,o,h);h+=o}this._requests[l]={cb:r};const p=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${p?"Buffered":"Sending"} OPEN`)}close(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.CLOSE;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.set(e,r+=4);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} CLOSE`)}read(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>=t.length)throw new Error("offset is out of bounds");if(n+r>t.length)throw new Error("length extends beyond buffer");if(i===null)throw new Error("null position currently unsupported");read_(this,e,t,n,r,i,s)}readData(e,t,n,r,i,s){this.read(e,t,n,r,i,s)}write(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>t.length)throw new Error("offset is out of bounds");if(n+r>t.length)throw new Error("length extends beyond buffer");if(i===null)throw new Error("null position currently unsupported");if(!r){s&&process.nextTick(s,undefined,0);return}const o=this._maxWriteLen;const f=Math.max(r-o,0);const h=i;if(f)r=o;const u=e.length;let l=9;const p=Buffer.allocUnsafe(4+1+4+4+u+8+4+r);E(p,p.length-4,0);p[4]=C.WRITE;const _=this._writeReqid=this._writeReqid+1&v;E(p,_,5);E(p,u,l);p.set(e,l+=4);l+=u;for(let e=7;e>=0;--e){p[l+e]=i&255;i/=256}E(p,r,l+=8);g(t,p,n,n+r,l+=4);this._requests[_]={cb:i=>{if(i){if(typeof s==="function")s(i)}else if(f){this.write(e,t,n+r,f,h+r,s)}else if(typeof s==="function"){s(undefined,n+r)}}};const y=sendOrBuffer(this,p);if(this._debug){const e=y?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${e} WRITE (id:${_})`)}}writeData(e,t,n,r,i,s){this.write(e,t,n,r,i,s)}fastGet(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(this,i,e,t,n,r)}fastPut(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(i,this,e,t,n,r)}readFile(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r;if(typeof n==="function"){r=n}else if(typeof t==="function"){r=t;t=undefined}if(typeof t==="string")t={encoding:t,flag:"r"};else if(!t)t={encoding:null,flag:"r"};else if(typeof t!=="object")throw new TypeError("Bad arguments");const i=t.encoding;if(i&&!Buffer.isEncoding(i))throw new Error(`Unknown encoding: ${i}`);let s;let o;let f;let h=0;let u;let l=0;const g=t.flag||"r";const read=()=>{if(s===0){o=Buffer.allocUnsafe(8192);this.read(u,o,0,8192,l,afterRead)}else{this.read(u,o,h,s-h,l,afterRead)}};const afterRead=(e,t)=>{let n;if(e){n=e.code===b.EOF;if(!n){return this.close(u,(()=>r&&r(e)))}}else{n=false}if(n||s===0&&t===0)return close();l+=t;h+=t;if(s!==0){if(h===s)close();else read()}else{f.push(p(o,0,t));read()}};afterRead._wantEOFError=true;const close=()=>{this.close(u,(e=>{if(s===0){o=Buffer.concat(f,h)}else if(h<s){o=p(o,0,h)}if(i)o=o.toString(i);return r&&r(e,o)}))};this.open(e,g,438,((t,n)=>{if(t)return r&&r(t);u=n;const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(u,(()=>{r&&r(t)}))}tryStat(null,n)}));return}s=n.size||0;if(s===0){f=[];return read()}o=Buffer.allocUnsafe(s);read()};this.fstat(u,tryStat)}))}writeFile(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r==="function"){i=r}else if(typeof n==="function"){i=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"w"};else if(!n)n={encoding:"utf8",mode:438,flag:"w"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(n.encoding&&!Buffer.isEncoding(n.encoding))throw new Error(`Unknown encoding: ${n.encoding}`);const s=n.flag||"w";this.open(e,s,n.mode,((r,o)=>{if(r){i&&i(r)}else{const r=Buffer.isBuffer(t)?t:Buffer.from(""+t,n.encoding||"utf8");const f=/a/.test(s)?null:0;if(f===null){const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(o,(()=>{i&&i(t)}))}tryStat(null,n)}));return}writeAll(this,o,r,0,r.length,n.size,i)};this.fstat(o,tryStat);return}writeAll(this,o,r,0,r.length,f,i)}}))}appendFile(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r==="function"){i=r}else if(typeof n==="function"){i=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"a"};else if(!n)n={encoding:"utf8",mode:438,flag:"a"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(!n.flag)n=Object.assign({flag:"a"},n);this.writeFile(e,t,n,i)}exists(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,(e=>{t&&t(e?false:true)}))}unlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.REMOVE;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} REMOVE`)}rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);const i=Buffer.byteLength(t);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+r+4+i);E(o,o.length-4,0);o[4]=C.RENAME;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);E(o,r,s);o.utf8Write(e,s+=4,r);E(o,i,s+=r);o.utf8Write(t,s+=4,i);this._requests[f]={cb:n};const h=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} RENAME`)}mkdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r=0;let i=0;if(typeof t==="function"){n=t;t=undefined}if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}const s=Buffer.byteLength(e);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.MKDIR;const h=this._writeReqid=this._writeReqid+1&v;E(f,h,5);E(f,s,o);f.utf8Write(e,o+=4,s);E(f,r,o+=s);if(i){o+=4;if(i===I.length)f.set(I,o);else g(I,f,0,i,o);o+=i}this._requests[h]={cb:n};const u=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} MKDIR`)}rmdir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.RMDIR;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} RMDIR`)}readdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(typeof t==="function"){n=t;t={}}if(typeof t!=="object"||t===null)t={};const r=t&&t.full?false:true;if(!Buffer.isBuffer(e)&&typeof e!=="string")throw new Error("missing directory handle or path");if(typeof e==="string"){const r=[];let i=0;const reread=(e,s)=>{if(e)return n(e);this.readdir(s,t,((e,t)=>{const o=e&&e.code===b.EOF;if(e&&!o)return this.close(s,(()=>n(e)));if(o){return this.close(s,(e=>{if(e)return n(e);n(undefined,r)}))}for(let e=0;e<t.length;++e,++i)r[i]=t[e];reread(undefined,s)}))};return this.opendir(e,reread)}const i=e.length;let s=9;const o=Buffer.allocUnsafe(4+1+4+4+i);E(o,o.length-4,0);o[4]=C.READDIR;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);E(o,i,s);o.set(e,s+=4);this._requests[f]={cb:r?(e,t)=>{if(typeof n!=="function")return;if(e)return n(e);for(let e=t.length-1;e>=0;--e){if(t[e].filename==="."||t[e].filename==="..")t.splice(e,1)}n(undefined,t)}:n};const h=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} READDIR`)}fstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.FSTAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.set(e,r+=4);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} FSTAT`)}stat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.STAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} STAT`)}lstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.LSTAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} LSTAT`)}opendir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.OPENDIR;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} OPENDIR`)}setstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r=0;let i=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}else if(typeof t==="function"){n=t}const s=Buffer.byteLength(e);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.SETSTAT;const h=this._writeReqid=this._writeReqid+1&v;E(f,h,5);E(f,s,o);f.utf8Write(e,o+=4,s);E(f,r,o+=s);if(i){o+=4;if(i===I.length)f.set(I,o);else g(I,f,0,i,o);o+=i}this._requests[h]={cb:n};const u=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} SETSTAT`)}fsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let r=0;let i=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}else if(typeof t==="function"){n=t}const s=e.length;let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.FSETSTAT;const h=this._writeReqid=this._writeReqid+1&v;E(f,h,5);E(f,s,o);f.set(e,o+=4);E(f,r,o+=s);if(i){o+=4;if(i===I.length)f.set(I,o);else g(I,f,0,i,o);o+=i}this._requests[h]={cb:n};const u=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} FSETSTAT`)}futimes(e,t,n,r){return this.fsetstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},r)}utimes(e,t,n,r){return this.setstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},r)}fchown(e,t,n,r){return this.fsetstat(e,{uid:t,gid:n},r)}chown(e,t,n,r){return this.setstat(e,{uid:t,gid:n},r)}fchmod(e,t,n){return this.fsetstat(e,{mode:t},n)}chmod(e,t,n){return this.setstat(e,{mode:t},n)}readlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.READLINK;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing link info"));t(undefined,n[0].filename)}};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} READLINK`)}symlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);const i=Buffer.byteLength(e);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+r+4+i);E(o,o.length-4,0);o[4]=C.SYMLINK;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);if(this._isOpenSSH){E(o,i,s);o.utf8Write(e,s+=4,i);E(o,r,s+=i);o.utf8Write(t,s+=4,r)}else{E(o,r,s);o.utf8Write(t,s+=4,r);E(o,i,s+=r);o.utf8Write(e,s+=4,i)}this._requests[f]={cb:n};const h=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SYMLINK`)}realpath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.REALPATH;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing path info"));t(undefined,n[0].filename)}};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["posix-rename@openssh.com"];if(!r||r!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+24+4+i+4+s);E(f,f.length-4,0);f[4]=C.EXTENDED;const h=this._writeReqid=this._writeReqid+1&v;E(f,h,5);E(f,24,o);f.utf8Write("posix-rename@openssh.com",o+=4,24);E(f,i,o+=24);f.utf8Write(e,o+=4,i);E(f,s,o+=i);f.utf8Write(t,o+=4,s);this._requests[h]={cb:n};const u=sendOrBuffer(this,f);if(this._debug){const e=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} posix-rename@openssh.com`)}}ext_openssh_statvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["statvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");const r=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+19+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,19,i);s.utf8Write("statvfs@openssh.com",i+=4,19);E(s,r,i+=19);s.utf8Write(e,i+=4,r);this._requests[o]={extended:"statvfs@openssh.com",cb:t};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} statvfs@openssh.com`)}}ext_openssh_fstatvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fstatvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const r=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+20+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,20,i);s.utf8Write("fstatvfs@openssh.com",i+=4,20);E(s,r,i+=20);s.set(e,i+=4);this._requests[o]={extended:"fstatvfs@openssh.com",cb:t};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} fstatvfs@openssh.com`)}}ext_openssh_hardlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["hardlink@openssh.com"];if(r!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+20+4+i+4+s);E(f,f.length-4,0);f[4]=C.EXTENDED;const h=this._writeReqid=this._writeReqid+1&v;E(f,h,5);E(f,20,o);f.utf8Write("hardlink@openssh.com",o+=4,20);E(f,i,o+=20);f.utf8Write(e,o+=4,i);E(f,s,o+=i);f.utf8Write(t,o+=4,s);this._requests[h]={cb:n};const u=sendOrBuffer(this,f);if(this._debug){const e=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} hardlink@openssh.com`)}}ext_openssh_fsync(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fsync@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const r=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+17+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,17,i);s.utf8Write("fsync@openssh.com",i+=4,17);E(s,r,i+=17);s.set(e,i+=4);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["lsetstat@openssh.com"];if(r!=="1")throw new Error("Server does not support this extended request");let i=0;let s=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);i=t.flags;s=t.nb}else if(typeof t==="function"){n=t}const o=Buffer.byteLength(e);let f=9;const h=Buffer.allocUnsafe(4+1+4+4+20+4+o+4+s);E(h,h.length-4,0);h[4]=C.EXTENDED;const u=this._writeReqid=this._writeReqid+1&v;E(h,u,5);E(h,20,f);h.utf8Write("lsetstat@openssh.com",f+=4,20);E(h,o,f+=20);h.utf8Write(e,f+=4,o);E(h,i,f+=o);if(s){f+=4;if(s===I.length)h.set(I,f);else g(I,h,0,s,f);f+=s}this._requests[u]={cb:n};const l=sendOrBuffer(this,h);if(this._debug){const e=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} lsetstat@openssh.com`)}}ext_openssh_expandPath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["expand-path@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");const r=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+23+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,23,i);s.utf8Write("expand-path@openssh.com",i+=4,23);E(s,r,i+=20);s.utf8Write(e,i+=4,r);this._requests[o]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing expanded path"));t(undefined,n[0].filename)}};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} expand-path@openssh.com`)}}ext_copy_data(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");const o=this._extensions["copy-data"];if(o!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(r))throw new Error("Destination handle is not a Buffer");let f=0;const h=Buffer.allocUnsafe(4+1+4+4+9+4+e.length+8+8+4+r.length+8);E(h,h.length-4,f);f+=4;h[f]=C.EXTENDED;++f;const u=this._writeReqid=this._writeReqid+1&v;E(h,u,f);f+=4;E(h,9,f);f+=4;h.utf8Write("copy-data",f,9);f+=9;E(h,e.length,f);f+=4;h.set(e,f);f+=e.length;for(let e=7;e>=0;--e){h[f+e]=t&255;t/=256}f+=8;for(let e=7;e>=0;--e){h[f+e]=n&255;n/=256}f+=8;E(h,r.length,f);f+=4;h.set(r,f);f+=r.length;for(let e=7;e>=0;--e){h[f+e]=i&255;i/=256}this._requests[u]={cb:s};const l=sendOrBuffer(this,h);if(this._debug){const e=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} copy-data`)}}ext_home_dir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["home-directory"];if(n!=="1")throw new Error("Server does not support this extended request");if(typeof e!=="string")throw new TypeError("username is not a string");let r=0;const i=Buffer.byteLength(e);const s=Buffer.allocUnsafe(4+1+4+4+14+4+i);E(s,s.length-4,r);r+=4;s[r]=C.EXTENDED;++r;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,r);r+=4;E(s,14,r);r+=4;s.utf8Write("home-directory",r,14);r+=14;E(s,i,r);r+=4;s.utf8Write(e,r,i);r+=i;this._requests[o]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing home directory"));t(undefined,n[0].filename)}};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} home-directory`)}}ext_users_groups(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["users-groups-by-id@openssh.com"];if(r!=="1")throw new Error("Server does not support this extended request");if(!Array.isArray(e))throw new TypeError("uids is not an array");for(const t of e){if(!Number.isInteger(t)||t<0||t>2**32-1)throw new Error("uid values must all be 32-bit unsigned integers")}if(!Array.isArray(t))throw new TypeError("gids is not an array");for(const e of t){if(!Number.isInteger(e)||e<0||e>2**32-1)throw new Error("gid values must all be 32-bit unsigned integers")}let i=0;const s=Buffer.allocUnsafe(4+1+4+4+30+4+4*e.length+4+4*t.length);E(s,s.length-4,i);i+=4;s[i]=C.EXTENDED;++i;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,i);i+=4;E(s,30,i);i+=4;s.utf8Write("users-groups-by-id@openssh.com",i,30);i+=30;E(s,4*e.length,i);i+=4;for(const t of e){E(s,t,i);i+=4}E(s,4*t.length,i);i+=4;for(const e of t){E(s,e,i);i+=4}this._requests[o]={extended:"users-groups-by-id@openssh.com",cb:n};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} users-groups-by-id@openssh.com`)}}handle(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const n=t.length;if(n>256)throw new Error("handle too large (> 256 bytes)");let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=B.HANDLE;E(i,e,5);E(i,n,r);if(n)i.set(t,r+=4);const s=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${s?"Buffered":"Sending"} HANDLE`)}status(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!w.has(t))throw new Error(`Bad status code: ${t}`);n||(n="");const r=Buffer.byteLength(n);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+4+r+4);E(s,s.length-4,0);s[4]=B.STATUS;E(s,e,5);E(s,t,i);E(s,r,i+=4);i+=4;if(r){s.utf8Write(n,i,r);i+=r}E(s,0,i);const o=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} STATUS`)}data(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");const r=Buffer.isBuffer(t);if(!r&&typeof t!=="string")throw new Error("data is not a Buffer or string");let i;if(!r&&!n){n=undefined;i=true}const s=r?t.length:Buffer.byteLength(t,n);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s);E(f,f.length-4,0);f[4]=B.DATA;E(f,e,5);E(f,s,o);if(s){if(r)f.set(t,o+=4);else if(i)f.utf8Write(t,o+=4,s);else f.write(t,o+=4,s,n)}const h=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} DATA`)}name(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(t)){if(typeof t!=="object"||t===null)throw new Error("names is not an object or array");t=[t]}const n=t.length;let r=0;let i;const s=[];for(let e=0;e<n;++e){const n=t[e];const o=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;r+=4+Buffer.byteLength(o);const f=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;r+=4+Buffer.byteLength(f);if(typeof n.attrs==="object"&&n.attrs!==null){i=attrsToBytes(n.attrs);r+=4+i.nb;if(i.nb){let e;if(i.nb===I.length){e=new Uint8Array(I)}else{e=new Uint8Array(i.nb);g(I,e,0,i.nb,0)}i.bytes=e}s.push(i)}else{r+=4;s.push(null)}}let o=9;const f=Buffer.allocUnsafe(4+1+4+4+r);E(f,f.length-4,0);f[4]=B.NAME;E(f,e,5);E(f,n,o);o+=4;for(let e=0;e<n;++e){const n=t[e];{const e=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;const t=Buffer.byteLength(e);E(f,t,o);o+=4;if(t){f.utf8Write(e,o,t);o+=t}}{const e=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;const t=Buffer.byteLength(e);E(f,t,o);o+=4;if(t){f.utf8Write(e,o,t);o+=t}}const r=s[e];if(r){E(f,r.flags,o);o+=4;if(r.flags&&r.bytes){f.set(r.bytes,o);o+=r.nb}}else{E(f,0,o);o+=4}}const h=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} NAME`)}attrs(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof t!=="object"||t===null)throw new Error("attrs is not an object");t=attrsToBytes(t);const n=t.flags;const r=t.nb;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+r);E(s,s.length-4,0);s[4]=B.ATTRS;E(s,e,5);E(s,n,i);if(r){i+=4;if(r===I.length)s.set(I,i);else g(I,s,0,r,i);i+=r}const o=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} ATTRS`)}}function tryCreateBuffer(e){try{return Buffer.allocUnsafe(e)}catch(e){return e}}function read_(e,t,n,r,i,s,o,f){const h=e._maxReadLen;const u=Math.max(i-h,0);if(u)i=h;const l=t.length;let g=9;let _=s;const y=Buffer.allocUnsafe(4+1+4+4+l+8+4);E(y,y.length-4,0);y[4]=C.READ;const I=e._writeReqid=e._writeReqid+1&v;E(y,I,5);E(y,l,g);y.set(t,g+=4);g+=l;for(let e=7;e>=0;--e){y[g+e]=_&255;_/=256}E(y,i,g+=8);if(typeof o!=="function")o=noop;const w=f||{nb:0,position:s,off:r,origOff:r,len:undefined,overflow:undefined,cb:(r,i,s)=>{const f=w.len;const h=w.overflow;if(r){if(o._wantEOFError||r.code!==b.EOF)return o(r)}else if(s>f){return o(new Error("Received more data than requested"))}else if(s===f&&h){w.nb+=s;w.position+=s;w.off+=s;read_(e,t,n,w.off,h,w.position,o,w);return}s=s||0;if(w.origOff===0&&n.length===w.nb)i=n;else i=p(n,w.origOff,w.origOff+w.nb+s);o(undefined,w.nb+s,i,w.position)},buffer:undefined};w.len=i;w.overflow=u;w.buffer=p(n,r,r+i);e._requests[I]=w;const m=sendOrBuffer(e,y);e._debug&&e._debug(`SFTP: Outbound: ${m?"Buffered":"Sending"} READ`)}function fastXfer(e,t,n,r,s,o){let f=64;let h=32768;let u;let l;let g;if(typeof s==="function"){o=s}else if(typeof s==="object"&&s!==null){if(typeof s.concurrency==="number"&&s.concurrency>0&&!isNaN(s.concurrency)){f=s.concurrency}if(typeof s.chunkSize==="number"&&s.chunkSize>0&&!isNaN(s.chunkSize)){h=s.chunkSize}if(typeof s.fileSize==="number"&&s.fileSize>0&&!isNaN(s.fileSize)){g=s.fileSize}if(typeof s.step==="function")u=s.step;if(typeof s.mode==="string"||typeof s.mode==="number")l=modeNum(s.mode)}let p;let _=0;let E=0;let y=false;let I;let b;let w;let m=h*f;function onerror(n){if(y)return;y=true;let r=0;let s;if(I||b){s=()=>{if(--r===0)o(n)};if(I&&(e===i||e.outgoing.state==="open"))++r;if(b&&(t===i||t.outgoing.state==="open"))++r;if(I&&(e===i||e.outgoing.state==="open"))e.close(I,s);if(b&&(t===i||t.outgoing.state==="open"))t.close(b,s)}else{o(n)}}e.open(n,"r",((s,y)=>{if(s)return onerror(s);I=y;if(g===undefined)e.fstat(I,tryStat);else tryStat(null,{size:g});function tryStat(s,g){if(s){if(e!==i){e.stat(n,((e,t)=>{if(e)return onerror(s);tryStat(null,t)}));return}return onerror(s)}p=g.size;t.open(r,"w",((n,i)=>{if(n)return onerror(n);b=i;if(p<=0)return onerror();while(m>p){if(f===1){m=p;break}m-=h;--f}w=tryCreateBuffer(m);if(w instanceof Error)return onerror(w);if(l!==undefined){t.fchmod(b,l,(function tryAgain(e){if(e){t.chmod(r,l,(e=>tryAgain()));return}startReads()}))}else{startReads()}function onread(n,r,i,s,f,l){if(n)return onerror(n);f=f||0;t.write(b,w,f,r,s,writeCb);function writeCb(n){if(n)return onerror(n);E+=r;u&&u(E,r,p);if(r<l)return singleRead(f,s+r,l-r);if(E===p){t.close(b,(t=>{b=undefined;if(t)return onerror(t);e.close(I,(e=>{I=undefined;if(e)return onerror(e);o()}))}));return}if(_>=p)return;const i=_+h>p?p-_:h;singleRead(f,_,i);_+=i}}function makeCb(e,t,n){return(r,i,s)=>{onread(r,i,s,t,e,n)}}function singleRead(t,n,r){e.read(I,w,t,r,n,makeCb(t,n,r))}function startReads(){let e=0;let t=0;while(_<p&&e<f){const n=_+h>p?p-_:h;singleRead(t,_,n);t+=n;_+=n;++e}}}))}}))}function writeAll(e,t,n,r,i,s,o){const f=typeof o==="function"?o:undefined;e.write(t,n,r,i,s,((o,h)=>{if(o){return e.close(t,(()=>{f&&f(o)}))}if(h===i){e.close(t,f)}else{r+=h;i-=h;s+=h;writeAll(e,t,n,r,i,s,f)}}))}class Stats{constructor(e){this.mode=e&&e.mode;this.uid=e&&e.uid;this.gid=e&&e.gid;this.size=e&&e.size;this.atime=e&&e.atime;this.mtime=e&&e.mtime;this.extended=e&&e.extended}isDirectory(){return(this.mode&s.S_IFMT)===s.S_IFDIR}isFile(){return(this.mode&s.S_IFMT)===s.S_IFREG}isBlockDevice(){return(this.mode&s.S_IFMT)===s.S_IFBLK}isCharacterDevice(){return(this.mode&s.S_IFMT)===s.S_IFCHR}isSymbolicLink(){return(this.mode&s.S_IFMT)===s.S_IFLNK}isFIFO(){return(this.mode&s.S_IFMT)===s.S_IFIFO}isSocket(){return(this.mode&s.S_IFMT)===s.S_IFSOCK}}function attrsToBytes(e){let t=0;let n=0;if(typeof e==="object"&&e!==null){if(typeof e.size==="number"){t|=y.SIZE;const r=e.size;I[n++]=r/72057594037927940;I[n++]=r/281474976710656;I[n++]=r/1099511627776;I[n++]=r/4294967296;I[n++]=r/16777216;I[n++]=r/65536;I[n++]=r/256;I[n++]=r}if(typeof e.uid==="number"&&typeof e.gid==="number"){t|=y.UIDGID;const r=e.uid;const i=e.gid;I[n++]=r>>>24;I[n++]=r>>>16;I[n++]=r>>>8;I[n++]=r;I[n++]=i>>>24;I[n++]=i>>>16;I[n++]=i>>>8;I[n++]=i}if(typeof e.mode==="number"||typeof e.mode==="string"){const r=modeNum(e.mode);t|=y.PERMISSIONS;I[n++]=r>>>24;I[n++]=r>>>16;I[n++]=r>>>8;I[n++]=r}if((typeof e.atime==="number"||u(e.atime))&&(typeof e.mtime==="number"||u(e.mtime))){const r=toUnixTimestamp(e.atime);const i=toUnixTimestamp(e.mtime);t|=y.ACMODTIME;I[n++]=r>>>24;I[n++]=r>>>16;I[n++]=r>>>8;I[n++]=r;I[n++]=i>>>24;I[n++]=i>>>16;I[n++]=i>>>8;I[n++]=i}}return{flags:t,nb:n}}function toUnixTimestamp(e){if(typeof e==="number"&&e===e)return e;if(u(e))return parseInt(e.getTime()/1e3,10);throw new Error(`Cannot parse time: ${e}`)}function modeNum(e){if(typeof e==="number"&&e===e)return e;if(typeof e==="string")return modeNum(parseInt(e,8));throw new Error(`Cannot parse mode: ${e}`)}const Q={r:k.READ,"r+":k.READ|k.WRITE,w:k.TRUNC|k.CREAT|k.WRITE,wx:k.TRUNC|k.CREAT|k.WRITE|k.EXCL,xw:k.TRUNC|k.CREAT|k.WRITE|k.EXCL,"w+":k.TRUNC|k.CREAT|k.READ|k.WRITE,"wx+":k.TRUNC|k.CREAT|k.READ|k.WRITE|k.EXCL,"xw+":k.TRUNC|k.CREAT|k.READ|k.WRITE|k.EXCL,a:k.APPEND|k.CREAT|k.WRITE,ax:k.APPEND|k.CREAT|k.WRITE|k.EXCL,xa:k.APPEND|k.CREAT|k.WRITE|k.EXCL,"a+":k.APPEND|k.CREAT|k.READ|k.WRITE,"ax+":k.APPEND|k.CREAT|k.READ|k.WRITE|k.EXCL,"xa+":k.APPEND|k.CREAT|k.READ|k.WRITE|k.EXCL};function stringToFlags(e){const t=Q[e];return t!==undefined?t:null}const x=(()=>{const e=Object.keys(Q);return t=>{for(let n=0;n<e.length;++n){const r=e[n];if(Q[r]===t)return r}return null}})();function readAttrs(e){const t=L.readUInt32BE();if(t===undefined)return;const n=new Stats;if(t&y.SIZE){const t=L.readUInt64BE(e);if(t===undefined)return;n.size=t}if(t&y.UIDGID){const e=L.readUInt32BE();const t=L.readUInt32BE();if(t===undefined)return;n.uid=e;n.gid=t}if(t&y.PERMISSIONS){const e=L.readUInt32BE();if(e===undefined)return;n.mode=e}if(t&y.ACMODTIME){const e=L.readUInt32BE();const t=L.readUInt32BE();if(t===undefined)return;n.atime=e;n.mtime=t}if(t&y.EXTENDED){const e=L.readUInt32BE();if(e===undefined)return;const t={};for(let n=0;n<e;++n){const e=L.readString(true);const n=L.readString();if(n===undefined)return;t[e]=n}n.extended=t}return n}function sendOrBuffer(e,t){const n=tryWritePayload(e,t);if(n!==undefined){e._buffer.push(n);return false}return true}function tryWritePayload(e,t){const n=e.outgoing;if(n.state!=="open")return;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer;return t}let r;const i=t.length;let s=0;while(i-s>0&&n.window>0){const r=Math.min(i-s,n.window,n.packetSize);n.window-=r;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer}if(s===0&&r===i){e._protocol.channelData(e.outgoing.id,t)}else{e._protocol.channelData(e.outgoing.id,p(t,s,s+r))}s+=r}if(i-s>0){if(s>0)r=p(t,s,i);else r=t}return r}function drainBuffer(){this._chunkcb=undefined;const e=this._buffer;let t=0;while(t<e.length){const n=e[t];const r=tryWritePayload(this,n);if(r!==undefined){if(r!==n)e[t]=r;if(t>0)this._buffer=e.slice(t);return}++t}if(t>0)this._buffer=[]}function doFatalSFTPError(e,t,n){const r=new Error(t);r.level="sftp-protocol";if(!n&&e._debug)e._debug(`SFTP: Inbound: ${t}`);e.emit("error",r);e.destroy();cleanupRequests(e);return false}function cleanupRequests(e){const t=Object.keys(e._requests);if(t.length===0)return;const n=e._requests;e._requests={};const r=new Error("No response from server");for(let e=0;e<t.length;++e){const i=n[t[e]];if(typeof i.cb==="function")i.cb(r)}}function requestLimits(e,t){let n=9;const r=Buffer.allocUnsafe(4+1+4+4+18);E(r,r.length-4,0);r[4]=C.EXTENDED;const i=e._writeReqid=e._writeReqid+1&v;E(r,i,5);E(r,18,n);r.utf8Write("limits@openssh.com",n+=4,18);e._requests[i]={extended:"limits@openssh.com",cb:t};const s=sendOrBuffer(e,r);if(e._debug){const t=s?"Buffered":"Sending";e._debug(`SFTP: Outbound: ${t} limits@openssh.com`)}}const W={[B.VERSION]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate VERSION packet");const n={};L.init(t,1);let r=L.readUInt32BE();while(L.avail()){const e=L.readString(true);const t=L.readString(true);if(t===undefined){r=undefined;break}n[e]=t}L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed VERSION packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received VERSION (v${r}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received VERSION (v${r})`)}}e._version=r;e._extensions=n;if(n["limits@openssh.com"]==="1"){return requestLimits(e,((t,n)=>{if(!t){if(n.maxPktLen>0)e._maxOutPktLen=n.maxPktLen;if(n.maxReadLen>0)e._maxReadLen=n.maxReadLen;if(n.maxWriteLen>0)e._maxWriteLen=n.maxWriteLen;e.maxOpenHandles=n.maxOpenHandles>0?n.maxOpenHandles:Infinity}e.emit("ready")}))}e.emit("ready")},[B.STATUS]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readUInt32BE();const i=L.readString(true);L.clear();if(e._debug){const t=JSON.stringify(i);e._debug(`SFTP: Inbound: Received STATUS (id:${n}, ${r}, ${t})`)}const s=e._requests[n];delete e._requests[n];if(s&&typeof s.cb==="function"){if(r===b.OK){s.cb();return}const e=new Error(i||m[r]||"Unknown status");e.code=r;s.cb(e)}},[B.HANDLE]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();L.clear();if(r===undefined){if(n!==undefined)delete e._requests[n];return doFatalSFTPError(e,"Malformed HANDLE packet")}e._debug&&e._debug(`SFTP: Inbound: Received HANDLE (id:${n})`);const i=e._requests[n];delete e._requests[n];if(i&&typeof i.cb==="function")i.cb(undefined,r)},[B.DATA]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}if(r&&typeof r.cb==="function"){if(r.buffer){const t=L.readString(r.buffer);L.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);r.cb(undefined,r.buffer,t);return}}else{const t=L.readString();L.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t.length})`);r.cb(undefined,t);return}}}else{const t=L.skipString();L.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);return}}return doFatalSFTPError(e,"Malformed DATA packet")},[B.NAME]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}const i=L.readUInt32BE();if(i!==undefined){let t=[];for(let n=0;n<i;++n){const n=L.readString(true);const r=L.readString(true);const i=readAttrs(e._biOpt);if(i===undefined){t=undefined;break}t.push({filename:n,longname:r,attrs:i})}if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received NAME (id:${n}, ${t.length})`);L.clear();if(r&&typeof r.cb==="function")r.cb(undefined,t);return}}L.clear();return doFatalSFTPError(e,"Malformed NAME packet")},[B.ATTRS]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}const i=readAttrs(e._biOpt);L.clear();if(i!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received ATTRS (id:${n})`);if(r&&typeof r.cb==="function")r.cb(undefined,i);return}return doFatalSFTPError(e,"Malformed ATTRS packet")},[B.EXTENDED]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();if(n!==undefined){const t=e._requests[n];if(t){delete e._requests[n];switch(t.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{const r=e._biOpt;const i={f_bsize:L.readUInt64BE(r),f_frsize:L.readUInt64BE(r),f_blocks:L.readUInt64BE(r),f_bfree:L.readUInt64BE(r),f_bavail:L.readUInt64BE(r),f_files:L.readUInt64BE(r),f_ffree:L.readUInt64BE(r),f_favail:L.readUInt64BE(r),f_sid:L.readUInt64BE(r),f_flag:L.readUInt64BE(r),f_namemax:L.readUInt64BE(r)};if(i.f_namemax===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}L.clear();if(typeof t.cb==="function")t.cb(undefined,i);return}case"limits@openssh.com":{const r={maxPktLen:L.readUInt64BE(),maxReadLen:L.readUInt64BE(),maxWriteLen:L.readUInt64BE(),maxOpenHandles:L.readUInt64BE()};if(r.maxOpenHandles===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}L.clear();if(typeof t.cb==="function")t.cb(undefined,r);return}case"users-groups-by-id@openssh.com":{const r=L.readUInt32BE();if(r===undefined)break;const i=new Array(r);for(let e=0;e<i.length;++e)i[e]=L.readString(true);const s=L.readUInt32BE();if(s===undefined)break;const o=new Array(s);for(let e=0;e<o.length;++e)o[e]=L.readString(true);if(o.length>0&&o[o.length-1]===undefined){break}if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}L.clear();if(typeof t.cb==="function")t.cb(undefined,i,o);return}default:e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);L.clear();if(typeof t.cb==="function")t.cb();return}}else{e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);L.clear();return}}L.clear();return doFatalSFTPError(e,"Malformed EXTENDED_REPLY packet")}};const q={[C.INIT]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate INIT packet");const n={};L.init(t,1);let r=L.readUInt32BE();while(L.avail()){const e=L.readString(true);const t=L.readString(true);if(t===undefined){r=undefined;break}n[e]=t}L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed INIT packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received INIT (v${r}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received INIT (v${r})`)}}sendOrBuffer(e,U);e._version=r;e._extensions=n;e.emit("ready")},[C.OPEN]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);const i=L.readUInt32BE();const s=readAttrs(e._biOpt);L.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed OPEN packet");e._debug&&e._debug(`SFTP: Inbound: Received OPEN (id:${n})`);if(!e.emit("OPEN",n,r,i,s)){e.status(n,b.OP_UNSUPPORTED)}},[C.CLOSE]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();L.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed CLOSE packet");e._debug&&e._debug(`SFTP: Inbound: Received CLOSE (id:${n})`);if(!e.emit("CLOSE",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.READ]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();const i=L.readUInt64BE(e._biOpt);const s=L.readUInt32BE();L.clear();if(s===undefined||r.length>256)return doFatalSFTPError(e,"Malformed READ packet");e._debug&&e._debug(`SFTP: Inbound: Received READ (id:${n})`);if(!e.emit("READ",n,r,i,s)){e.status(n,b.OP_UNSUPPORTED)}},[C.WRITE]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();const i=L.readUInt64BE(e._biOpt);const s=L.readString();L.clear();if(s===undefined||r.length>256)return doFatalSFTPError(e,"Malformed WRITE packet");e._debug&&e._debug(`SFTP: Inbound: Received WRITE (id:${n})`);if(!e.emit("WRITE",n,r,i,s)){e.status(n,b.OP_UNSUPPORTED)}},[C.LSTAT]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed LSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received LSTAT (id:${n})`);if(!e.emit("LSTAT",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.FSTAT]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();L.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed FSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSTAT (id:${n})`);if(!e.emit("FSTAT",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.SETSTAT]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);const i=readAttrs(e._biOpt);L.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed SETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received SETSTAT (id:${n})`);if(!e.emit("SETSTAT",n,r,i)){e.status(n,b.OP_UNSUPPORTED)}},[C.FSETSTAT]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();const i=readAttrs(e._biOpt);L.clear();if(i===undefined||r.length>256)return doFatalSFTPError(e,"Malformed FSETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSETSTAT (id:${n})`);if(!e.emit("FSETSTAT",n,r,i)){e.status(n,b.OP_UNSUPPORTED)}},[C.OPENDIR]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed OPENDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received OPENDIR (id:${n})`);if(!e.emit("OPENDIR",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.READDIR]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString();L.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed READDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received READDIR (id:${n})`);if(!e.emit("READDIR",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.REMOVE]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed REMOVE packet");e._debug&&e._debug(`SFTP: Inbound: Received REMOVE (id:${n})`);if(!e.emit("REMOVE",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.MKDIR]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);const i=readAttrs(e._biOpt);L.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed MKDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received MKDIR (id:${n})`);if(!e.emit("MKDIR",n,r,i)){e.status(n,b.OP_UNSUPPORTED)}},[C.RMDIR]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed RMDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received RMDIR (id:${n})`);if(!e.emit("RMDIR",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.REALPATH]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed REALPATH packet");e._debug&&e._debug(`SFTP: Inbound: Received REALPATH (id:${n})`);if(!e.emit("REALPATH",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.STAT]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed STAT packet");e._debug&&e._debug(`SFTP: Inbound: Received STAT (id:${n})`);if(!e.emit("STAT",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.RENAME]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);const i=L.readString(true);L.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed RENAME packet");e._debug&&e._debug(`SFTP: Inbound: Received RENAME (id:${n})`);if(!e.emit("RENAME",n,r,i)){e.status(n,b.OP_UNSUPPORTED)}},[C.READLINK]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);L.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed READLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received READLINK (id:${n})`);if(!e.emit("READLINK",n,r)){e.status(n,b.OP_UNSUPPORTED)}},[C.SYMLINK]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);const i=L.readString(true);L.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed SYMLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received SYMLINK (id:${n})`);let s;if(e._isOpenSSH){s=e.emit("SYMLINK",n,i,r)}else{s=e.emit("SYMLINK",n,r,i)}if(!s){e.status(n,b.OP_UNSUPPORTED)}},[C.EXTENDED]:(e,t)=>{L.init(t,1);const n=L.readUInt32BE();const r=L.readString(true);if(r===undefined){L.clear();return doFatalSFTPError(e,"Malformed EXTENDED packet")}let i;if(L.avail())i=L.readRaw();L.clear();e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED (id:${n})`);if(!e.emit("EXTENDED",n,r,i)){e.status(n,b.OP_UNSUPPORTED)}}};const{ERR_INVALID_ARG_TYPE:G,ERR_OUT_OF_RANGE:$,validateNumber:Y}=n(921);const V=128;let j;const z=[];function allocNewPool(e){if(z.length>0)j=z.pop();else j=Buffer.allocUnsafe(e);j.used=0}function checkPosition(e,t){if(!Number.isSafeInteger(e)){Y(e,t);if(!Number.isInteger(e))throw new $(t,"an integer",e);throw new $(t,">= 0 and <= 2 ** 53 - 1",e)}if(e<0)throw new $(t,">= 0 and <= 2 ** 53 - 1",e)}function roundUpToMultipleOf8(e){return e+7&~7}function ReadStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);if(n.highWaterMark===undefined)n.highWaterMark=64*1024;n.emitClose=false;n.autoDestroy=false;o.call(this,n);this.path=t;this.flags=n.flags===undefined?"r":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.end=n.end;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesRead=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(this.end===undefined){this.end=Infinity}else if(this.end!==Infinity){checkPosition(this.end,"end");if(this.start!==undefined&&this.start>this.end){throw new $("start",`<= "end" (here: ${this.end})`,this.start)}}this.on("end",(function(){if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}h(ReadStream,o);ReadStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;this.emit("open",t);this.emit("ready");this.read()}))};ReadStream.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",(()=>this._read(e)));if(this.destroyed)return;if(!j||j.length-j.used<V){allocNewPool(this.readableHighWaterMark||this._readableState.highWaterMark)}const t=j;let n=Math.min(j.length-j.used,e);const r=j.used;if(this.end!==undefined)n=Math.min(this.end-this.pos+1,n);if(n<=0)return this.push(null);this.sftp.read(this.handle,j,j.used,n,this.pos,((e,i)=>{if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}let s=null;if(r+n===t.used&&t===j){t.used=roundUpToMultipleOf8(t.used+i-n)}else{const e=r+n&~7;const s=roundUpToMultipleOf8(r+i);if(e-s>=V)z.push(t.slice(s,e))}if(i>0){this.bytesRead+=i;s=t.slice(r,r+i)}this.pos+=i;this.push(s)}));j.used=roundUpToMultipleOf8(j.used+n)};ReadStream.prototype._destroy=function(e,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",closeStream.bind(null,this,t,e));return}closeStream(this,t,e);this.handle=null;this._opening=false};function closeStream(e,t,n){if(!e.handle)return onclose();e.sftp.close(e.handle,onclose);function onclose(r){r=r||n;t(r);e.isClosed=true;if(!r)e.emit("close")}}ReadStream.prototype.close=function(e){this.destroy(null,e)};Object.defineProperty(ReadStream.prototype,"pending",{get(){return this.handle===null},configurable:true});function WriteStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);n.emitClose=false;n.autoDestroy=false;f.call(this,n);this.path=t;this.flags=n.flags===undefined?"w":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesWritten=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(n.encoding)this.setDefaultEncoding(n.encoding);this.on("finish",(function(){if(this._writableState.finalCalled)return;if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}h(WriteStream,f);WriteStream.prototype._final=function(e){if(this.autoClose)this.destroy();e()};WriteStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;const tryAgain=e=>{if(e){this.sftp.chmod(this.path,this.mode,(e=>tryAgain()));return}if(this.flags[0]==="a"){const tryStat=(e,n)=>{if(e){this.sftp.stat(this.path,((t,n)=>{if(t){this.destroy();this.emit("error",e);return}tryStat(null,n)}));return}this.pos=n.size;this.emit("open",t);this.emit("ready")};this.sftp.fstat(t,tryStat);return}this.emit("open",t);this.emit("ready")};this.sftp.fchmod(t,this.mode,tryAgain)}))};WriteStream.prototype._write=function(e,t,n){if(!Buffer.isBuffer(e)){const t=new G("data","Buffer",e);return this.emit("error",t)}if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._write(e,t,n)}))}this.sftp.write(this.handle,e,0,e.length,this.pos,((e,t)=>{if(e){if(this.autoClose)this.destroy();return n(e)}this.bytesWritten+=t;n()}));this.pos+=e.length};WriteStream.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._writev(e,t)}))}const n=this.sftp;const r=this.handle;let i=e.length;const onwrite=(e,n)=>{if(e){this.destroy();return t(e)}this.bytesWritten+=n;if(--i===0)t()};for(let t=0;t<e.length;++t){const i=e[t].chunk;n.write(r,i,0,i.length,this.pos,onwrite);this.pos+=i.length}};if(typeof f.prototype.destroy!=="function")WriteStream.prototype.destroy=ReadStream.prototype.destroy;WriteStream.prototype._destroy=ReadStream.prototype._destroy;WriteStream.prototype.close=function(e){if(e){if(this.isClosed){process.nextTick(e);return}this.on("close",e)}if(!this.autoClose)this.on("finish",this.destroy.bind(this));this.end()};WriteStream.prototype.destroySoon=WriteStream.prototype.end;Object.defineProperty(WriteStream.prototype,"pending",{get(){return this.handle===null},configurable:true});e.exports={flagsToString:x,OPEN_MODE:k,SFTP:SFTP,Stats:Stats,STATUS_CODE:b,stringToFlags:stringToFlags}},480:(e,t,n)=>{"use strict";const r=n(113);let i;try{i=n(143)()}catch{}const{bindingAvailable:s,CIPHER_INFO:o,MAC_INFO:f}=n(92);const h=(()=>{if(typeof r.sign==="function"&&typeof r.verify==="function"){const e="-----BEGIN PRIVATE KEY-----\r\nMC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD"+"/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r\n-----END PRIVATE KEY-----";const t=Buffer.from("a");let n;let i;try{n=r.sign(null,t,e);i=r.verify(null,t,e,n)}catch{}return Buffer.isBuffer(n)&&n.length===64&&i===true}return false})();const u=typeof r.diffieHellman==="function"&&typeof r.generateKeyPairSync==="function"&&typeof r.createPublicKey==="function";const l=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];if(u){l.unshift("curve25519-sha256");l.unshift("curve25519-sha256@libssh.org")}const g=l.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]);const p=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];if(h)p.unshift("ssh-ed25519");const _=p.concat(["ssh-dss"]);const E=(()=>{const e=r.getCiphers();return t=>e.includes(o[t].sslName)})();let y=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];if(i&&i.flags&&!i.flags.aes){if(s)y.unshift("chacha20-poly1305@openssh.com");else y.push("chacha20-poly1305@openssh.com")}else if(s&&i&&i.arch==="x86"){y.splice(4,0,"chacha20-poly1305@openssh.com")}else{y.push("chacha20-poly1305@openssh.com")}y=y.filter(E);const I=y.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(E));const b=(()=>{const e=r.getHashes();return t=>e.includes(f[t].sslName)})();const w=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(b);const m=w.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(b));const C=["none","zlib@openssh.com","zlib"];const B=C.concat([]);const k={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3,IMPLY_RSA_SHA2_SIGALGS:1<<4};e.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,EXT_INFO:7,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:undefined,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce(((e,t)=>({...e,[t]:1})),{}),COMPAT:k,COMPAT_CHECKS:[["Cisco-1.25",k.BAD_DHGEX],[/^Cisco-1[.]/,k.BUG_DHGEX_LARGE],[/^[0-9.]+$/,k.OLD_EXIT],[/^OpenSSH_5[.][0-9]+/,k.DYN_RPORT_BUG],[/^OpenSSH_7[.]4/,k.IMPLY_RSA_SHA2_SIGALGS]],DEFAULT_KEX:l,SUPPORTED_KEX:g,DEFAULT_SERVER_HOST_KEY:p,SUPPORTED_SERVER_HOST_KEY:_,DEFAULT_CIPHER:y,SUPPORTED_CIPHER:I,DEFAULT_MAC:w,SUPPORTED_MAC:m,DEFAULT_COMPRESSION:C,SUPPORTED_COMPRESSION:B,curve25519Supported:u,eddsaSupported:h};e.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(e.exports.DISCONNECT_REASON)).reduce(((e,[t,n])=>({...e,[n]:t})),{})},92:(e,t,n)=>{"use strict";const{createCipheriv:r,createDecipheriv:i,createHmac:s,randomFillSync:o,timingSafeEqual:f}=n(113);const{readUInt32BE:h,writeUInt32BE:u}=n(775);const l=Buffer[Symbol.species];const g=2**32-1;const p=Buffer.alloc(0);const _=Buffer.alloc(4);const E=new Map;const y=35e3;let I;let b;let w;let m;let C;let B;let k;try{I=n(605);({AESGCMCipher:b,ChaChaPolyCipher:w,GenericCipher:m,AESGCMDecipher:C,ChaChaPolyDecipher:B,GenericDecipher:k}=I)}catch{}const R=1<<0;const v=(()=>{function info(e,t,n,r,i,s,o){return{sslName:e,blockLen:t,keyLen:n,ivLen:r!==0||o&R?r:t,authLen:i,discardLen:s,stream:!!(o&R)}}return{"chacha20-poly1305@openssh.com":info("chacha20",8,64,0,16,0,R),"aes128-gcm":info("aes-128-gcm",16,16,12,16,0,R),"aes256-gcm":info("aes-256-gcm",16,32,12,16,0,R),"aes128-gcm@openssh.com":info("aes-128-gcm",16,16,12,16,0,R),"aes256-gcm@openssh.com":info("aes-256-gcm",16,32,12,16,0,R),"aes128-cbc":info("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":info("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":info("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":info("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":info("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":info("bf-cbc",8,16,0,0,0,0),"idea-cbc":info("idea-cbc",8,16,0,0,0,0),"cast128-cbc":info("cast-cbc",8,16,0,0,0,0),"aes128-ctr":info("aes-128-ctr",16,16,16,0,0,R),"aes192-ctr":info("aes-192-ctr",16,24,16,0,0,R),"aes256-ctr":info("aes-256-ctr",16,32,16,0,0,R),"3des-ctr":info("des-ede3",8,24,8,0,0,R),"blowfish-ctr":info("bf-ecb",8,16,8,0,0,R),"cast128-ctr":info("cast5-ecb",8,16,8,0,0,R),arcfour:info("rc4",8,16,0,0,1536,R),arcfour128:info("rc4",8,16,0,0,1536,R),arcfour256:info("rc4",8,32,0,0,1536,R),arcfour512:info("rc4",8,64,0,0,1536,R)}})();const T=(()=>{function info(e,t,n,r){return{sslName:e,len:t,actualLen:n,isETM:r}}return{"hmac-md5":info("md5",16,16,false),"hmac-md5-96":info("md5",16,12,false),"hmac-ripemd160":info("ripemd160",20,20,false),"hmac-sha1":info("sha1",20,20,false),"hmac-sha1-etm@openssh.com":info("sha1",20,20,true),"hmac-sha1-96":info("sha1",20,12,false),"hmac-sha2-256":info("sha256",32,32,false),"hmac-sha2-256-etm@openssh.com":info("sha256",32,32,true),"hmac-sha2-256-96":info("sha256",32,12,false),"hmac-sha2-512":info("sha512",64,64,false),"hmac-sha2-512-etm@openssh.com":info("sha512",64,64,true),"hmac-sha2-512-96":info("sha512",64,12,false)}})();class NullCipher{constructor(e,t){this.outSeqno=e;this._onWrite=t;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t);u(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}const U=Buffer.alloc(32);const P=Buffer.alloc(16);let O;let L;let D;class ChaChaPolyCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encKeyMain=t.cipherKey.slice(0,32);this._encKeyPktLen=t.cipherKey.slice(32);this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t);u(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;P[0]=0;u(P,this.outSeqno,12);const t=r("chacha20",this._encKeyMain,P).update(U);const n=r("chacha20",this._encKeyPktLen,P).update(e.slice(0,4));this._onWrite(n);P[0]=1;const i=r("chacha20",this._encKeyMain,P).update(e.slice(4));this._onWrite(i);D(L,n,n.length,i,i.length,t);const s=Buffer.allocUnsafe(16);s.set(new Uint8Array(O.HEAPU8.buffer,L,16),0);this._onWrite(s);this.outSeqno=this.outSeqno+1>>>0}}class ChaChaPolyCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new w(t.cipherKey);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t+16);u(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encSSLName=t.cipherInfo.sslName;this._encKey=t.cipherKey;this._encIV=t.cipherIV;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const r=Buffer.allocUnsafe(t);u(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;const t=r(this._encSSLName,this._encKey,this._encIV);t.setAutoPadding(false);const n=e.slice(0,4);t.setAAD(n);this._onWrite(n);const i=t.update(e.slice(4));this._onWrite(i);const s=t.final();if(s.length)this._onWrite(s);const o=t.getAuthTag();this._onWrite(o);ivIncrement(this._encIV);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new b(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const r=Buffer.allocUnsafe(t+16);u(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._instance.encrypt(e);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._cipherInstance=r(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._aadLen=this._macETM?4:0;this._dead=false;const n=t.cipherInfo.discardLen;if(n){let e=E.get(n);if(e===undefined){e=Buffer.alloc(n);E.set(n,e)}this._cipherInstance.update(e)}}free(){this._dead=true}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let r=t-(n-this._aadLen&t-1);if(r<4)r+=t;n+=r;const i=Buffer.allocUnsafe(n);u(i,n-4,0);i[4]=r;o(i,5+e,r);return i}encrypt(e){if(this._dead)return;let t;if(this._macETM){const n=new Uint8Array(e.buffer,e.byteOffset,4);const r=this._cipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+4,e.length-4));this._onWrite(n);this._onWrite(r);t=s(this._macSSLName,this._macKey);u(_,this.outSeqno,0);t.update(_);t.update(n);t.update(r)}else{const n=this._cipherInstance.update(e);this._onWrite(n);t=s(this._macSSLName,this._macKey);u(_,this.outSeqno,0);t.update(_);t.update(e)}let n=t.digest();if(n.length>this._macActualLen)n=n.slice(0,this._macActualLen);this._onWrite(n);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._macLen=t.macInfo.len;this._macActualLen=t.macInfo.actualLen;this._aadLen=t.macInfo.isETM?4:0;this._instance=new m(t.cipherInfo.sslName,t.cipherKey,t.cipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let r=t-(n-this._aadLen&t-1);if(r<4)r+=t;n+=r;const i=Buffer.allocUnsafe(n+this._macLen);u(i,n-4,0);i[4]=r;o(i,5+e,r);return i}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);if(this._macActualLen<this._macLen){e=new l(e.buffer,e.byteOffset,e.length-(this._macLen-this._macActualLen))}this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class NullDecipher{constructor(e,t){this.inSeqno=e;this._onPayload=t;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len>y||this._len<8||(4+this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._packetPos<this._len){const r=Math.min(this._len-this._packetPos,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._packetPos)}t+=r;this._packetPos+=r;if(this._packetPos<this._len)return}const r=!this._packet?p:new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decKeyMain=t.decipherKey.slice(0,32);this._decKeyPktLen=t.decipherKey.slice(32);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._calcMac=Buffer.allocUnsafe(16);this._macPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let r=Math.min(4-this._lenPos,n-t);while(r--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;P[0]=0;u(P,this.inSeqno,12);const s=i("chacha20",this._decKeyPktLen,P).update(this._lenBuf);this._len=h(s,0);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<16)return}P[0]=0;u(P,this.inSeqno,12);const s=r("chacha20",this._decKeyMain,P).update(U);D(L,this._lenBuf,4,this._packet,this._packet.length,s);this._calcMac.set(new Uint8Array(O.HEAPU8.buffer,L,16),0);if(!f(this._calcMac,this._mac))throw new Error("Invalid MAC");P[0]=1;const o=i("chacha20",this._decKeyMain,P).update(this._packet);const g=new l(o.buffer,o.byteOffset+1,o.length-o[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(g);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new B(t.decipherKey);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._macPos=0}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let r=Math.min(4-this._lenPos,n-t);while(r--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);const r=new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=null;this._decipherSSLName=t.decipherInfo.sslName;this._decipherKey=t.decipherKey;this._decipherIV=t.decipherIV;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error("Bad packet length")}this._decipherInstance=i(this._decipherSSLName,this._decipherKey,this._decipherIV);this._decipherInstance.setAutoPadding(false);this._decipherInstance.setAAD(Q(this._len))}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n){i=this._decipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+t,r))}else{i=this._decipherInstance.update(e)}if(i.length){if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._packetPos)}this._packetPos+=i.length}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._tagPos,n-t);if(t!==0||r!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=r;this._tagPos+=r;if(this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);const e=this._decipherInstance.final();if(e.length){if(this._packet)this._packet.set(e,this._packetPos);else this._packet=e}}const r=!this._packet?p:new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;ivIncrement(this._decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new C(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error(`Bad packet length: ${this._len}`)}}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._tagPos,n-t);if(t!==0||r!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=r;this._tagPos+=r;if(this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);const r=new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=i(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._decipherInstance.setAutoPadding(false);this._block=Buffer.allocUnsafe(t.macInfo.isETM?4:t.decipherInfo.blockLen);this._blockSize=t.decipherInfo.blockLen;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._macInstance=null;const n=t.decipherInfo.discardLen;if(n){let e=E.get(n);if(e===undefined){e=Buffer.alloc(n);E.set(n,e)}this._decipherInstance.update(e)}}free(){}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const r=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||r!==n||r<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=r;this._blockPos+=r;if(this._blockPos<this._block.length)return;let i;let o;if(this._macETM){this._len=o=h(this._block,0)}else{i=this._decipherInstance.update(this._block);this._len=h(i,0);o=4+this._len-this._blockSize}if(this._len>y||this._len<5||(o&this._blockSize-1)!==0){throw new Error("Bad packet length")}this._macInstance=s(this._macSSLName,this._macKey);u(_,this.inSeqno,0);this._macInstance.update(_);if(this._macETM){this._macInstance.update(this._block)}else{this._macInstance.update(new Uint8Array(i.buffer,i.byteOffset,4));this._pktLen=i.length-4;this._packetPos=this._pktLen;this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(i.buffer,i.byteOffset+4,this._packetPos),0)}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(this._macETM)this._macInstance.update(i);const s=this._decipherInstance.update(i);if(s.length){if(r===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._packetPos)}this._packetPos+=s.length}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<this._macActualLen)return}if(!this._macETM)this._macInstance.update(this._packet);let r=this._macInstance.digest();if(this._macActualLen<r.length){r=new Uint8Array(r.buffer,r.byteOffset,this._macActualLen)}if(!timingSafeEquals(r,this._mac))throw new Error("Invalid MAC");const i=new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new k(t.decipherInfo.sslName,t.decipherKey,t.decipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM,t.macInfo.actualLen);this._block=Buffer.allocUnsafe(t.macInfo.isETM||t.decipherInfo.stream?4:t.decipherInfo.blockLen);this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const r=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||r!==n||r<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=r;this._blockPos+=r;if(this._blockPos<this._block.length)return;let i;if(this._macETM){this._len=i=h(this._block,0)}else{this._instance.decryptBlock(this._block);this._len=h(this._block,0);i=4+this._len-this._block.length}if(this._len>y||this._len<5||(i&this._block.length-1)!==0){throw new Error("Bad packet length")}if(!this._macETM){this._pktLen=this._block.length-4;if(this._pktLen){this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0)}}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);const r=new l(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}function ivIncrement(e){++e[11]>>>8&&++e[10]>>>8&&++e[9]>>>8&&++e[8]>>>8&&++e[7]>>>8&&++e[6]>>>8&&++e[5]>>>8&&++e[4]>>>8}const Q=(()=>{const e=Buffer.alloc(4);return t=>{e[0]=t>>>24;e[1]=t>>>16;e[2]=t>>>8;e[3]=t;return e}})();function timingSafeEquals(e,t){if(e.length!==t.length){f(e,e);return false}return f(e,t)}function createCipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.outbound!=="object"||e.outbound===null)throw new Error("Invalid outbound");const t=e.outbound;if(typeof t.onWrite!=="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!=="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen){throw new Error("Invalid outbound.cipherKey")}if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen)){throw new Error("Invalid outbound.cipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>g){throw new Error("Invalid outbound.seqno")}const n=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return b&&!n?new AESGCMCipherBinding(e):new AESGCMCipherNative(e);case"chacha20":return w&&!n?new ChaChaPolyCipherBinding(e):new ChaChaPolyCipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid outbound.macKey")}return m&&!n?new GenericCipherBinding(e):new GenericCipherNative(e)}}}function createDecipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.inbound!=="object"||e.inbound===null)throw new Error("Invalid inbound");const t=e.inbound;if(typeof t.onPayload!=="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!=="object"||t.decipherInfo===null){throw new Error("Invalid inbound.decipherInfo")}if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen){throw new Error("Invalid inbound.decipherKey")}if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen)){throw new Error("Invalid inbound.decipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>g){throw new Error("Invalid inbound.seqno")}const n=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return C&&!n?new AESGCMDecipherBinding(e):new AESGCMDecipherNative(e);case"chacha20":return B&&!n?new ChaChaPolyDecipherBinding(e):new ChaChaPolyDecipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid inbound.macKey")}return k&&!n?new GenericDecipherBinding(e):new GenericDecipherNative(e)}}}e.exports={CIPHER_INFO:v,MAC_INFO:T,bindingAvailable:!!I,init:(()=>new Promise((async(e,t)=>{try{O=await n(655)();L=O._malloc(16);D=O.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}e()})))(),NullCipher:NullCipher,createCipher:createCipher,NullDecipher:NullDecipher,createDecipher:createDecipher}},655:(e,t,n)=>{var r=function(){var e=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:undefined;if(typeof __filename!=="undefined")e=e||__filename;return function(t){t=t||{};var r;r||(r=typeof t!=="undefined"?t:{});var i,s;r.ready=new Promise((function(e,t){i=e;s=t}));var o={},f;for(f in r)r.hasOwnProperty(f)&&(o[f]=r[f]);var h="object"===typeof window,u="function"===typeof importScripts,l="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,g="",p,_,E,y,I;if(l)g=u?n(17).dirname(g)+"/":__dirname+"/",p=function(e,t){var r=H(e);if(r)return t?r:r.toString();y||(y=n(147));I||(I=n(17));e=I.normalize(e);return y.readFileSync(e,t?null:"utf8")},E=function(e){e=p(e,!0);e.buffer||(e=new Uint8Array(e));assert(e.buffer);return e},_=function(e,t,r){var i=H(e);i&&t(i);y||(y=n(147));I||(I=n(17));e=I.normalize(e);y.readFile(e,(function(e,n){e?r(e):t(n.buffer)}))},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),r.inspect=function(){return"[Emscripten Module object]"};else if(h||u)u?g=self.location.href:"undefined"!==typeof document&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),0!==g.indexOf("blob:")?g=g.substr(0,g.lastIndexOf("/")+1):g="",p=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.send(null);return t.responseText}catch(i){if(e=H(e)){t=[];for(var n=0;n<e.length;n++){var r=e[n];255<r&&($&&assert(!1,"Character code "+r+" ("+String.fromCharCode(r)+")  at offset "+n+" not in 0x00-0xFF."),r&=255);t.push(String.fromCharCode(r))}return t.join("")}throw i}},u&&(E=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.responseType="arraybuffer";t.send(null);return new Uint8Array(t.response)}catch(t){if(e=H(e))return e;throw t}}),_=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0);r.responseType="arraybuffer";r.onload=function(){if(200==r.status||0==r.status&&r.response)t(r.response);else{var i=H(e);i?t(i.buffer):n()}};r.onerror=n;r.send(null)};r.print||console.log.bind(console);var b=r.printErr||console.warn.bind(console);for(f in o)o.hasOwnProperty(f)&&(r[f]=o[f]);o=null;var w;r.wasmBinary&&(w=r.wasmBinary);var m=r.noExitRuntime||!0;"object"!==typeof WebAssembly&&K("no native wasm support detected");var C,B=!1;function assert(e,t){e||K("Assertion failed: "+t)}function N(e){var t=r["_"+e];assert(t,"Cannot call unknown function "+e+", make sure it is exported");return t}function ca(e,t,n,r){var i={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=(e.length<<2)+1;t=J(n);var r=t,i=T;if(0<n){n=r+n-1;for(var s=0;s<e.length;++s){var o=e.charCodeAt(s);if(55296<=o&&57343>=o){var f=e.charCodeAt(++s);o=65536+((o&1023)<<10)|f&1023}if(127>=o){if(r>=n)break;i[r++]=o}else{if(2047>=o){if(r+1>=n)break;i[r++]=192|o>>6}else{if(65535>=o){if(r+2>=n)break;i[r++]=224|o>>12}else{if(r+3>=n)break;i[r++]=240|o>>18;i[r++]=128|o>>12&63}i[r++]=128|o>>6&63}i[r++]=128|o&63}}i[r]=0}}return t},array:function(e){var t=J(e.length);v.set(e,t);return t}},s=N(e),o=[];e=0;if(r)for(var f=0;f<r.length;f++){var h=i[n[f]];h?(0===e&&(e=j()),o[f]=h(r[f])):o[f]=r[f]}n=s.apply(null,o);n=function(e){if("string"===t)if(e){for(var n=T,r=e+NaN,i=e;n[i]&&!(i>=r);)++i;if(16<i-e&&n.subarray&&k)e=k.decode(n.subarray(e,i));else{for(r="";e<i;){var s=n[e++];if(s&128){var o=n[e++]&63;if(192==(s&224))r+=String.fromCharCode((s&31)<<6|o);else{var f=n[e++]&63;s=224==(s&240)?(s&15)<<12|o<<6|f:(s&7)<<18|o<<12|f<<6|n[e++]&63;65536>s?r+=String.fromCharCode(s):(s-=65536,r+=String.fromCharCode(55296|s>>10,56320|s&1023))}}else r+=String.fromCharCode(s)}e=r}}else e="";else e="boolean"===t?!!e:e;return e}(n);0!==e&&z(e);return n}var k="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0,R,v,T;function ia(){var e=C.buffer;R=e;r.HEAP8=v=new Int8Array(e);r.HEAP16=new Int16Array(e);r.HEAP32=new Int32Array(e);r.HEAPU8=T=new Uint8Array(e);r.HEAPU16=new Uint16Array(e);r.HEAPU32=new Uint32Array(e);r.HEAPF32=new Float32Array(e);r.HEAPF64=new Float64Array(e)}var U,P=[],O=[],L=[];function ma(){var e=r.preRun.shift();P.unshift(e)}var D=0,Q=null,x=null;r.preloadedImages={};r.preloadedAudios={};function K(e){if(r.onAbort)r.onAbort(e);b(e);B=!0;e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info.");s(e);throw e}var W="data:application/octet-stream;base64,",q;q="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==";if(!q.startsWith(W)){var G=q;q=r.locateFile?r.locateFile(G,g):g+G}function pa(){var e=q;try{if(e==q&&w)return new Uint8Array(w);var t=H(e);if(t)return t;if(E)return E(e);throw"both async and sync fetching of the wasm failed"}catch(e){K(e)}}function qa(){if(!w&&(h||u)){if("function"===typeof fetch&&!q.startsWith("file://"))return fetch(q,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()})).catch((function(){return pa()}));if(_)return new Promise((function(e,t){_(q,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return pa()}))}function X(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t(r);else{var n=t.m;"number"===typeof n?void 0===t.l?U.get(n)():U.get(n)(t.l):n(void 0===t.l?null:t.l)}}}var $=!1,Y="function"===typeof atob?atob:function(e){var t="",n=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));r=r<<2|i>>4;i=(i&15)<<4|s>>2;var f=(s&3)<<6|o;t+=String.fromCharCode(r);64!==s&&(t+=String.fromCharCode(i));64!==o&&(t+=String.fromCharCode(f))}while(n<e.length);return t};function H(e){if(e.startsWith(W)){e=e.slice(W.length);if("boolean"===typeof l&&l){var t=Buffer.from(e,"base64");t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}else try{var n=Y(e),r=new Uint8Array(n.length);for(e=0;e<n.length;++e)r[e]=n.charCodeAt(e);t=r}catch(e){throw Error("Converting base64 string to bytes failed.")}return t}}var V={a:function(e){var t=T.length;e>>>=0;if(2147483648<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);r=Math.max(e,r);0<r%65536&&(r+=65536-r%65536);e:{try{C.grow(Math.min(2147483648,r)-R.byteLength+65535>>>16);ia();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1}};(function(){function a(e){r.asm=e.exports;C=r.asm.b;ia();U=r.asm.j;O.unshift(r.asm.c);D--;r.monitorRunDependencies&&r.monitorRunDependencies(D);0==D&&(null!==Q&&(clearInterval(Q),Q=null),x&&(e=x,x=null,e()))}function c(e){a(e.instance)}function d(t){return qa().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){b("failed to asynchronously prepare wasm: "+e);K(e)}))}var e={a:V};D++;r.monitorRunDependencies&&r.monitorRunDependencies(D);if(r.instantiateWasm)try{return r.instantiateWasm(e,a)}catch(e){return b("Module.instantiateWasm callback failed with error: "+e),!1}(function(){return w||"function"!==typeof WebAssembly.instantiateStreaming||q.startsWith(W)||q.startsWith("file://")||"function"!==typeof fetch?d(c):fetch(q,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(c,(function(e){b("wasm streaming compile failed: "+e);b("falling back to ArrayBuffer instantiation");return d(c)}))}))})().catch(s);return{}})();r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.c).apply(null,arguments)};r._poly1305_auth=function(){return(r._poly1305_auth=r.asm.d).apply(null,arguments)};var j=r.stackSave=function(){return(j=r.stackSave=r.asm.e).apply(null,arguments)},z=r.stackRestore=function(){return(z=r.stackRestore=r.asm.f).apply(null,arguments)},J=r.stackAlloc=function(){return(J=r.stackAlloc=r.asm.g).apply(null,arguments)};r._malloc=function(){return(r._malloc=r.asm.h).apply(null,arguments)};r._free=function(){return(r._free=r.asm.i).apply(null,arguments)};r.cwrap=function(e,t,n,r){n=n||[];var i=n.every((function(e){return"number"===e}));return"string"!==t&&i&&!r?N(e):function(){return ca(e,t,n,arguments)}};var ee;x=function ta(){ee||Z();ee||(x=ta)};function Z(){function a(){if(!ee&&(ee=!0,r.calledRun=!0,!B)){X(O);i(r);if(r.onRuntimeInitialized)r.onRuntimeInitialized();if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;){var e=r.postRun.shift();L.unshift(e)}X(L)}}if(!(0<D)){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)ma();X(P);0<D||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1);a()}),1)):a())}}r.run=Z;if(r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);0<r.preInit.length;)r.preInit.pop()();Z();return t.ready}}();if(true)e.exports=r;else{}},374:(e,t,n)=>{"use strict";const r=new Array(256);[n(494).HANDLERS,n(860)].forEach((e=>{for(let[t,n]of Object.entries(e)){t=+t;if(isFinite(t)&&t>=0&&t<r.length)r[t]=n}}));e.exports=r},860:(e,t,n)=>{"use strict";const{bufferSlice:r,bufferParser:i,doFatalError:s,sigSSHToASN1:o,writeUInt32BE:f}=n(775);const{CHANNEL_OPEN_FAILURE:h,COMPAT:u,MESSAGE:l,TERMINAL_MODE:g}=n(480);const{parseKey:p}=n(613);const _=Array.from(Object.entries(g)).reduce(((e,[t,n])=>({...e,[t]:n})),{});e.exports={[l.DISCONNECT]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString(true);const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed DISCONNECT packet")}e._debug&&e._debug(`Inbound: Received DISCONNECT (${n}, "${r}")`);const f=e._handlers.DISCONNECT;f&&f(e,n,r)},[l.IGNORE]:(e,t)=>{e._debug&&e._debug("Inbound: Received IGNORE")},[l.UNIMPLEMENTED]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed UNIMPLEMENTED packet")}e._debug&&e._debug(`Inbound: Received UNIMPLEMENTED (seqno ${n})`)},[l.DEBUG]:(e,t)=>{i.init(t,1);const n=i.readBool();const r=i.readString(true);const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed DEBUG packet")}e._debug&&e._debug("Inbound: Received DEBUG");const f=e._handlers.DEBUG;f&&f(e,n,r)},[l.SERVICE_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);i.clear();if(n===undefined){return s(e,"Inbound: Malformed SERVICE_REQUEST packet")}e._debug&&e._debug(`Inbound: Received SERVICE_REQUEST (${n})`);const r=e._handlers.SERVICE_REQUEST;r&&r(e,n)},[l.SERVICE_ACCEPT]:(e,t)=>{i.init(t,1);const n=i.readString(true);i.clear();if(n===undefined){return s(e,"Inbound: Malformed SERVICE_ACCEPT packet")}e._debug&&e._debug(`Inbound: Received SERVICE_ACCEPT (${n})`);const r=e._handlers.SERVICE_ACCEPT;r&&r(e,n)},[l.EXT_INFO]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();let r;if(n!==undefined){r=[];for(let e=0;e<n;++e){const e=i.readString(true);const t=i.readString();if(t!==undefined){switch(e){case"server-sig-algs":{const n=t.latin1Slice(0,t.length).split(",");r.push({name:e,algs:n});continue}default:continue}}r=undefined;break}}i.clear();if(r===undefined)return s(e,"Inbound: Malformed EXT_INFO packet");e._debug&&e._debug("Inbound: Received EXT_INFO");const o=e._handlers.EXT_INFO;o&&o(e,r)},[l.USERAUTH_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);const h=i.readString(true);const u=i.readString(true);let l;let g;switch(u){case"none":l=null;break;case"password":{const e=i.readBool();if(e!==undefined){l=i.readString(true);if(l!==undefined&&e){const e=i.readString(true);if(e!==undefined)l={oldPassword:l,newPassword:e};else l=undefined}}break}case"publickey":{const n=i.readBool();if(n!==undefined){const s=i.readString(true);let h=s;const u=i.readString();let p;switch(s){case"rsa-sha2-256":h="ssh-rsa";p="sha256";break;case"rsa-sha2-512":h="ssh-rsa";p="sha512";break}if(n){const n=i.pos();let g=i.readString();if(g!==undefined){if(g.length>4+s.length+4&&g.utf8Slice(4,4+s.length)===s){g=r(g,4+s.length+4)}g=o(g,h);if(g){const r=e._kex.sessionID;const i=Buffer.allocUnsafe(4+r.length+n);f(i,r.length,0);i.set(r,4);i.set(new Uint8Array(t.buffer,t.byteOffset,n),4+r.length);l={keyAlgo:h,key:u,signature:g,blob:i,hashAlgo:p}}}}else{l={keyAlgo:h,key:u,hashAlgo:p};g="publickey -- check"}}break}case"hostbased":{const n=i.readString(true);let s=n;const h=i.readString();const u=i.readString(true);const g=i.readString(true);let p;switch(n){case"rsa-sha2-256":s="ssh-rsa";p="sha256";break;case"rsa-sha2-512":s="ssh-rsa";p="sha512";break}const _=i.pos();let E=i.readString();if(E!==undefined){if(E.length>4+n.length+4&&E.utf8Slice(4,4+n.length)===n){E=r(E,4+n.length+4)}E=o(E,s);if(E!==undefined){const n=e._kex.sessionID;const r=Buffer.allocUnsafe(4+n.length+_);f(r,n.length,0);r.set(n,4);r.set(new Uint8Array(t.buffer,t.byteOffset,_),4+n.length);l={keyAlgo:s,key:h,signature:E,blob:r,localHostname:u,localUsername:g,hashAlgo:p}}}break}case"keyboard-interactive":i.skipString();l=i.readList();break;default:if(u!==undefined)l=i.readRaw()}i.clear();if(l===undefined){return s(e,"Inbound: Malformed USERAUTH_REQUEST packet")}if(g===undefined)g=u;e._authsQueue.push(u);e._debug&&e._debug(`Inbound: Received USERAUTH_REQUEST (${g})`);const p=e._handlers.USERAUTH_REQUEST;p&&p(e,n,h,u,l)},[l.USERAUTH_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readList();const r=i.readBool();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_FAILURE packet")}e._debug&&e._debug(`Inbound: Received USERAUTH_FAILURE (${n})`);e._authsQueue.shift();const o=e._handlers.USERAUTH_FAILURE;o&&o(e,n,r)},[l.USERAUTH_SUCCESS]:(e,t)=>{e._debug&&e._debug("Inbound: Received USERAUTH_SUCCESS");e._authsQueue.shift();const n=e._handlers.USERAUTH_SUCCESS;n&&n(e)},[l.USERAUTH_BANNER]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_BANNER packet")}e._debug&&e._debug("Inbound: Received USERAUTH_BANNER");const o=e._handlers.USERAUTH_BANNER;o&&o(e,n)},60:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 60 without auth");return}switch(e._authsQueue[0]){case"password":{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");const o=e._handlers.USERAUTH_PASSWD_CHANGEREQ;o&&o(e,n);break}case"publickey":{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_PK_OK packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PK_OK");e._authsQueue.shift();const o=e._handlers.USERAUTH_PK_OK;o&&o(e,n,r);break}case"keyboard-interactive":{i.init(t,1);const n=i.readString(true);const r=i.readString(true);i.readString();const o=i.readUInt32BE();let f;if(o!==undefined){f=new Array(o);let e;for(e=0;e<o;++e){const t=i.readString(true);const n=i.readBool();if(n===undefined)break;f[e]={prompt:t,echo:n}}if(e!==o)f=undefined}i.clear();if(f===undefined){return s(e,"Inbound: Malformed USERAUTH_INFO_REQUEST packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_REQUEST");const h=e._handlers.USERAUTH_INFO_REQUEST;h&&h(e,n,r,f);break}default:e._debug&&e._debug("Inbound: Received unexpected payload type 60")}},61:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 61 without auth");return}if(e._authsQueue[0]!=="keyboard-interactive"){return s(e,"Inbound: Received unexpected payload type 61")}i.init(t,1);const n=i.readUInt32BE();let r;if(n!==undefined){r=new Array(n);let e;for(e=0;e<n;++e){const t=i.readString(true);if(t===undefined)break;r[e]=t}if(e!==n)r=undefined}i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_RESPONSE");const o=e._handlers.USERAUTH_INFO_RESPONSE;o&&o(e,r)},[l.GLOBAL_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readBool();let o;if(r!==undefined){switch(n){case"tcpip-forward":case"cancel-tcpip-forward":{const e=i.readString(true);const t=i.readUInt32BE();if(t!==undefined)o={bindAddr:e,bindPort:t};break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{const e=i.readString(true);if(e!==undefined)o={socketPath:e};break}case"no-more-sessions@openssh.com":o=null;break;case"hostkeys-00@openssh.com":{o=[];while(i.avail()>0){const e=i.readString();if(e===undefined){o=undefined;break}const t=p(e);if(!(t instanceof Error))o.push(t)}break}default:o=i.readRaw()}}i.clear();if(o===undefined){return s(e,"Inbound: Malformed GLOBAL_REQUEST packet")}e._debug&&e._debug(`Inbound: GLOBAL_REQUEST (${n})`);const f=e._handlers.GLOBAL_REQUEST;if(f)f(e,n,r,o);else e.requestFailure()},[l.REQUEST_SUCCESS]:(e,t)=>{const n=t.length>1?r(t,1):null;e._debug&&e._debug("Inbound: REQUEST_SUCCESS");const i=e._handlers.REQUEST_SUCCESS;i&&i(e,n)},[l.REQUEST_FAILURE]:(e,t)=>{e._debug&&e._debug("Inbound: Received REQUEST_FAILURE");const n=e._handlers.REQUEST_FAILURE;n&&n(e)},[l.CHANNEL_OPEN]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readUInt32BE();const o=i.readUInt32BE();const f=i.readUInt32BE();let u;switch(n){case"forwarded-tcpip":case"direct-tcpip":{const e=i.readString(true);const t=i.readUInt32BE();const s=i.readString(true);const h=i.readUInt32BE();if(h!==undefined){u={type:n,sender:r,window:o,packetSize:f,data:{destIP:e,destPort:t,srcIP:s,srcPort:h}}}break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{const e=i.readString(true);if(e!==undefined){u={type:n,sender:r,window:o,packetSize:f,data:{socketPath:e}}}break}case"x11":{const e=i.readString(true);const t=i.readUInt32BE();if(t!==undefined){u={type:n,sender:r,window:o,packetSize:f,data:{srcIP:e,srcPort:t}}}break}default:u={type:n,sender:r,window:o,packetSize:f,data:{}}}i.clear();if(u===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN (s:${r}, ${n})`);const l=e._handlers.CHANNEL_OPEN;if(l){l(e,u)}else{e.channelOpenFail(u.sender,h.ADMINISTRATIVELY_PROHIBITED,"","")}},[l.CHANNEL_OPEN_CONFIRMATION]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readUInt32BE();const f=i.readUInt32BE();const h=i.avail()?i.readRaw():undefined;i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${n}, s:${r})`);const u=e._handlers.CHANNEL_OPEN_CONFIRMATION;if(u)u(e,{recipient:n,sender:r,window:o,packetSize:f,data:h})},[l.CHANNEL_OPEN_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readString(true);const f=i.readString();i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${n})`);const h=e._handlers.CHANNEL_OPEN_FAILURE;h&&h(e,n,r,o)},[l.CHANNEL_WINDOW_ADJUST]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();i.clear();if(r===undefined){return s(e,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet")}e._debug&&e._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${n}, ${r})`);const o=e._handlers.CHANNEL_WINDOW_ADJUST;o&&o(e,n,r)},[l.CHANNEL_DATA]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed CHANNEL_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_DATA (r:${n}, ${r.length})`);const o=e._handlers.CHANNEL_DATA;o&&o(e,n,r)},[l.CHANNEL_EXTENDED_DATA]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${n}, ${o.length})`);const f=e._handlers.CHANNEL_EXTENDED_DATA;f&&f(e,n,o,r)},[l.CHANNEL_EOF]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_EOF packet")}e._debug&&e._debug(`Inbound: CHANNEL_EOF (r:${n})`);const r=e._handlers.CHANNEL_EOF;r&&r(e,n)},[l.CHANNEL_CLOSE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_CLOSE packet")}e._debug&&e._debug(`Inbound: CHANNEL_CLOSE (r:${n})`);const r=e._handlers.CHANNEL_CLOSE;r&&r(e,n)},[l.CHANNEL_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString(true);const o=i.readBool();let f;if(o!==undefined){switch(r){case"exit-status":f=i.readUInt32BE();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"exit-signal":{let t;let s;if(e._compatFlags&u.OLD_EXIT){const e=i.readUInt32BE();switch(e){case 1:t="HUP";break;case 2:t="INT";break;case 3:t="QUIT";break;case 6:t="ABRT";break;case 9:t="KILL";break;case 14:t="ALRM";break;case 15:t="TERM";break;default:if(e!==undefined){t=`UNKNOWN (${e})`}}s=false}else{t=i.readString(true);s=i.readBool();if(s===undefined)t=undefined}const o=i.readString(true);if(i.skipString()!==undefined)f={signal:t,coreDumped:s,errorMessage:o};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${t})`);break}case"pty-req":{const t=i.readString(true);const s=i.readUInt32BE();const o=i.readUInt32BE();const h=i.readUInt32BE();const u=i.readUInt32BE();const l=i.readString();if(l!==undefined){i.init(l,1);let e={};while(i.avail()){const t=i.readByte();if(t===g.TTY_OP_END)break;const n=_[t];const r=i.readUInt32BE();if(t===undefined||n===undefined||r===undefined){e=undefined;break}e[n]=r}if(e!==undefined)f={term:t,cols:s,rows:o,width:h,height:u,modes:e}}e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"window-change":{const t=i.readUInt32BE();const s=i.readUInt32BE();const o=i.readUInt32BE();const h=i.readUInt32BE();if(h!==undefined)f={cols:t,rows:s,width:o,height:h};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"x11-req":{const t=i.readBool();const s=i.readString(true);const o=i.readString();const h=i.readUInt32BE();if(h!==undefined)f={single:t,protocol:s,cookie:o,screen:h};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"env":{const t=i.readString(true);const s=i.readString(true);if(s!==undefined)f={name:t,value:s};if(e._debug){e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: `+`${t}=${s})`)}break}case"shell":f=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break;case"exec":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"subsystem":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"signal":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"xon-xoff":f=i.readBool();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"auth-agent-req@openssh.com":f=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break;default:f=i.avail()?i.readRaw():null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`)}}i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_REQUEST packet")}const h=e._handlers.CHANNEL_REQUEST;h&&h(e,n,r,o,f)},[l.CHANNEL_SUCCESS]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_SUCCESS packet")}e._debug&&e._debug(`Inbound: CHANNEL_SUCCESS (r:${n})`);const r=e._handlers.CHANNEL_SUCCESS;r&&r(e,n)},[l.CHANNEL_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_FAILURE (r:${n})`);const r=e._handlers.CHANNEL_FAILURE;r&&r(e,n)}}},494:(e,t,n)=>{"use strict";const{createDiffieHellman:r,createDiffieHellmanGroup:i,createECDH:s,createHash:o,createPublicKey:f,diffieHellman:h,generateKeyPairSync:u,randomFillSync:l}=n(113);const{Ber:g}=n(680);const{COMPAT:p,curve25519Supported:_,DEFAULT_KEX:E,DEFAULT_SERVER_HOST_KEY:y,DEFAULT_CIPHER:I,DEFAULT_MAC:b,DEFAULT_COMPRESSION:w,DISCONNECT_REASON:m,MESSAGE:C}=n(480);const{CIPHER_INFO:B,createCipher:k,createDecipher:R,MAC_INFO:v}=n(92);const{parseDERKey:T}=n(613);const{bufferFill:U,bufferParser:P,convertSignature:O,doFatalError:L,FastBuffer:D,sigSSHToASN1:Q,writeUInt32BE:x}=n(775);const{PacketReader:W,PacketWriter:q,ZlibPacketReader:G,ZlibPacketWriter:$}=n(736);let Y;const V=2048;const j=8192;const z=Buffer.alloc(0);function kexinit(e){let t;if(e._compatFlags&p.BAD_DHGEX){const n=e._offer.lists.kex;let r=n.array;let i=false;for(let e=0;e<r.length;++e){if(r[e].includes("group-exchange")){if(!i){i=true;r=r.slice()}r.splice(e--,1)}}if(i){let i=1+16+e._offer.totalSize+1+4;const s=Buffer.from(r.join(","));i-=n.buffer.length-s.length;const o=e._offer.lists.all;const f=new Uint8Array(o.buffer,o.byteOffset+4+n.buffer.length,o.length-(4+n.buffer.length));t=Buffer.allocUnsafe(i);x(t,s.length,17);t.set(s,17+4);t.set(f,17+4+s.length)}}if(t===undefined){t=Buffer.allocUnsafe(1+16+e._offer.totalSize+1+4);e._offer.copyAllTo(t,17)}e._debug&&e._debug("Outbound: Sending KEXINIT");t[0]=C.KEXINIT;l(t,1,16);U(t,0,t.length-5);e._kexinit=t;e._packetRW.write.allocStart=0;{const n=e._packetRW.write.allocStartKEX;const r=e._packetRW.write.alloc(t.length,true);r.set(t,n);e._cipher.encrypt(e._packetRW.write.finalize(r,true))}}function handleKexInit(e,t){const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined}};P.init(t,17);if((n.kex=P.readList())===undefined||(n.serverHostKey=P.readList())===undefined||(n.cs.cipher=P.readList())===undefined||(n.sc.cipher=P.readList())===undefined||(n.cs.mac=P.readList())===undefined||(n.sc.mac=P.readList())===undefined||(n.cs.compress=P.readList())===undefined||(n.sc.compress=P.readList())===undefined||(n.cs.lang=P.readList())===undefined||(n.sc.lang=P.readList())===undefined){P.clear();return L(e,"Received malformed KEXINIT","handshake",m.KEY_EXCHANGE_FAILED)}const r=P.pos();const i=r<t.length&&t[r]===1;P.clear();const s=e._offer;const o=n;let f=s.lists.kex.array;if(e._compatFlags&p.BAD_DHGEX){let e=false;for(let t=0;t<f.length;++t){if(f[t].indexOf("group-exchange")!==-1){if(!e){e=true;f=f.slice()}f.splice(t--,1)}}}let h;let u;let l;const g=e._debug;g&&g("Inbound: Handshake in progress");g&&g(`Handshake: (local) KEX method: ${f}`);g&&g(`Handshake: (remote) KEX method: ${o.kex}`);let _;if(e._server){u=f;h=o.kex;_=h.indexOf("ext-info-c")!==-1}else{u=o.kex;h=f;_=u.indexOf("ext-info-s")!==-1}if(e._strictMode===undefined){if(e._server){e._strictMode=h.indexOf("kex-strict-c-v00@openssh.com")!==-1}else{e._strictMode=u.indexOf("kex-strict-s-v00@openssh.com")!==-1}if(e._strictMode){g&&g("Handshake: strict KEX mode enabled");if(e._decipher.inSeqno!==1){if(g)g("Handshake: KEXINIT not first packet in strict KEX mode");return L(e,"Handshake failed: KEXINIT not first packet in strict KEX mode","handshake",m.KEY_EXCHANGE_FAILED)}}}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: no matching key exchange algorithm");return L(e,"Handshake failed: no matching key exchange algorithm","handshake",m.KEY_EXCHANGE_FAILED)}n.kex=h[l];g&&g(`Handshake: KEX algorithm: ${h[l]}`);if(i&&(!o.kex.length||h[l]!==o.kex[0])){e._skipNextInboundPacket=true}const E=s.lists.serverHostKey.array;g&&g(`Handshake: (local) Host key format: ${E}`);g&&g(`Handshake: (remote) Host key format: ${o.serverHostKey}`);if(e._server){u=E;h=o.serverHostKey}else{u=o.serverHostKey;h=E}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching host key format");return L(e,"Handshake failed: no matching host key format","handshake",m.KEY_EXCHANGE_FAILED)}n.serverHostKey=h[l];g&&g(`Handshake: Host key format: ${h[l]}`);const y=s.lists.cs.cipher.array;g&&g(`Handshake: (local) C->S cipher: ${y}`);g&&g(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`);if(e._server){u=y;h=o.cs.cipher}else{u=o.cs.cipher;h=y}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching C->S cipher");return L(e,"Handshake failed: no matching C->S cipher","handshake",m.KEY_EXCHANGE_FAILED)}n.cs.cipher=h[l];g&&g(`Handshake: C->S Cipher: ${h[l]}`);const I=s.lists.sc.cipher.array;g&&g(`Handshake: (local) S->C cipher: ${I}`);g&&g(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`);if(e._server){u=I;h=o.sc.cipher}else{u=o.sc.cipher;h=I}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching S->C cipher");return L(e,"Handshake failed: no matching S->C cipher","handshake",m.KEY_EXCHANGE_FAILED)}n.sc.cipher=h[l];g&&g(`Handshake: S->C cipher: ${h[l]}`);const b=s.lists.cs.mac.array;g&&g(`Handshake: (local) C->S MAC: ${b}`);g&&g(`Handshake: (remote) C->S MAC: ${o.cs.mac}`);if(B[n.cs.cipher].authLen>0){n.cs.mac="";g&&g("Handshake: C->S MAC: <implicit>")}else{if(e._server){u=b;h=o.cs.mac}else{u=o.cs.mac;h=b}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching C->S MAC");return L(e,"Handshake failed: no matching C->S MAC","handshake",m.KEY_EXCHANGE_FAILED)}n.cs.mac=h[l];g&&g(`Handshake: C->S MAC: ${h[l]}`)}const w=s.lists.sc.mac.array;g&&g(`Handshake: (local) S->C MAC: ${w}`);g&&g(`Handshake: (remote) S->C MAC: ${o.sc.mac}`);if(B[n.sc.cipher].authLen>0){n.sc.mac="";g&&g("Handshake: S->C MAC: <implicit>")}else{if(e._server){u=w;h=o.sc.mac}else{u=o.sc.mac;h=w}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching S->C MAC");return L(e,"Handshake failed: no matching S->C MAC","handshake",m.KEY_EXCHANGE_FAILED)}n.sc.mac=h[l];g&&g(`Handshake: S->C MAC: ${h[l]}`)}const C=s.lists.cs.compress.array;g&&g(`Handshake: (local) C->S compression: ${C}`);g&&g(`Handshake: (remote) C->S compression: ${o.cs.compress}`);if(e._server){u=C;h=o.cs.compress}else{u=o.cs.compress;h=C}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching C->S compression");return L(e,"Handshake failed: no matching C->S compression","handshake",m.KEY_EXCHANGE_FAILED)}n.cs.compress=h[l];g&&g(`Handshake: C->S compression: ${h[l]}`);const k=s.lists.sc.compress.array;g&&g(`Handshake: (local) S->C compression: ${k}`);g&&g(`Handshake: (remote) S->C compression: ${o.sc.compress}`);if(e._server){u=k;h=o.sc.compress}else{u=o.sc.compress;h=k}for(l=0;l<h.length&&u.indexOf(h[l])===-1;++l);if(l===h.length){g&&g("Handshake: No matching S->C compression");return L(e,"Handshake failed: no matching S->C compression","handshake",m.KEY_EXCHANGE_FAILED)}n.sc.compress=h[l];g&&g(`Handshake: S->C compression: ${h[l]}`);n.cs.lang="";n.sc.lang="";if(e._kex){if(!e._kexinit){kexinit(e)}e._decipher._onPayload=onKEXPayload.bind(e,{firstPacket:false})}e._kex=J(n,e,t);e._kex.remoteExtInfoEnabled=_;e._kex.start()}const J=(()=>{function convertToMpint(e){let t=0;let n=e.length;while(e[t]===0){++t;--n}let r;if(e[t]&128){r=Buffer.allocUnsafe(1+n);r[0]=0;e.copy(r,1,t);e=r}else if(n!==e.length){r=Buffer.allocUnsafe(n);e.copy(r,0,t);e=r}return e}class KeyExchange{constructor(e,t,n){this._protocol=t;this.sessionID=t._kex?t._kex.sessionID:undefined;this.negotiated=e;this.remoteExtInfoEnabled=false;this._step=1;this._public=null;this._dh=null;this._sentNEWKEYS=false;this._receivedNEWKEYS=false;this._finished=false;this._hostVerified=false;this._kexinit=t._kexinit;this._remoteKexinit=n;this._identRaw=t._identRaw;this._remoteIdentRaw=t._remoteIdentRaw;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined}finish(e){if(this._finished)return false;this._finished=true;const t=this._protocol._server;const n=this.negotiated;const r=this.convertPublicKey(this._dhData);let i=this.computeSecret(this._dhData);if(i instanceof Error){i.message=`Error while computing DH secret (${this.type}): ${i.message}`;i.level="handshake";return L(this._protocol,i,m.KEY_EXCHANGE_FAILED)}const s=o(this.hashName);te(s,t?this._remoteIdentRaw:this._identRaw);te(s,t?this._identRaw:this._remoteIdentRaw);te(s,t?this._remoteKexinit:this._kexinit);te(s,t?this._kexinit:this._remoteKexinit);const f=t?this._hostKey.getPublicSSH():this._hostKey;te(s,f);if(this.type==="groupex"){const e=this.getDHParams();const t=Buffer.allocUnsafe(4);x(t,this._minBits,0);s.update(t);x(t,this._prefBits,0);s.update(t);x(t,this._maxBits,0);s.update(t);te(s,e.prime);te(s,e.generator)}te(s,t?r:this.getPublicKey());const h=t?this.getPublicKey():r;te(s,h);te(s,i);const u=s.digest();if(!t){P.init(this._sig,0);const e=P.readString(true);if(!e){return L(this._protocol,"Malformed packet while reading signature","handshake",m.KEY_EXCHANGE_FAILED)}if(e!==n.serverHostKey){return L(this._protocol,`Wrong signature type: ${e}, `+`expected: ${n.serverHostKey}`,"handshake",m.KEY_EXCHANGE_FAILED)}let t=P.readString();P.clear();if(t===undefined){return L(this._protocol,"Malformed packet while reading signature","handshake",m.KEY_EXCHANGE_FAILED)}if(!(t=Q(t,e))){return L(this._protocol,"Malformed signature","handshake",m.KEY_EXCHANGE_FAILED)}let r;{P.init(this._hostKey,0);const e=P.readString(true);const t=this._hostKey.slice(P.pos());P.clear();r=T(t,e);if(r instanceof Error){r.level="handshake";return L(this._protocol,r,m.KEY_EXCHANGE_FAILED)}}let i;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":i="sha256";break;case"rsa-sha2-512":i="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");const s=r.verify(u,t,i);if(s!==true){if(s instanceof Error){this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${s.stack}`)}else{this._protocol._debug&&this._protocol._debug("Signature verification failed")}return L(this._protocol,"Handshake failed: signature verification failed","handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Verified signature")}else{let e;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":e="sha256";break;case"rsa-sha2-512":e="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let t=this._hostKey.sign(u,e);if(t instanceof Error){return L(this._protocol,"Handshake failed: signature generation failed for "+`${this._hostKey.type} host key: ${t.message}`,"handshake",m.KEY_EXCHANGE_FAILED)}t=O(t,this._hostKey.type);if(t===false){return L(this._protocol,"Handshake failed: signature conversion failed for "+`${this._hostKey.type} host key`,"handshake",m.KEY_EXCHANGE_FAILED)}const n=this.negotiated.serverHostKey;const r=Buffer.byteLength(n);const i=4+r+4+t.length;let s=this._protocol._packetRW.write.allocStartKEX;const o=this._protocol._packetRW.write.alloc(1+4+f.length+4+h.length+4+i,true);o[s]=C.KEXDH_REPLY;x(o,f.length,++s);o.set(f,s+=4);x(o,h.length,s+=f.length);o.set(h,s+=4);x(o,i,s+=h.length);x(o,r,s+=4);o.utf8Write(n,s+=4,r);x(o,t.length,s+=r);o.set(t,s+=4);if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_REPLY";break;case"groupex":e="KEXDH_GEX_REPLY";break;default:e="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${e}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(o,true))}if(t||!e)trySendNEWKEYS(this);let l;let g;const completeHandshake=e=>{if(l){trySendNEWKEYS(this);l.outbound.seqno=this._protocol._cipher.outSeqno;this._protocol._cipher.free();this._protocol._cipher=k(l);this._protocol._packetRW.write=g;l=undefined;g=undefined;this._protocol._onHandshakeComplete(n);return false}if(!this.sessionID)this.sessionID=u;{const e=Buffer.allocUnsafe(4+i.length);x(e,i.length,0);e.set(i,4);i=e}const r=B[n.cs.cipher];const s=B[n.sc.cipher];const o=generateKEXVal(r.ivLen,this.hashName,i,u,this.sessionID,"A");const f=generateKEXVal(s.ivLen,this.hashName,i,u,this.sessionID,"B");const h=generateKEXVal(r.keyLen,this.hashName,i,u,this.sessionID,"C");const p=generateKEXVal(s.keyLen,this.hashName,i,u,this.sessionID,"D");let _;let E;if(!r.authLen){_=v[n.cs.mac];E=generateKEXVal(_.len,this.hashName,i,u,this.sessionID,"E")}let y;let I;if(!s.authLen){y=v[n.sc.mac];I=generateKEXVal(y.len,this.hashName,i,u,this.sessionID,"F")}const b={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:!t?s:r,decipherIV:!t?f:o,decipherKey:!t?p:h,macInfo:!t?y:_,macKey:!t?I:E},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:t?s:r,cipherIV:t?f:o,cipherKey:t?p:h,macInfo:t?y:_,macKey:t?I:E}};this._protocol._decipher.free();l=b;this._protocol._decipher=R(b);const w={read:undefined,write:undefined};switch(n.cs.compress){case"zlib":if(t)w.read=new G;else w.write=new $(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){if(t)w.read=new G;else w.write=new $(this._protocol);break}default:if(t)w.read=new W;else w.write=new q(this._protocol)}switch(n.sc.compress){case"zlib":if(t)w.write=new $(this._protocol);else w.read=new G;break;case"zlib@openssh.com":if(this._protocol._authenticated){if(t)w.write=new $(this._protocol);else w.read=new G;break}default:if(t)w.write=new q(this._protocol);else w.read=new W}this._protocol._packetRW.read.cleanup();this._protocol._packetRW.write.cleanup();this._protocol._packetRW.read=w.read;g=w.write;this._public=null;this._dh=null;this._kexinit=this._protocol._kexinit=undefined;this._remoteKexinit=undefined;this._identRaw=undefined;this._remoteIdentRaw=undefined;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined;if(!e)return completeHandshake();return false};if(t||e)this.finish=completeHandshake;if(!t)return completeHandshake(e)}start(){if(!this._protocol._server){if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_INIT";break;default:e="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${e}`)}const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=C.KEXDH_INIT;x(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}getPublicKey(){this.generateKeys();const e=this._public;if(e)return this.convertPublicKey(e)}convertPublicKey(e){let t;let n=0;let r=e.length;while(e[n]===0){++n;--r}if(e[n]&128){t=Buffer.allocUnsafe(1+r);t[0]=0;e.copy(t,1,n);return t}if(r!==e.length){t=Buffer.allocUnsafe(r);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{return convertToMpint(this._dh.computeSecret(e))}catch(e){return e}}parse(e){const t=e[0];switch(this._step){case 1:if(this._protocol._server){if(t!==C.KEXDH_INIT){return L(this._protocol,`Received packet ${t} instead of ${C.KEXDH_INIT}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Init");P.init(e,1);const n=P.readString();P.clear();if(n===undefined){return L(this._protocol,"Received malformed KEX*_INIT","handshake",m.KEY_EXCHANGE_FAILED)}this._dhData=n;let r=this._protocol._hostKeys[this.negotiated.serverHostKey];if(Array.isArray(r))r=r[0];this._hostKey=r;this.finish()}else{if(t!==C.KEXDH_REPLY){return L(this._protocol,`Received packet ${t} instead of ${C.KEXDH_REPLY}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Reply");P.init(e,1);let n;let r;let i;if((n=P.readString())===undefined||(r=P.readString())===undefined||(i=P.readString())===undefined){P.clear();return L(this._protocol,"Received malformed KEX*_REPLY","handshake",m.KEY_EXCHANGE_FAILED)}P.clear();P.init(n,0);const s=P.readString(true);P.clear();if(s===undefined){return L(this._protocol,"Received malformed host public key","handshake",m.KEY_EXCHANGE_FAILED)}if(s!==this.negotiated.serverHostKey){switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(s==="ssh-rsa")break;default:return L(this._protocol,"Host key does not match negotiated type","handshake",m.KEY_EXCHANGE_FAILED)}}this._hostKey=n;this._dhData=r;this._sig=i;let o=false;let f;if(this._protocol._hostVerifier===undefined){f=true;this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")}else{f=this._protocol._hostVerifier(n,(e=>{if(o)return;o=true;if(e===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return L(this._protocol,"Host denied (verification failed)","handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;if(this._receivedNEWKEYS)this.finish();else trySendNEWKEYS(this)}))}if(f===undefined){++this._step;return}o=true;if(f===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return L(this._protocol,"Host denied (verification failed)","handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;trySendNEWKEYS(this)}++this._step;break;case 2:if(t!==C.NEWKEYS){return L(this._protocol,`Received packet ${t} instead of ${C.NEWKEYS}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS");this._receivedNEWKEYS=true;if(this._protocol._strictMode)this._protocol._decipher.inSeqno=0;++this._step;return this.finish(!this._protocol._server&&!this._hostVerified);default:return L(this._protocol,`Received unexpected packet ${t} after NEWKEYS`,"handshake",m.KEY_EXCHANGE_FAILED)}}}class Curve25519Exchange extends KeyExchange{constructor(e,...t){super(...t);this.type="25519";this.hashName=e;this._keys=null}generateKeys(){if(!this._keys)this._keys=u("x25519")}getPublicKey(){this.generateKeys();const e=this._keys.publicKey.export({type:"spki",format:"der"});return e.slice(-32)}convertPublicKey(e){let t;let n=0;let r=e.length;while(e[n]===0){++n;--r}if(e.length===32)return e;if(r!==e.length){t=Buffer.allocUnsafe(r);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{const t=new g.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.110");t.endSequence();t.startSequence(g.BitString);t.writeByte(0);t._ensure(e.length);e.copy(t._buf,t._offset,0,e.length);t._offset+=e.length;t.endSequence();t.endSequence();return convertToMpint(h({privateKey:this._keys.privateKey,publicKey:f({key:t.buffer,type:"spki",format:"der"})}))}catch(e){return e}}}class ECDHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="ecdh";this.curveName=e;this.hashName=t}generateKeys(){if(!this._dh){this._dh=s(this.curveName);this._public=this._dh.generateKeys()}}}class DHGroupExchange extends KeyExchange{constructor(e,...t){super(...t);this.type="groupex";this.hashName=e;this._prime=null;this._generator=null;this._minBits=V;this._prefBits=dhEstimate(this.negotiated);if(this._protocol._compatFlags&p.BUG_DHGEX_LARGE)this._prefBits=Math.min(this._prefBits,4096);this._maxBits=j}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let e=this._protocol._packetRW.write.allocStartKEX;const t=this._protocol._packetRW.write.alloc(1+4+4+4,true);t[e]=C.KEXDH_GEX_REQUEST;x(t,this._minBits,++e);x(t,this._prefBits,e+=4);x(t,this._maxBits,e+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(t,true))}generateKeys(){if(!this._dh&&this._prime&&this._generator){this._dh=r(this._prime,this._generator);this._public=this._dh.generateKeys()}}setDHParams(e,t){if(!Buffer.isBuffer(e))throw new Error("Invalid prime value");if(!Buffer.isBuffer(t))throw new Error("Invalid generator value");this._prime=e;this._generator=t}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}parse(e){const t=e[0];switch(this._step){case 1:{if(this._protocol._server){if(t!==C.KEXDH_GEX_REQUEST){return L(this._protocol,`Received packet ${t} instead of `+C.KEXDH_GEX_REQUEST,"handshake",m.KEY_EXCHANGE_FAILED)}return L(this._protocol,"Group exchange not implemented for server","handshake",m.KEY_EXCHANGE_FAILED)}if(t!==C.KEXDH_GEX_GROUP){return L(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_GROUP}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Group");P.init(e,1);let n;let r;if((n=P.readString())===undefined||(r=P.readString())===undefined){P.clear();return L(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",m.KEY_EXCHANGE_FAILED)}P.clear();this.setDHParams(n,r);this.generateKeys();const i=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let s=this._protocol._packetRW.write.allocStartKEX;const o=this._protocol._packetRW.write.alloc(1+4+i.length,true);o[s]=C.KEXDH_GEX_INIT;x(o,i.length,++s);o.set(i,s+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(o,true));++this._step;break}case 2:if(this._protocol._server){if(t!==C.KEXDH_GEX_INIT){return L(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_INIT}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Init");return L(this._protocol,"Group exchange not implemented for server","handshake",m.KEY_EXCHANGE_FAILED)}else if(t!==C.KEXDH_GEX_REPLY){return L(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_REPLY}`,"handshake",m.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Reply");this._step=1;e[0]=C.KEXDH_REPLY;this.parse=KeyExchange.prototype.parse;this.parse(e)}}}class DHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="group";this.groupName=e;this.hashName=t}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=C.KEXDH_INIT;x(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}generateKeys(){if(!this._dh){this._dh=i(this.groupName);this._public=this._dh.generateKeys()}}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}}return(e,...t)=>{if(typeof e!=="object"||e===null)throw new Error("Invalid negotiated argument");const n=e.kex;if(typeof n==="string"){t=[e,...t];switch(n){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!_)break;return new Curve25519Exchange("sha256",...t);case"ecdh-sha2-nistp256":return new ECDHExchange("prime256v1","sha256",...t);case"ecdh-sha2-nistp384":return new ECDHExchange("secp384r1","sha384",...t);case"ecdh-sha2-nistp521":return new ECDHExchange("secp521r1","sha512",...t);case"diffie-hellman-group1-sha1":return new DHExchange("modp2","sha1",...t);case"diffie-hellman-group14-sha1":return new DHExchange("modp14","sha1",...t);case"diffie-hellman-group14-sha256":return new DHExchange("modp14","sha256",...t);case"diffie-hellman-group15-sha512":return new DHExchange("modp15","sha512",...t);case"diffie-hellman-group16-sha512":return new DHExchange("modp16","sha512",...t);case"diffie-hellman-group17-sha512":return new DHExchange("modp17","sha512",...t);case"diffie-hellman-group18-sha512":return new DHExchange("modp18","sha512",...t);case"diffie-hellman-group-exchange-sha1":return new DHGroupExchange("sha1",...t);case"diffie-hellman-group-exchange-sha256":return new DHGroupExchange("sha256",...t)}throw new Error(`Unsupported key exchange algorithm: ${n}`)}throw new Error(`Invalid key exchange type: ${n}`)}})();const ee=(()=>{const e=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class KexInit{constructor(t){if(typeof t!=="object"||t===null)throw new TypeError("Argument must be an object");const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},all:undefined};let r=0;for(const i of e){let e;let s;let o;let f;if(typeof i==="string"){e=n;s=t[i];o=f=i}else{const r=i[0];e=n[r];f=i[1];s=t[r][f];o=`${r}.${f}`}const h={array:undefined,buffer:undefined};if(Buffer.isBuffer(s)){h.array=(""+s).split(",");h.buffer=s;r+=4+s.length}else{if(typeof s==="string")s=s.split(",");if(Array.isArray(s)){h.array=s;h.buffer=Buffer.from(s.join(","))}else{throw new TypeError(`Invalid \`${o}\` type: ${typeof s}`)}r+=4+h.buffer.length}e[f]=h}const i=Buffer.allocUnsafe(r);n.all=i;let s=0;for(const t of e){let e;if(typeof t==="string")e=n[t].buffer;else e=n[t[0]][t[1]].buffer;s=x(i,e.length,s);i.set(e,s);s+=e.length}this.totalSize=r;this.lists=n}copyAllTo(e,t){const n=this.lists.all;if(typeof t!=="number")throw new TypeError(`Invalid offset value: ${typeof t}`);if(e.length-t<n.length)throw new Error("Insufficient space to copy list");e.set(n,t);return n.length}}})();const te=(()=>{const e=Buffer.allocUnsafe(4);return(t,n)=>{x(e,n.length,0);t.update(e);t.update(n)}})();function generateKEXVal(e,t,n,r,i,s){let f;if(e){let h=o(t).update(n).update(r).update(s).update(i).digest();while(h.length<e){const e=o(t).update(n).update(r).update(h).digest();const i=Buffer.allocUnsafe(h.length+e.length);i.set(h,0);i.set(e,h.length);h=i}if(h.length===e)f=h;else f=new D(h.buffer,h.byteOffset,e)}else{f=z}return f}function onKEXPayload(e,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=false;return}t=this._packetRW.read.read(t);const r=t[0];if(!this._strictMode){switch(r){case C.IGNORE:case C.UNIMPLEMENTED:case C.DEBUG:if(!Y)Y=n(374);return Y[r](this,t)}}switch(r){case C.DISCONNECT:if(!Y)Y=n(374);return Y[r](this,t);case C.KEXINIT:if(!e.firstPacket){return L(this,"Received extra KEXINIT during handshake","handshake",m.KEY_EXCHANGE_FAILED)}e.firstPacket=false;return handleKexInit(this,t);default:if(r<20||r>49){return L(this,`Received unexpected packet type ${r}`,"handshake",m.KEY_EXCHANGE_FAILED)}}return this._kex.parse(t)}function dhEstimate(e){const t=B[e.cs.cipher];const n=B[e.sc.cipher];const r=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,n.sslName==="des-ede3-cbc"?14:n.keyLen,n.blockLen,n.ivLen)*8;if(r<=112)return 2048;if(r<=128)return 3072;if(r<=192)return 7680;return 8192}function trySendNEWKEYS(e){if(!e._sentNEWKEYS){e._protocol._debug&&e._protocol._debug("Outbound: Sending NEWKEYS");const t=e._protocol._packetRW.write.allocStartKEX;const n=e._protocol._packetRW.write.alloc(1,true);n[t]=C.NEWKEYS;e._protocol._cipher.encrypt(e._protocol._packetRW.write.finalize(n,true));e._sentNEWKEYS=true;if(e._protocol._strictMode)e._protocol._cipher.outSeqno=0}}e.exports={KexInit:ee,kexinit:kexinit,onKEXPayload:onKEXPayload,DEFAULT_KEXINIT_CLIENT:new ee({kex:E.concat(["ext-info-c","kex-strict-c-v00@openssh.com"]),serverHostKey:y,cs:{cipher:I,mac:b,compress:w,lang:[]},sc:{cipher:I,mac:b,compress:w,lang:[]}}),DEFAULT_KEXINIT_SERVER:new ee({kex:E.concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:y,cs:{cipher:I,mac:b,compress:w,lang:[]},sc:{cipher:I,mac:b,compress:w,lang:[]}}),HANDLERS:{[C.KEXINIT]:handleKexInit}}},613:(e,t,n)=>{"use strict";const{createDecipheriv:r,createECDH:i,createHash:s,createHmac:o,createSign:f,createVerify:h,getCiphers:u,sign:l,verify:g}=n(113);const p=u();const{Ber:_}=n(680);const E=n(583).pbkdf;const{CIPHER_INFO:y}=n(92);const{eddsaSupported:I,SUPPORTED_CIPHER:b}=n(480);const{bufferSlice:w,makeBufferParser:m,readString:C,readUInt32BE:B,writeUInt32BE:k}=n(775);const R=Symbol("Hash Algorithm");const v=Symbol("Private key PEM");const T=Symbol("Public key PEM");const U=Symbol("Public key SSH");const P=Symbol("Decrypted Key");const O=Object.create(null);{const e=Object.keys(y);for(let t=0;t<e.length;++t){const n=y[e[t]].sslName;if(!n||O[n])continue;O[n]=y[e[t]]}}const L=m();function makePEM(e,t){t=t.base64Slice(0,t.length);let n=t.replace(/.{64}/g,"$&\n");if(t.length&63)n+="\n";return`-----BEGIN ${e} KEY-----\n${n}-----END ${e} KEY-----`}function combineBuffers(e,t){const n=Buffer.allocUnsafe(e.length+t.length);n.set(e,0);n.set(t,e.length);return n}function skipFields(e,t){const n=e.length;let r=e._pos||0;for(let i=0;i<t;++i){const t=n-r;if(r>=n||t<4)return false;const i=B(e,r);if(t<4+i)return false;r+=4+i}e._pos=r;return true}function genOpenSSLRSAPub(e,t){const n=new _.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.113549.1.1.1");n.writeNull();n.endSequence();n.startSequence(_.BitString);n.writeByte(0);n.startSequence();n.writeBuffer(e,_.Integer);n.writeBuffer(t,_.Integer);n.endSequence();n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHRSAPub(e,t){const n=Buffer.allocUnsafe(4+7+4+t.length+4+e.length);k(n,7,0);n.utf8Write("ssh-rsa",4,7);let r=4+7;k(n,t.length,r);n.set(t,r+=4);k(n,e.length,r+=t.length);n.set(e,r+4);return n}const D=(()=>{function genRSAASN1Buf(e,t,n,r,i,s,o,f){const h=new _.Writer;h.startSequence();h.writeInt(0,_.Integer);h.writeBuffer(e,_.Integer);h.writeBuffer(t,_.Integer);h.writeBuffer(n,_.Integer);h.writeBuffer(r,_.Integer);h.writeBuffer(i,_.Integer);h.writeBuffer(s,_.Integer);h.writeBuffer(o,_.Integer);h.writeBuffer(f,_.Integer);h.endSequence();return h.buffer}function bigIntFromBuffer(e){return BigInt(`0x${e.hexSlice(0,e.length)}`)}function bigIntToBuffer(e){let t=e.toString(16);if((t.length&1)!==0){t=`0${t}`}else{const e=t.charCodeAt(0);if(e===56||e===57||e>=97&&e<=102){t=`00${t}`}}return Buffer.from(t,"hex")}return function genOpenSSLRSAPriv(e,t,n,r,i,s){const o=bigIntFromBuffer(n);const f=bigIntToBuffer(o%(bigIntFromBuffer(i)-1n));const h=bigIntToBuffer(o%(bigIntFromBuffer(s)-1n));return makePEM("RSA PRIVATE",genRSAASN1Buf(e,t,n,i,s,f,h,r))}})();function genOpenSSLDSAPub(e,t,n,r){const i=new _.Writer;i.startSequence();i.startSequence();i.writeOID("1.2.840.10040.4.1");i.startSequence();i.writeBuffer(e,_.Integer);i.writeBuffer(t,_.Integer);i.writeBuffer(n,_.Integer);i.endSequence();i.endSequence();i.startSequence(_.BitString);i.writeByte(0);i.writeBuffer(r,_.Integer);i.endSequence();i.endSequence();return makePEM("PUBLIC",i.buffer)}function genOpenSSHDSAPub(e,t,n,r){const i=Buffer.allocUnsafe(4+7+4+e.length+4+t.length+4+n.length+4+r.length);k(i,7,0);i.utf8Write("ssh-dss",4,7);let s=4+7;k(i,e.length,s);i.set(e,s+=4);k(i,t.length,s+=e.length);i.set(t,s+=4);k(i,n.length,s+=t.length);i.set(n,s+=4);k(i,r.length,s+=n.length);i.set(r,s+4);return i}function genOpenSSLDSAPriv(e,t,n,r,i){const s=new _.Writer;s.startSequence();s.writeInt(0,_.Integer);s.writeBuffer(e,_.Integer);s.writeBuffer(t,_.Integer);s.writeBuffer(n,_.Integer);s.writeBuffer(r,_.Integer);s.writeBuffer(i,_.Integer);s.endSequence();return makePEM("DSA PRIVATE",s.buffer)}function genOpenSSLEdPub(e){const t=new _.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(_.BitString);t.writeByte(0);t._ensure(e.length);t._buf.set(e,t._offset);t._offset+=e.length;t.endSequence();t.endSequence();return makePEM("PUBLIC",t.buffer)}function genOpenSSHEdPub(e){const t=Buffer.allocUnsafe(4+11+4+e.length);k(t,11,0);t.utf8Write("ssh-ed25519",4,11);k(t,e.length,15);t.set(e,19);return t}function genOpenSSLEdPriv(e){const t=new _.Writer;t.startSequence();t.writeInt(0,_.Integer);t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(_.OctetString);t.writeBuffer(e,_.OctetString);t.endSequence();t.endSequence();return makePEM("PRIVATE",t.buffer)}function genOpenSSLECDSAPub(e,t){const n=new _.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.10045.2.1");n.writeOID(e);n.endSequence();n.startSequence(_.BitString);n.writeByte(0);n._ensure(t.length);n._buf.set(t,n._offset);n._offset+=t.length;n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHECDSAPub(e,t){let n;switch(e){case"1.2.840.10045.3.1.7":n="nistp256";break;case"1.3.132.0.34":n="nistp384";break;case"1.3.132.0.35":n="nistp521";break;default:return}const r=Buffer.allocUnsafe(4+19+4+8+4+t.length);k(r,19,0);r.utf8Write(`ecdsa-sha2-${n}`,4,19);k(r,8,23);r.utf8Write(n,27,8);k(r,t.length,35);r.set(t,39);return r}function genOpenSSLECDSAPriv(e,t,n){const r=new _.Writer;r.startSequence();r.writeInt(1,_.Integer);r.writeBuffer(n,_.OctetString);r.startSequence(160);r.writeOID(e);r.endSequence();r.startSequence(161);r.startSequence(_.BitString);r.writeByte(0);r._ensure(t.length);r._buf.set(t,r._offset);r._offset+=t.length;r.endSequence();r.endSequence();r.endSequence();return makePEM("EC PRIVATE",r.buffer)}function genOpenSSLECDSAPubFromPriv(e,t){const n=i(e);n.setPrivateKey(t);return n.getPublicKey()}const Q={sign:(()=>{if(typeof l==="function"){return function sign(e,t){const n=this[v];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[R];try{return l(t,e,n)}catch(e){return e}}}return function sign(e,t){const n=this[v];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[R];const r=f(t);r.update(e);try{return r.sign(n)}catch(e){return e}}})(),verify:(()=>{if(typeof g==="function"){return function verify(e,t,n){const r=this[T];if(r===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[R];try{return g(n,e,r,t)}catch(e){return e}}}return function verify(e,t,n){const r=this[T];if(r===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[R];const i=h(n);i.update(e);try{return i.verify(r,t)}catch(e){return e}}})(),isPrivateKey:function isPrivateKey(){return this[v]!==null},getPrivatePEM:function getPrivatePEM(){return this[v]},getPublicPEM:function getPublicPEM(){return this[T]},getPublicSSH:function getPublicSSH(){return this[U]},equals:function equals(e){const t=parseKey(e);if(t instanceof Error)return false;return this.type===t.type&&this[v]===t[v]&&this[T]===t[T]&&this[U].equals(t[U])}};function OpenSSH_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[T]=r;this[U]=i;this[R]=s;this[P]=o}OpenSSH_Private.prototype=Q;{const e=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;OpenSSH_Private.parse=(t,n)=>{const i=e.exec(t);if(i===null)return null;let s;const o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");const f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);const h=C(o,15,true);if(h===undefined)return new Error("Malformed OpenSSH private key");if(h!=="none"&&b.indexOf(h)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${h}`);const u=C(o,o._pos,true);if(u===undefined)return new Error("Malformed OpenSSH private key");if(u!=="none"){if(h==="none")return new Error("Malformed OpenSSH private key");if(u!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${u}`);if(!n){return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}}else if(h!=="none"){return new Error("Malformed OpenSSH private key")}let l;let g;let p;if(h!=="none")l=y[h];const _=C(o,o._pos);if(_===undefined)return new Error("Malformed OpenSSH private key");if(_.length){switch(u){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":{const e=C(_,0);if(e===undefined||_._pos+4>_.length)return new Error("Malformed OpenSSH private key");const t=B(_,_._pos);const r=Buffer.allocUnsafe(l.keyLen+l.ivLen);const i=E(n,n.length,e,e.length,r,r.length,t);if(i!==0)return new Error("Failed to generate information to decrypt key");g=w(r,0,l.keyLen);p=w(r,l.keyLen,r.length);break}}}else if(u!=="none"){return new Error("Malformed OpenSSH private key")}if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");const I=B(o,o._pos);o._pos+=4;if(I>0){for(let e=0;e<I;++e){const e=C(o,o._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");const t=C(e,0,true);if(t===undefined)return new Error("Malformed OpenSSH private key")}let e=C(o,o._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");if(g!==undefined){if(e.length<l.blockLen||e.length%l.blockLen!==0){return new Error("Malformed OpenSSH private key")}try{const t={authTagLength:l.authLen};const n=r(l.sslName,g,p,t);n.setAutoPadding(false);if(l.authLen>0){if(o.length-o._pos<l.authLen)return new Error("Malformed OpenSSH private key");n.setAuthTag(w(o,o._pos,o._pos+=l.authLen))}e=combineBuffers(n.update(e),n.final())}catch(e){return e}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=parseOpenSSHPrivKeys(e,I,g!==undefined)}else{s=[]}if(s instanceof Error)return s;return s[0]};function parseOpenSSHPrivKeys(e,t,n){const r=[];if(e.length<8)return new Error("Malformed OpenSSH private key");const i=B(e,0);const s=B(e,4);if(i!==s){if(n){return new Error("OpenSSH key integrity check failed -- bad passphrase?")}return new Error("OpenSSH key integrity check failed")}e._pos=8;let o;let f;for(o=0;o<t;++o){let t;let i;let s;let o;const h=C(e,e._pos,true);if(h===undefined)return new Error("Malformed OpenSSH private key");switch(h){case"ssh-rsa":{const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");const f=C(e,e._pos);if(f===undefined)return new Error("Malformed OpenSSH private key");const h=C(e,e._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");const u=C(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const l=C(e,e._pos);if(l===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLRSAPub(n,r);o=genOpenSSHRSAPub(n,r);i=D(n,r,f,h,u,l);t="sha1";break}case"ssh-dss":{const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");const f=C(e,e._pos);if(f===undefined)return new Error("Malformed OpenSSH private key");const h=C(e,e._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");const u=C(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLDSAPub(n,r,f,h);o=genOpenSSHDSAPub(n,r,f,h);i=genOpenSSLDSAPriv(n,r,f,h,u);t="sha1";break}case"ssh-ed25519":{if(!I)return new Error(`Unsupported OpenSSH private key type: ${h}`);const n=C(e,e._pos);if(n===undefined||n.length!==32)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined||r.length!==64)return new Error("Malformed OpenSSH private key");s=genOpenSSLEdPub(n);o=genOpenSSHEdPub(n);i=genOpenSSLEdPriv(w(r,0,32));t=null;break}case"ecdsa-sha2-nistp256":t="sha256";f="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(t===undefined){t="sha384";f="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(t===undefined){t="sha512";f="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH private key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLECDSAPub(f,n);o=genOpenSSHECDSAPub(f,n);i=genOpenSSLECDSAPriv(f,n,r);break}default:return new Error(`Unsupported OpenSSH private key type: ${h}`)}const u=C(e,e._pos,true);if(u===undefined)return new Error("Malformed OpenSSH private key");r.push(new OpenSSH_Private(h,u,i,s,o,t,n))}let h=0;for(o=e._pos;o<e.length;++o){if(e[o]!==++h%255)return new Error("Malformed OpenSSH private key")}return r}}function OpenSSH_Old_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[T]=r;this[U]=i;this[R]=s;this[P]=o}OpenSSH_Old_Private.prototype=Q;{const e=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;OpenSSH_Old_Private.parse=(t,n)=>{const i=e.exec(t);if(i===null)return null;let o=Buffer.from(i[3],"base64");let f=i[2];let h=false;if(f!==undefined){f=f.split(/\r\n|\n/g);for(let e=0;e<f.length;++e){const t=f[e];let i=t.indexOf(":");if(t.slice(0,i)==="DEK-Info"){const e=t.slice(i+2);i=e.indexOf(",");if(i===-1)continue;const f=e.slice(0,i).toLowerCase();if(p.indexOf(f)===-1){return new Error(`Cipher (${f}) not supported `+"for encrypted OpenSSH private key")}const u=O[f];if(!u){return new Error(`Cipher (${f}) not supported `+"for encrypted OpenSSH private key")}const l=Buffer.from(e.slice(i+1),"hex");if(l.length!==u.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!n){return new Error("Encrypted OpenSSH private key detected, but no passphrase given")}const g=w(l,0,8);let _=s("md5").update(n).update(g).digest();while(_.length<u.keyLen){_=combineBuffers(_,s("md5").update(_).update(n).update(g).digest())}if(_.length>u.keyLen)_=w(_,0,u.keyLen);try{const e=r(f,_,l);e.setAutoPadding(false);o=combineBuffers(e.update(o),e.final());h=true}catch(e){return e}}}}let u;let l;let g;let E;let y;let I;let b="Malformed OpenSSH private key";if(h)b+=". Bad passphrase?";switch(i[1]){case"RSA":u="ssh-rsa";l=makePEM("RSA PRIVATE",o);try{I=new _.Reader(o);I.readSequence();I.readInt();const e=I.readString(_.Integer,true);if(e===null)return new Error(b);const t=I.readString(_.Integer,true);if(t===null)return new Error(b);g=genOpenSSLRSAPub(e,t);E=genOpenSSHRSAPub(e,t)}catch{return new Error(b)}y="sha1";break;case"DSA":u="ssh-dss";l=makePEM("DSA PRIVATE",o);try{I=new _.Reader(o);I.readSequence();I.readInt();const e=I.readString(_.Integer,true);if(e===null)return new Error(b);const t=I.readString(_.Integer,true);if(t===null)return new Error(b);const n=I.readString(_.Integer,true);if(n===null)return new Error(b);const r=I.readString(_.Integer,true);if(r===null)return new Error(b);g=genOpenSSLDSAPub(e,t,n,r);E=genOpenSSHDSAPub(e,t,n,r)}catch{return new Error(b)}y="sha1";break;case"EC":{let e;let t;let n;try{I=new _.Reader(o);I.readSequence();I.readInt();t=I.readString(_.OctetString,true);I.readByte();const r=I.readLength();if(r!==null){I._offset=r;n=I.readOID();if(n===null)return new Error(b);switch(n){case"1.2.840.10045.3.1.7":e="prime256v1";u="ecdsa-sha2-nistp256";y="sha256";break;case"1.3.132.0.34":e="secp384r1";u="ecdsa-sha2-nistp384";y="sha384";break;case"1.3.132.0.35":e="secp521r1";u="ecdsa-sha2-nistp521";y="sha512";break;default:return new Error(`Unsupported private key EC OID: ${n}`)}}else{return new Error(b)}}catch{return new Error(b)}l=makePEM("EC PRIVATE",o);const r=genOpenSSLECDSAPubFromPriv(e,t);g=genOpenSSLECDSAPub(n,r);E=genOpenSSHECDSAPub(n,r);break}}return new OpenSSH_Old_Private(u,"",l,g,E,y,h)}}function PPK_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[T]=r;this[U]=i;this[R]=s;this[P]=o}PPK_Private.prototype=Q;{const e=Buffer.alloc(0);const t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const n=Buffer.from([0,0,0,0]);const i=Buffer.from([0,0,0,1]);const f=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;PPK_Private.parse=(h,u)=>{const l=f.exec(h);if(l===null)return null;const g=l[2];const p=g!=="none";if(p&&!u){return new Error("Encrypted PPK private key detected, but no passphrase given")}let _=Buffer.from(l[5],"base64");if(p){const e=y[g];let o=combineBuffers(s("sha1").update(n).update(u).digest(),s("sha1").update(i).update(u).digest());if(o.length>e.keyLen)o=w(o,0,e.keyLen);try{const n=r(e.sslName,o,t);n.setAutoPadding(false);_=combineBuffers(n.update(_),n.final())}catch(e){return e}}const E=l[1];const I=l[3];const b=Buffer.from(l[4],"base64");const m=l[6];const B=E.length;const R=g.length;const v=Buffer.byteLength(I);const T=b.length;const U=_.length;const P=Buffer.allocUnsafe(4+B+4+R+4+v+4+T+4+U);let O=0;k(P,B,O);P.utf8Write(E,O+=4,B);k(P,R,O+=B);P.utf8Write(g,O+=4,R);k(P,v,O+=R);P.utf8Write(I,O+=4,v);k(P,T,O+=v);P.set(b,O+=4);k(P,U,O+=T);P.set(_,O+4);if(!u)u=e;const L=o("sha1",s("sha1").update("putty-private-key-file-mac-key").update(u).digest()).update(P).digest("hex");if(L!==m){if(p){return new Error("PPK private key integrity check failed -- bad passphrase?")}return new Error("PPK private key integrity check failed")}let Q;let x;let W;b._pos=0;skipFields(b,1);switch(E){case"ssh-rsa":{const e=C(b,b._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=C(b,b._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=C(_,0);if(n===undefined)return new Error("Malformed PPK private key");const r=C(_,_._pos);if(r===undefined)return new Error("Malformed PPK private key");const i=C(_,_._pos);if(i===undefined)return new Error("Malformed PPK private key");const s=C(_,_._pos);if(s===undefined)return new Error("Malformed PPK private key");Q=genOpenSSLRSAPub(t,e);x=genOpenSSHRSAPub(t,e);W=D(t,e,n,s,r,i);break}case"ssh-dss":{const e=C(b,b._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=C(b,b._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=C(b,b._pos);if(n===undefined)return new Error("Malformed PPK public key");const r=C(b,b._pos);if(r===undefined)return new Error("Malformed PPK public key");const i=C(_,0);if(i===undefined)return new Error("Malformed PPK private key");Q=genOpenSSLDSAPub(e,t,n,r);x=genOpenSSHDSAPub(e,t,n,r);W=genOpenSSLDSAPriv(e,t,n,r,i);break}}return new PPK_Private(E,I,W,Q,x,"sha1",p)}}function OpenSSH_Public(e,t,n,r,i){this.type=e;this.comment=t;this[v]=null;this[T]=n;this[U]=r;this[R]=i;this[P]=false}OpenSSH_Public.prototype=Q;{let e;if(I)e=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;else e=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;OpenSSH_Public.parse=t=>{const n=e.exec(t);if(n===null)return null;const r=n[1];const i=n[2];const s=Buffer.from(n[3],"base64");const o=n[4]||"";const f=C(s,s._pos,true);if(f===undefined||f.indexOf(i)!==0)return new Error("Malformed OpenSSH public key");return parseDER(s,i,o,r)}}function RFC4716_Public(e,t,n,r,i){this.type=e;this.comment=t;this[v]=null;this[T]=n;this[U]=r;this[R]=i;this[P]=false}RFC4716_Public.prototype=Q;{const e=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/;const t=/^[A-Z0-9a-z/+=\r\n]+$/;const n=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm;const r=/\\\r?\n/g;RFC4716_Public.parse=i=>{let s=e.exec(i);if(s===null)return null;const o=s[1];let f=0;let h="";while(s=n.exec(o)){const e=s[1];const t=s[2].replace(r,"");if(t.length>1024){n.lastIndex=0;return new Error("Malformed RFC4716 public key")}f=n.lastIndex;if(e.toLowerCase()==="comment"){h=t;if(h.length>1&&h.charCodeAt(0)===34&&h.charCodeAt(h.length-1)===34){h=h.slice(1,-1)}}}let u=o.slice(f);if(!t.test(u))return new Error("Malformed RFC4716 public key");u=Buffer.from(u,"base64");const l=C(u,0,true);if(l===undefined)return new Error("Malformed RFC4716 public key");let g=null;let p=null;switch(l){case"ssh-rsa":{const e=C(u,u._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=C(u,u._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");g=genOpenSSLRSAPub(t,e);p=genOpenSSHRSAPub(t,e);break}case"ssh-dss":{const e=C(u,u._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=C(u,u._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");const n=C(u,u._pos);if(n===undefined)return new Error("Malformed RFC4716 public key");const r=C(u,u._pos);if(r===undefined)return new Error("Malformed RFC4716 public key");g=genOpenSSLDSAPub(e,t,n,r);p=genOpenSSHDSAPub(e,t,n,r);break}default:return new Error("Malformed RFC4716 public key")}return new RFC4716_Public(l,h,g,p,"sha1")}}function parseDER(e,t,n,r){if(!isSupportedKeyType(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let i;let s;let o=null;let f=null;switch(t){case"ssh-rsa":{const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLRSAPub(n,t);f=genOpenSSHRSAPub(n,t);i="sha1";break}case"ssh-dss":{const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH public key");const s=C(e,e._pos);if(s===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLDSAPub(t,n,r,s);f=genOpenSSHDSAPub(t,n,r,s);i="sha1";break}case"ssh-ed25519":{const t=C(e,e._pos||0);if(t===undefined||t.length!==32)return new Error("Malformed OpenSSH public key");o=genOpenSSLEdPub(t);f=genOpenSSHEdPub(t);i=null;break}case"ecdsa-sha2-nistp256":i="sha256";s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(i===undefined){i="sha384";s="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(i===undefined){i="sha512";s="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH public key");const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLECDSAPub(s,t);f=genOpenSSHECDSAPub(s,t);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new OpenSSH_Public(r,n,o,f,i)}function isSupportedKeyType(e){switch(e){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return true;case"ssh-ed25519":if(I)return true;default:return false}}function isParsedKey(e){if(!e)return false;return typeof e[P]==="boolean"}function parseKey(e,t){if(isParsedKey(e))return e;let n;if(Buffer.isBuffer(e)){n=e;e=e.utf8Slice(0,e.length).trim()}else if(typeof e==="string"){e=e.trim()}else{return new Error("Key data must be a Buffer or string")}if(t!=undefined){if(typeof t==="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let r;if((r=OpenSSH_Private.parse(e,t))!==null)return r;if((r=OpenSSH_Old_Private.parse(e,t))!==null)return r;if((r=PPK_Private.parse(e,t))!==null)return r;if((r=OpenSSH_Public.parse(e))!==null)return r;if((r=RFC4716_Public.parse(e))!==null)return r;if(n){L.init(n,0);const t=L.readString(true);if(t!==undefined){e=L.readRaw();if(e!==undefined){r=parseDER(e,t,"",t);if(r instanceof Error)r=null}}L.clear()}if(r)return r;return new Error("Unsupported key format")}e.exports={isParsedKey:isParsedKey,isSupportedKeyType:isSupportedKeyType,parseDERKey:(e,t)=>parseDER(e,t,"",t),parseKey:parseKey}},921:(e,t,n)=>{"use strict";const r=n(491);const{inspect:i}=n(837);function addNumericalSeparator(e){let t="";let n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function oneOf(e,t){r(typeof t==="string","`thing` has to be of type string");if(Array.isArray(e)){const n=e.length;r(n>0,"At least one expected value needs to be specified");e=e.map((e=>String(e)));if(n>2){return`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]}else if(n===2){return`one of ${t} ${e[0]} or ${e[1]}`}return`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}t.ERR_INTERNAL_ASSERTION=class ERR_INTERNAL_ASSERTION extends Error{constructor(e){super();Error.captureStackTrace(this,ERR_INTERNAL_ASSERTION);const t="This is caused by either a bug in ssh2 "+"or incorrect usage of ssh2 internals.\n"+"Please open an issue with this stack trace at "+"https://github.com/mscdex/ssh2/issues\n";this.message=e===undefined?t:`${e}\n${t}`}};const s=2**32;const o=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();t.ERR_OUT_OF_RANGE=class ERR_OUT_OF_RANGE extends RangeError{constructor(e,t,n,f){super();Error.captureStackTrace(this,ERR_OUT_OF_RANGE);r(t,'Missing "range" argument');let h=f?e:`The value of "${e}" is out of range.`;let u;if(Number.isInteger(n)&&Math.abs(n)>s){u=addNumericalSeparator(String(n))}else if(typeof n==="bigint"){u=String(n);if(n>o||n<-o)u=addNumericalSeparator(u);u+="n"}else{u=i(n)}h+=` It must be ${t}. Received ${u}`;this.message=h}};class ERR_INVALID_ARG_TYPE extends TypeError{constructor(e,t,n){super();Error.captureStackTrace(this,ERR_INVALID_ARG_TYPE);r(typeof e==="string",`'name' must be a string`);let i;if(typeof t==="string"&&t.startsWith("not ")){i="must not be";t=t.replace(/^not /,"")}else{i="must be"}let s;if(e.endsWith(" argument")){s=`The ${e} ${i} ${oneOf(t,"type")}`}else{const n=e.includes(".")?"property":"argument";s=`The "${e}" ${n} ${i} ${oneOf(t,"type")}`}s+=`. Received type ${typeof n}`;this.message=s}}t.ERR_INVALID_ARG_TYPE=ERR_INVALID_ARG_TYPE;t.validateNumber=function validateNumber(e,t){if(typeof e!=="number")throw new ERR_INVALID_ARG_TYPE(t,"number",e)}},775:(e,t,n)=>{"use strict";const r=n(680).Ber;let i;const s=Buffer[Symbol.species];const o=Object.getPrototypeOf(Uint8Array.prototype).fill;function readUInt32BE(e,t){return e[t++]*16777216+e[t++]*65536+e[t++]*256+e[t]}function bufferCopy(e,t,n,r,i){if(!i)i=0;if(r>e.length)r=e.length;let s=r-n;const o=t.length-i;if(s>o)s=o;t.set(new Uint8Array(e.buffer,e.byteOffset+n,s),i);return s}function bufferSlice(e,t,n){if(n===undefined)n=e.length;return new s(e.buffer,e.byteOffset+t,n-t)}function makeBufferParser(){let e=0;let t;const n={init:(n,r)=>{t=n;e=typeof r==="number"?r:0},pos:()=>e,length:()=>t?t.length:0,avail:()=>t&&e<t.length?t.length-e:0,clear:()=>{t=undefined},readUInt32BE:()=>{if(!t||e+3>=t.length)return;return t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]},readUInt64BE:n=>{if(!t||e+7>=t.length)return;switch(n){case"always":return BigInt(`0x${t.hexSlice(e,e+=8)}`);case"maybe":if(t[e]>31)return BigInt(`0x${t.hexSlice(e,e+=8)}`);default:return t[e++]*72057594037927940+t[e++]*281474976710656+t[e++]*1099511627776+t[e++]*4294967296+t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]}},skip:n=>{if(t&&n>0)e+=n},skipString:()=>{const r=n.readUInt32BE();if(r===undefined)return;e+=r;return e<=t.length?r:undefined},readByte:()=>{if(t&&e<t.length)return t[e++]},readBool:()=>{if(t&&e<t.length)return!!t[e++]},readList:()=>{const e=n.readString(true);if(e===undefined)return;return e?e.split(","):[]},readString:(r,i)=>{if(typeof r==="number"){i=r;r=undefined}const s=n.readUInt32BE();if(s===undefined)return;if(t.length-e<s||typeof i==="number"&&s>i){return}if(r){if(Buffer.isBuffer(r))return bufferCopy(t,r,e,e+=s);return t.utf8Slice(e,e+=s)}return bufferSlice(t,e,e+=s)},readRaw:n=>{if(!t)return;if(typeof n!=="number")return bufferSlice(t,e,e+=t.length-e);if(t.length-e>=n)return bufferSlice(t,e,e+=n)}};return n}function makeError(e,t,n){const r=new Error(e);if(typeof t==="boolean"){n=t;r.level="protocol"}else{r.level=t||"protocol"}r.fatal=!!n;return r}function writeUInt32BE(e,t,n){e[n++]=t>>>24;e[n++]=t>>>16;e[n++]=t>>>8;e[n++]=t;return n}const f=makeBufferParser();e.exports={bufferCopy:bufferCopy,bufferSlice:bufferSlice,FastBuffer:s,bufferFill:(e,t,n,r)=>o.call(e,t,n,r),makeError:makeError,doFatalError:(e,t,r,s)=>{let o;if(i===undefined)({DISCONNECT_REASON:i}=n(480));if(t instanceof Error){o=t;if(typeof r!=="number")s=i.PROTOCOL_ERROR;else s=r}else{o=makeError(t,r,true)}if(typeof s!=="number")s=i.PROTOCOL_ERROR;e.disconnect(s);e._destruct();e._onError(o);return Infinity},readUInt32BE:readUInt32BE,writeUInt32BE:writeUInt32BE,writeUInt32LE:(e,t,n)=>{e[n++]=t;e[n++]=t>>>8;e[n++]=t>>>16;e[n++]=t>>>24;return n},makeBufferParser:makeBufferParser,bufferParser:makeBufferParser(),readString:(e,t,n,r)=>{if(typeof n==="number"){r=n;n=undefined}if(t===undefined)t=0;const i=e.length-t;if(t<0||t>=e.length||i<4)return;const s=readUInt32BE(e,t);if(i<4+s||typeof r==="number"&&s>r)return;t+=4;const o=t+s;e._pos=o;if(n){if(Buffer.isBuffer(n))return bufferCopy(e,n,t,o);return e.utf8Slice(t,o)}return bufferSlice(e,t,o)},sigSSHToASN1:(e,t)=>{switch(t){case"ssh-dss":{if(e.length>40)return e;const t=new r.Writer;t.startSequence();let n=e.slice(0,20);let i=e.slice(20);if(n[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;n.copy(e,1);n=e}else if(n[0]===0&&!(n[1]&128)){n=n.slice(1)}if(i[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;i.copy(e,1);i=e}else if(i[0]===0&&!(i[1]&128)){i=i.slice(1)}t.writeBuffer(n,r.Integer);t.writeBuffer(i,r.Integer);t.endSequence();return t.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{f.init(e,0);const t=f.readString();const n=f.readString();f.clear();if(t===undefined||n===undefined)return;const i=new r.Writer;i.startSequence();i.writeBuffer(t,r.Integer);i.writeBuffer(n,r.Integer);i.endSequence();return i.buffer}default:return e}},convertSignature:(e,t)=>{switch(t){case"ssh-dss":{if(e.length<=40)return e;const t=new r.Reader(e);t.readSequence();let n=t.readString(r.Integer,true);let i=t.readString(r.Integer,true);let s=0;let o=0;if(n.length<20){const e=Buffer.allocUnsafe(20);e.set(n,1);n=e;n[0]=0}if(i.length<20){const e=Buffer.allocUnsafe(20);e.set(i,1);i=e;i[0]=0}if(n.length>20&&n[0]===0)s=1;if(i.length>20&&i[0]===0)o=1;const f=Buffer.allocUnsafe(n.length-s+(i.length-o));bufferCopy(n,f,s,n.length,0);bufferCopy(i,f,o,i.length,n.length-s);return f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(e[0]===0)return e;const t=new r.Reader(e);t.readSequence();const n=t.readString(r.Integer,true);const i=t.readString(r.Integer,true);if(n===null||i===null)return;const s=Buffer.allocUnsafe(4+n.length+4+i.length);writeUInt32BE(s,n.length,0);s.set(n,4);writeUInt32BE(s,i.length,4+n.length);s.set(i,4+4+n.length);return s}}return e},sendPacket:(e,t,n)=>{if(!n&&e._kexinit!==undefined){if(e._queue===undefined)e._queue=[];e._queue.push(t);e._debug&&e._debug("Outbound: ... packet queued");return false}e._cipher.encrypt(t);return true}}},736:(e,t,n)=>{"use strict";const{kMaxLength:r}=n(300);const{createInflate:i,constants:{DEFLATE:s,INFLATE:o,Z_DEFAULT_CHUNK:f,Z_DEFAULT_COMPRESSION:h,Z_DEFAULT_MEMLEVEL:u,Z_DEFAULT_STRATEGY:l,Z_DEFAULT_WINDOWBITS:g,Z_PARTIAL_FLUSH:p}}=n(796);const _=i()._handle.constructor;function processCallback(){throw new Error("Should not get here")}function zlibOnError(e,t,n){const r=this._owner;const i=new Error(e);i.errno=t;i.code=n;r._err=i}function _close(e){if(!e._handle)return;e._handle.close();e._handle=null}class Zlib{constructor(e){const t=g;const n=h;const i=u;const s=l;const o=undefined;this._err=undefined;this._writeState=new Uint32Array(2);this._chunkSize=f;this._maxOutputLength=r;this._outBuffer=Buffer.allocUnsafe(this._chunkSize);this._outOffset=0;this._handle=new _(e);this._handle._owner=this;this._handle.onerror=zlibOnError;this._handle.init(t,n,i,s,this._writeState,processCallback,o)}writeSync(e,t){const n=this._handle;if(!n)throw new Error("Invalid Zlib instance");let r=e.length;let i=this._chunkSize-this._outOffset;let s=0;let o;let f;let h;let u=0;const l=this._writeState;let g=this._outBuffer;let _=this._outOffset;const E=this._chunkSize;while(true){n.writeSync(p,e,s,r,g,_,i);if(this._err)throw this._err;o=l[0];f=l[1];const t=r-f;const y=i-o;if(y>0){const e=_===0&&y===g.length?g:g.slice(_,_+y);_+=y;if(!h)h=e;else if(h.push===undefined)h=[h,e];else h.push(e);u+=e.byteLength;if(u>this._maxOutputLength){_close(this);throw new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}}else if(y!==0){throw new Error("have should not go down")}if(o===0||_>=E){i=E;_=0;g=Buffer.allocUnsafe(E)}if(o===0){s+=t;r=f}else{break}}this._outBuffer=g;this._outOffset=_;if(u===0)h=Buffer.alloc(0);if(t){h.totalLen=u;return h}if(h.push===undefined)return h;const y=Buffer.allocUnsafe(u);for(let e=0,t=0;e<h.length;++e){const n=h[e];y.set(n,t);t+=n.length}return y}}class ZlibPacketWriter{constructor(e){this.allocStart=0;this.allocStartKEX=0;this._protocol=e;this._zlib=new Zlib(s)}cleanup(){if(this._zlib)_close(this._zlib)}alloc(e,t){return Buffer.allocUnsafe(e)}finalize(e,t){if(this._protocol._kexinit===undefined||t){const t=this._zlib.writeSync(e,true);const n=this._protocol._cipher.allocPacket(t.totalLen);if(t.push===undefined){n.set(t,5)}else{for(let e=0,r=5;e<t.length;++e){const i=t[e];n.set(i,r);r+=i.length}}return n}return e}}class PacketWriter{constructor(e){this.allocStart=5;this.allocStartKEX=5;this._protocol=e}cleanup(){}alloc(e,t){if(this._protocol._kexinit===undefined||t)return this._protocol._cipher.allocPacket(e);return Buffer.allocUnsafe(e)}finalize(e,t){return e}}class ZlibPacketReader{constructor(){this._zlib=new Zlib(o)}cleanup(){if(this._zlib)_close(this._zlib)}read(e){return this._zlib.writeSync(e,false)}}class PacketReader{cleanup(){}read(e){return e}}e.exports={PacketReader:PacketReader,PacketWriter:PacketWriter,ZlibPacketReader:ZlibPacketReader,ZlibPacketWriter:ZlibPacketWriter}},120:(e,t,n)=>{"use strict";const{Server:r}=n(808);const i=n(361);const{listenerCount:s}=i;const{CHANNEL_OPEN_FAILURE:o,DEFAULT_CIPHER:f,DEFAULT_COMPRESSION:h,DEFAULT_KEX:u,DEFAULT_MAC:l,DEFAULT_SERVER_HOST_KEY:g,DISCONNECT_REASON:p,DISCONNECT_REASON_BY_VALUE:_,SUPPORTED_CIPHER:E,SUPPORTED_COMPRESSION:y,SUPPORTED_KEX:I,SUPPORTED_MAC:b,SUPPORTED_SERVER_HOST_KEY:w}=n(480);const{init:m}=n(92);const{KexInit:C}=n(494);const{parseKey:B}=n(613);const k=n(664);const{SFTP:R}=n(593);const{writeUInt32BE:v}=n(775);const{Channel:T,MAX_WINDOW:U,PACKET_SIZE:P,windowAdjust:O,WINDOW_THRESHOLD:L}=n(466);const{ChannelManager:D,generateAlgorithmList:Q,isWritable:x,onChannelOpenFailure:W,onCHANNEL_CLOSE:q}=n(996);const G=10;class AuthContext extends i{constructor(e,t,n,r,i){super();this.username=this.user=t;this.service=n;this.method=r;this._initialResponse=false;this._finalResponse=false;this._multistep=false;this._cbfinal=(e,t,n)=>{if(!this._finalResponse){this._finalResponse=true;i(this,e,t,n)}};this._protocol=e}accept(){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(true)}reject(e,t){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(false,e,t)}}class KeyboardAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this._multistep=true;this._cb=undefined;this._onInfoResponse=e=>{const t=this._cb;if(t){this._cb=undefined;t(e)}};this.submethods=i;this.on("abort",(()=>{this._cb&&this._cb(new Error("Authentication request aborted"))}))}prompt(e,t,n,r){if(!Array.isArray(e))e=[e];if(typeof t==="function"){r=t;t=n=undefined}else if(typeof n==="function"){r=n;n=undefined}else if(typeof r!=="function"){r=undefined}for(let t=0;t<e.length;++t){if(typeof e[t]==="string"){e[t]={prompt:e[t],echo:true}}}this._cb=r;this._initialResponse=true;this._protocol.authInfoReq(t,n,e)}}class PKAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.key={algo:i.keyAlgo,data:i.key};this.hashAlgo=i.hashAlgo;this.signature=i.signature;this.blob=i.blob}accept(){if(!this.signature){this._initialResponse=true;this._protocol.authPKOK(this.key.algo,this.key.data)}else{AuthContext.prototype.accept.call(this)}}}class HostbasedAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.key={algo:i.keyAlgo,data:i.key};this.hashAlgo=i.hashAlgo;this.signature=i.signature;this.blob=i.blob;this.localHostname=i.localHostname;this.localUsername=i.localUsername}}class PwdAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.password=i;this._changeCb=undefined}requestChange(e,t){if(this._changeCb)throw new Error("Change request already in progress");if(typeof e!=="string")throw new Error("prompt argument must be a string");if(typeof t!=="function")throw new Error("Callback argument must be a function");this._changeCb=t;this._protocol.authPasswdChg(e)}}class Session extends i{constructor(e,t,n){super();this.type="session";this.subtype=undefined;this.server=true;this._ending=false;this._channel=undefined;this._chanInfo={type:"session",incoming:{id:n,window:U,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}}}}class Server extends i{constructor(e,t){super();if(typeof e!=="object"||e===null)throw new Error("Missing configuration object");const n=Object.create(null);const i=[];const s=e.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");const o=typeof e.algorithms==="object"&&e.algorithms!==null?e.algorithms:{};const p=Q(o.serverHostKey,g,w);for(let e=0;e<s.length;++e){let t;if(Buffer.isBuffer(s[e])||typeof s[e]==="string")t=B(s[e]);else t=B(s[e].key,s[e].passphrase);if(t instanceof Error)throw new Error(`Cannot parse privateKey: ${t.message}`);if(Array.isArray(t)){t=t[0]}if(t.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(i.includes(t.type))continue;if(t.type==="ssh-rsa"){let e=p.indexOf("ssh-rsa");const r=p.indexOf("rsa-sha2-256");const s=p.indexOf("rsa-sha2-512");if(e===-1){e=Infinity}[e,r,s].sort(compareNumbers).forEach((o=>{if(o===-1)return;let f;switch(o){case e:f="ssh-rsa";break;case r:f="rsa-sha2-256";break;case s:f="rsa-sha2-512";break;default:return}n[f]=t;i.push(f)}))}else{n[t.type]=t;i.push(t.type)}}const _={kex:Q(o.kex,u,I).concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:i,cs:{cipher:Q(o.cipher,f,E),mac:Q(o.hmac,l,b),compress:Q(o.compress,h,y),lang:[]},sc:undefined};_.sc=_.cs;if(typeof t==="function")this.on("connection",t);const m=typeof e.debug==="function"?e.debug:undefined;const k=e.ident?Buffer.from(e.ident):undefined;const R=new C(_);this._srv=new r((t=>{if(this._connections>=this.maxConnections){t.destroy();return}++this._connections;t.once("close",(()=>{--this._connections}));let r;if(m){const e=`[${process.hrtime().join(".")}] `;r=t=>{m(`${e}${t}`)}}new Client(t,n,k,R,r,this,e)})).on("error",(e=>{this.emit("error",e)})).on("listening",(()=>{this.emit("listening")})).on("close",(()=>{this.emit("close")}));this._connections=0;this.maxConnections=Infinity}injectSocket(e){this._srv.emit("connection",e)}listen(...e){this._srv.listen(...e);return this}address(){return this._srv.address()}getConnections(e){this._srv.getConnections(e);return this}close(e){this._srv.close(e);return this}ref(){this._srv.ref();return this}unref(){this._srv.unref();return this}}Server.KEEPALIVE_CLIENT_INTERVAL=15e3;Server.KEEPALIVE_CLIENT_COUNT_MAX=3;class Client extends i{constructor(e,t,n,r,i,f,h){super();let u=0;let l=false;let g=[];let E;let y;let I;const b=[];this._sock=e;this._chanMgr=new D(this);this._debug=i;this.noMoreSessions=false;this.authenticated=false;function onClientPreHeaderError(e){}this.on("error",onClientPreHeaderError);const w=!i?undefined:(e,t,n)=>{i(`Debug output from client: ${JSON.stringify(n)}`)};const C=typeof h.keepaliveInterval==="number"&&isFinite(h.keepaliveInterval)&&h.keepaliveInterval>0?h.keepaliveInterval:typeof Server.KEEPALIVE_CLIENT_INTERVAL==="number"&&isFinite(Server.KEEPALIVE_CLIENT_INTERVAL)&&Server.KEEPALIVE_CLIENT_INTERVAL>0?Server.KEEPALIVE_CLIENT_INTERVAL:-1;const B=typeof h.keepaliveCountMax==="number"&&isFinite(h.keepaliveCountMax)&&h.keepaliveCountMax>=0?h.keepaliveCountMax:typeof Server.KEEPALIVE_CLIENT_COUNT_MAX==="number"&&isFinite(Server.KEEPALIVE_CLIENT_COUNT_MAX)&&Server.KEEPALIVE_CLIENT_COUNT_MAX>=0?Server.KEEPALIVE_CLIENT_COUNT_MAX:-1;let Q=0;if(C!==-1&&B!==-1){this.once("ready",(()=>{const onClose=()=>{clearInterval(y)};this.on("close",onClose).on("end",onClose);y=setInterval((()=>{if(++Q>B){clearInterval(y);const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);this.end()}else{$.ping()}}),C)}));I=()=>{y&&y.refresh();Q=0}}const $=this._protocol=new k({server:true,hostKeys:t,ident:n,offer:r,onPacket:I,greeting:h.greeting,banner:h.banner,onWrite:t=>{if(x(e))e.write(t)},onError:t=>{if(!$._destruct)e.removeAllListeners("data");this.emit("error",t);try{e.end()}catch{}},onHeader:t=>{this.removeListener("error",onClientPreHeaderError);const n={ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:t};if(!f.emit("connection",this,n)){$.disconnect(p.BY_APPLICATION);e.end();return}if(t.greeting)this.emit("greeting",t.greeting)},onHandshakeComplete:e=>{if(++u>1)this.emit("rekey");this.emit("handshake",e)},debug:i,messageHandlers:{DEBUG:w,DISCONNECT:(t,n,r)=>{if(n!==p.BY_APPLICATION){if(!r){r=_[n];if(r===undefined)r=`Unexpected disconnection reason: ${n}`}const e=new Error(r);e.code=n;this.emit("error",e)}e.end()},CHANNEL_OPEN:(e,t)=>{if(t.type==="session"&&this.noMoreSessions||!this.authenticated){const e=o.ADMINISTRATIVELY_PROHIBITED;return $.channelOpenFail(t.sender,e)}let n=-1;let r;let f=false;let h;const reject=()=>{if(f)return;f=true;if(r===undefined){if(n===-1)r=o.RESOURCE_SHORTAGE;else r=o.CONNECT_FAILED}if(n!==-1)this._chanMgr.remove(n);$.channelOpenFail(t.sender,r,"")};const reserveChannel=()=>{n=this._chanMgr.add();if(n===-1){r=o.RESOURCE_SHORTAGE;if(i){i("Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const u=t.data;switch(t.type){case"session":if(s(this,"session")&&reserveChannel()){h=()=>{if(f)return;f=true;const e=new Session(this,t,n);this._chanMgr.update(n,e);$.channelOpenConfirm(t.sender,n,U,P);return e};this.emit("session",h,reject);return}break;case"direct-tcpip":if(s(this,"tcpip")&&reserveChannel()){h=()=>{if(f)return;f=true;const e={type:undefined,incoming:{id:n,window:U,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const r=new T(this,e,{server:true});this._chanMgr.update(n,r);$.channelOpenConfirm(t.sender,n,U,P);return r};this.emit("tcpip",h,reject,u);return}break;case"direct-streamlocal@openssh.com":if(s(this,"openssh.streamlocal")&&reserveChannel()){h=()=>{if(f)return;f=true;const e={type:undefined,incoming:{id:n,window:U,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const r=new T(this,e,{server:true});this._chanMgr.update(n,r);$.channelOpenConfirm(t.sender,n,U,P);return r};this.emit("openssh.streamlocal",h,reject,u);return}break;default:r=o.UNKNOWN_CHANNEL_TYPE;if(i){i("Automatic rejection of unsupported incoming channel open"+` type: ${t.type}`)}}if(r===undefined){r=o.ADMINISTRATIVELY_PROHIBITED;if(i){i("Automatic rejection of unexpected incoming channel open"+` for: ${t.type}`)}}reject()},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const r={type:n.type,incoming:{id:t.recipient,window:U,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new T(this,r,{server:true});this._chanMgr.update(t.recipient,i);n(undefined,i)},CHANNEL_OPEN_FAILURE:(e,t,n,r)=>{const i=this._chanMgr.get(t);if(typeof i!=="function")return;const s={reason:n,description:r};W(this,t,s,i)},CHANNEL_DATA:(e,t,n)=>{let r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.constructor===Session){r=r._channel;if(!r)return}if(r.incoming.window===0)return;r.incoming.window-=n.length;if(r.push(n)===false){r._waitChanDrain=true;return}if(r.incoming.window<=L)O(r)},CHANNEL_EXTENDED_DATA:(e,t,n,r)=>{},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{let r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.constructor===Session){r=r._channel;if(!r)return}r.outgoing.window+=n;if(r._waitWindow){r._waitWindow=false;if(r._chunk){r._write(r._chunk,null,r._chunkcb)}else if(r._chunkcb){r._chunkcb()}else if(r._chunkErr){r.stderr._write(r._chunkErr,null,r._chunkcbErr)}else if(r._chunkcbErr){r._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,r,o)=>{const f=this._chanMgr.get(t);if(typeof f!=="object"||f===null)return;let h=false;let u;let l;if(f.constructor!==Session){if(r)$.channelFailure(f.outgoing.id);return}if(r){if(n!=="shell"&&n!=="exec"&&n!=="subsystem"){u=()=>{if(h||f._ending||f._channel)return;h=true;$.channelSuccess(f._chanInfo.outgoing.id)}}l=()=>{if(h||f._ending||f._channel)return;h=true;$.channelFailure(f._chanInfo.outgoing.id)}}if(f._ending){l&&l();return}switch(n){case"env":if(s(f,"env")){f.emit("env",u,l,{key:o.name,val:o.value});return}break;case"pty-req":if(s(f,"pty")){f.emit("pty",u,l,o);return}break;case"window-change":if(s(f,"window-change"))f.emit("window-change",u,l,o);else l&&l();break;case"x11-req":if(s(f,"x11")){f.emit("x11",u,l,o);return}break;case"signal":if(s(f,"signal")){f.emit("signal",u,l,{name:o});return}break;case"auth-agent-req@openssh.com":if(s(f,"auth-agent")){f.emit("auth-agent",u,l);return}break;case"shell":if(s(f,"shell")){u=()=>{if(h||f._ending||f._channel)return;h=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);const e=new T(this,f._chanInfo,{server:true});e.subtype=f.subtype=n;f._channel=e;return e};f.emit("shell",u,l);return}break;case"exec":if(s(f,"exec")){u=()=>{if(h||f._ending||f._channel)return;h=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);const e=new T(this,f._chanInfo,{server:true});e.subtype=f.subtype=n;f._channel=e;return e};f.emit("exec",u,l,{command:o});return}break;case"subsystem":{let e=o==="sftp";u=()=>{if(h||f._ending||f._channel)return;h=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);let t;if(e){t=new R(this,f._chanInfo,{server:true,debug:i})}else{t=new T(this,f._chanInfo,{server:true});t.subtype=f.subtype=`${n}:${o}`}f._channel=t;return t};if(o==="sftp"){if(s(f,"sftp")){f.emit("sftp",u,l);return}e=false}if(s(f,"subsystem")){f.emit("subsystem",u,l,{name:o});return}break}}i&&i(`Automatic rejection of incoming channel request: ${n}`);l&&l()},CHANNEL_EOF:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){if(!n._ending){n._ending=true;n.emit("eof");n.emit("end")}n=n._channel;if(!n)return}if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null)},CHANNEL_CLOSE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n._ending=true;n.emit("close");n=n._channel;if(!n)return}q(this,t,n)},SERVICE_REQUEST:(t,n)=>{if(u===0||l||this.authenticated||n!=="ssh-userauth"){$.disconnect(p.SERVICE_NOT_AVAILABLE);e.end();return}l=true;$.serviceAccept(n)},USERAUTH_REQUEST:(t,n,r,i,o)=>{if(u===0||this.authenticated||E&&(E.username!==n||E.service!==r)||i!=="password"&&i!=="publickey"&&i!=="hostbased"&&i!=="keyboard-interactive"&&i!=="none"||g.length===G){$.disconnect(p.PROTOCOL_ERROR);e.end();return}else if(r!=="ssh-connection"){$.disconnect(p.SERVICE_NOT_AVAILABLE);e.end();return}let f;switch(i){case"keyboard-interactive":f=new KeyboardAuthContext($,n,r,i,o,onAuthDecide);break;case"publickey":f=new PKAuthContext($,n,r,i,o,onAuthDecide);break;case"hostbased":f=new HostbasedAuthContext($,n,r,i,o,onAuthDecide);break;case"password":if(E&&E instanceof PwdAuthContext&&E._changeCb){const e=E._changeCb;E._changeCb=undefined;e(o.newPassword);return}f=new PwdAuthContext($,n,r,i,o,onAuthDecide);break;case"none":f=new AuthContext($,n,r,i,onAuthDecide);break}if(E){if(!E._initialResponse){return g.push(f)}else if(E._multistep&&!E._finalResponse){E._cleanup&&E._cleanup();E.emit("abort")}}E=f;if(s(this,"authentication"))this.emit("authentication",E);else E.reject()},USERAUTH_INFO_RESPONSE:(e,t)=>{if(E&&E instanceof KeyboardAuthContext)E._onInfoResponse(t)},GLOBAL_REQUEST:(e,t,n,r)=>{const i={type:null,buf:null};function setReply(e,t){i.type=e;i.buf=t;sendReplies()}if(n)b.push(i);if((t==="tcpip-forward"||t==="cancel-tcpip-forward"||t==="no-more-sessions@openssh.com"||t==="streamlocal-forward@openssh.com"||t==="cancel-streamlocal-forward@openssh.com")&&s(this,"request")&&this.authenticated){let e;let i;if(n){let n=false;e=e=>{if(n)return;n=true;let i;if(t==="tcpip-forward"&&r.bindPort===0&&typeof e==="number"){i=Buffer.allocUnsafe(4);v(i,e,0)}setReply("SUCCESS",i)};i=()=>{if(n)return;n=true;setReply("FAILURE")}}if(t==="no-more-sessions@openssh.com"){this.noMoreSessions=true;e&&e();return}this.emit("request",e,i,t,r)}else if(n){setReply("FAILURE")}}}});e.pause();m.then((()=>{$.start();e.on("data",(t=>{try{$.parse(t,0,t.length)}catch(t){this.emit("error",t);try{if(x(e))e.end()}catch{}}}));e.resume()})).catch((t=>{this.emit("error",t);try{if(x(e))e.end()}catch{}}));e.on("error",(e=>{e.level="socket";this.emit("error",e)})).once("end",(()=>{i&&i("Socket ended");$.cleanup();this.emit("end")})).once("close",(()=>{i&&i("Socket closed");$.cleanup();this.emit("close");const e=new Error("No response from server");this._chanMgr.cleanup(e)}));const onAuthDecide=(e,t,n,r)=>{if(E===e&&!this.authenticated){if(t){E=undefined;this.authenticated=true;$.authSuccess();g=[];this.emit("ready")}else{$.authFailure(n,r);if(g.length){E=g.pop();if(s(this,"authentication"))this.emit("authentication",E);else E.reject()}}}};function sendReplies(){while(b.length>0&&b[0].type){const e=b.shift();if(e.type==="SUCCESS")$.requestSuccess(e.buf);if(e.type==="FAILURE")$.requestFailure()}}}end(){if(this._sock&&x(this._sock)){this._protocol.disconnect(p.BY_APPLICATION);this._sock.end()}return this}x11(e,t,n){const r={originAddr:e,originPort:t};openChannel(this,"x11",r,n);return this}forwardOut(e,t,n,r,i){const s={boundAddr:e,boundPort:t,remoteAddr:n,remotePort:r};openChannel(this,"forwarded-tcpip",s,i);return this}openssh_forwardOutStreamLocal(e,t){const n={socketPath:e};openChannel(this,"forwarded-streamlocal@openssh.com",n,t);return this}rekey(e){let t;try{this._protocol.rekey()}catch(e){t=e}if(typeof e==="function"){if(t)process.nextTick(e,t);else this.once("rekey",e)}}setNoDelay(e){if(this._sock&&typeof this._sock.setNoDelay==="function")this._sock.setNoDelay(e);return this}}function openChannel(e,t,n,r){const i=U;const s=P;if(typeof n==="function"){r=n;n={}}const wrapper=(e,t)=>{r(e,t)};wrapper.type=t;const o=e._chanMgr.add(wrapper);if(o===-1){r(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":e._protocol.forwardedTcpip(o,i,s,n);break;case"x11":e._protocol.x11(o,i,s,n);break;case"forwarded-streamlocal@openssh.com":e._protocol.openssh_forwardedStreamLocal(o,i,s,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function compareNumbers(e,t){return e-t}e.exports=Server;e.exports.IncomingClient=Client},996:(e,t,n)=>{"use strict";const{SFTP:r}=n(593);const i=2**32-1;function onChannelOpenFailure(e,t,n,r){e._chanMgr.remove(t);if(typeof r!=="function")return;let i;if(n instanceof Error){i=n}else if(typeof n==="object"&&n!==null){i=new Error(`(SSH) Channel open failure: ${n.description}`);i.reason=n.reason}else{i=new Error("(SSH) Channel open failure: server closed channel unexpectedly");i.reason=""}r(i)}function onCHANNEL_CLOSE(e,t,n,i,s){if(typeof n==="function"){onChannelOpenFailure(e,t,i,n);return}if(typeof n!=="object"||n===null)return;if(n.incoming&&n.incoming.state==="closed")return;e._chanMgr.remove(t);if(n.server&&n.constructor.name==="Session")return;n.incoming.state="closed";if(n.readable)n.push(null);if(n.server){if(n.stderr.writable)n.stderr.end()}else if(n.stderr.readable){n.stderr.push(null)}if(n.constructor!==r&&(n.outgoing.state==="open"||n.outgoing.state==="eof")&&!s){n.close()}if(n.outgoing.state==="closing")n.outgoing.state="closed";const o=n._readableState;const f=n._writableState;if(f&&!f.ending&&!f.finished&&!s)n.end();const h=n._callbacks;n._callbacks=[];for(let e=0;e<h.length;++e)h[e](true);if(n.server){if(!n.readable||n.destroyed||o&&o.endEmitted){n.emit("close")}else{n.once("end",(()=>n.emit("close")))}}else{let e;switch(n.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":e=()=>n.emit("close");break;default:{const t=n._exit;e=()=>{if(t.code===null)n.emit("close",t.code,t.signal,t.dump,t.desc);else n.emit("close",t.code)}}}if(!n.readable||n.destroyed||o&&o.endEmitted){e()}else{n.once("end",e)}const t=n.stderr._readableState;if(!n.stderr.readable||n.stderr.destroyed||t&&t.endEmitted){n.stderr.emit("close")}else{n.stderr.once("end",(()=>n.stderr.emit("close")))}}}class ChannelManager{constructor(e){this._client=e;this._channels={};this._cur=-1;this._count=0}add(e){let t;if(this._cur<i){t=++this._cur}else if(this._count===0){this._cur=0;t=0}else{const e=this._channels;for(let n=0;n<i;++n){if(e[n]===undefined){t=n;break}}}if(t===undefined)return-1;this._channels[t]=e||true;++this._count;return t}update(e,t){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(t&&this._channels[e])this._channels[e]=t}get(e){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);return this._channels[e]}remove(e){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(this._channels[e]){delete this._channels[e];if(this._count)--this._count}}cleanup(e){const t=this._channels;this._channels={};this._cur=-1;this._count=0;const n=Object.keys(t);const r=this._client;for(let i=0;i<n.length;++i){const s=+n[i];const o=t[s];onCHANNEL_CLOSE(r,s,o._channel||o,e,true)}}}const s=(()=>{const e=Object.prototype.toString;return t=>e.call(t)==="[object RegExp]"})();function generateAlgorithmList(e,t,n){if(Array.isArray(e)&&e.length>0){for(let t=0;t<e.length;++t){if(n.indexOf(e[t])===-1)throw new Error(`Unsupported algorithm: ${e[t]}`)}return e}if(typeof e==="object"&&e!==null){const r=Object.keys(e);let i=t;for(let o=0;o<r.length;++o){const f=r[o];let h=e[f];switch(f){case"append":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let e=0;e<h.length;++e){const r=h[e];if(typeof r==="string"){if(!r||i.indexOf(r)!==-1)continue;if(n.indexOf(r)===-1)throw new Error(`Unsupported algorithm: ${r}`);if(i===t)i=i.slice();i.push(r)}else if(s(r)){for(let e=0;e<n.length;++e){const s=n[e];if(r.test(s)){if(i.indexOf(s)!==-1)continue;if(i===t)i=i.slice();i.push(s)}}}}}break;case"prepend":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let e=h.length;e>=0;--e){const r=h[e];if(typeof r==="string"){if(!r||i.indexOf(r)!==-1)continue;if(n.indexOf(r)===-1)throw new Error(`Unsupported algorithm: ${r}`);if(i===t)i=i.slice();i.unshift(r)}else if(s(r)){for(let e=n.length;e>=0;--e){const s=n[e];if(r.test(s)){if(i.indexOf(s)!==-1)continue;if(i===t)i=i.slice();i.unshift(s)}}}}}break;case"remove":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let e=0;e<h.length;++e){const n=h[e];if(typeof n==="string"){if(!n)continue;const e=i.indexOf(n);if(e===-1)continue;if(i===t)i=i.slice();i.splice(e,1)}else if(s(n)){for(let e=0;e<i.length;++e){if(n.test(i[e])){if(i===t)i=i.slice();i.splice(e,1);--e}}}}}break}}return i}return t}e.exports={ChannelManager:ChannelManager,generateAlgorithmList:generateAlgorithmList,onChannelOpenFailure:onChannelOpenFailure,onCHANNEL_CLOSE:onCHANNEL_CLOSE,isWritable:e=>e&&e.writable&&e._readableState&&e._readableState.ended===false}},556:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;t.name="InvalidAsn1Error";t.message=e||"";return t}}},804:(e,t,n)=>{var r=n(556);var i=n(810);var s=n(854);var o=n(971);e.exports={Reader:s,Writer:o};for(var f in i){if(i.hasOwnProperty(f))e.exports[f]=i[f]}for(var h in r){if(r.hasOwnProperty(h))e.exports[h]=r[h]}},854:(e,t,n)=>{var r=n(491);var i=n(515).Buffer;var s=n(810);var o=n(556);var f=o.newInvalidAsn1Error;function Reader(e){if(!e||!i.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e;this._size=e.length;this._len=0;this._offset=0}Object.defineProperty(Reader.prototype,"length",{enumerable:true,get:function(){return this._len}});Object.defineProperty(Reader.prototype,"offset",{enumerable:true,get:function(){return this._offset}});Object.defineProperty(Reader.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Reader.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Reader.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;if(!e)this._offset+=1;return t};Reader.prototype.peek=function(){return this.readByte(true)};Reader.prototype.readLength=function(e){if(e===undefined)e=this._offset;if(e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)===128){t&=127;if(t===0)throw f("Indefinite length not supported");if(t>4)throw f("encoding too long");if(this._size-e<t)return null;this._len=0;for(var n=0;n<t;n++)this._len=(this._len<<8)+(this._buf[e++]&255)}else{this._len=t}return e};Reader.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==undefined&&e!==t)throw f("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;this._offset=n;return t};Reader.prototype.readInt=function(){return this._readTag(s.Integer)};Reader.prototype.readBoolean=function(){return this._readTag(s.Boolean)===0?false:true};Reader.prototype.readEnumeration=function(){return this._readTag(s.Enumeration)};Reader.prototype.readString=function(e,t){if(!e)e=s.OctetString;var n=this.peek();if(n===null)return null;if(n!==e)throw f("Expected 0x"+e.toString(16)+": got 0x"+n.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>this._size-r)return null;this._offset=r;if(this.length===0)return t?i.alloc(0):"";var o=this._buf.slice(this._offset,this._offset+this.length);this._offset+=this.length;return t?o:o.toString("utf8")};Reader.prototype.readOID=function(e){if(!e)e=s.OID;var t=this.readString(e,true);if(t===null)return null;var n=[];var r=0;for(var i=0;i<t.length;i++){var o=t[i]&255;r<<=7;r+=o&127;if((o&128)===0){n.push(r);r=0}}r=n.shift();n.unshift(r%40);n.unshift(r/40>>0);return n.join(".")};Reader.prototype._readTag=function(e){r.ok(e!==undefined);var t=this.peek();if(t===null)return null;if(t!==e)throw f("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>4)throw f("Integer too long: "+this.length);if(this.length>this._size-n)return null;this._offset=n;var i=this._buf[this._offset];var s=0;for(var o=0;o<this.length;o++){s<<=8;s|=this._buf[this._offset++]&255}if((i&128)===128&&o!==4)s-=1<<o*8;return s>>0};e.exports=Reader},810:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},971:(e,t,n)=>{var r=n(491);var i=n(515).Buffer;var s=n(810);var o=n(556);var f=o.newInvalidAsn1Error;var h={size:1024,growthFactor:8};function merge(e,t){r.ok(e);r.equal(typeof e,"object");r.ok(t);r.equal(typeof t,"object");var n=Object.getOwnPropertyNames(e);n.forEach((function(n){if(t[n])return;var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r)}));return t}function Writer(e){e=merge(h,e||{});this._buf=i.alloc(e.size||1024);this._size=this._buf.length;this._offset=0;this._options=e;this._seq=[]}Object.defineProperty(Writer.prototype,"buffer",{get:function(){if(this._seq.length)throw f(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Writer.prototype.writeByte=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(1);this._buf[this._offset++]=e};Writer.prototype.writeInt=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=s.Integer;var n=4;while(((e&4286578688)===0||(e&4286578688)===4286578688>>0)&&n>1){n--;e<<=8}if(n>4)throw f("BER ints cannot be > 0xffffffff");this._ensure(2+n);this._buf[this._offset++]=t;this._buf[this._offset++]=n;while(n-- >0){this._buf[this._offset++]=(e&4278190080)>>>24;e<<=8}};Writer.prototype.writeNull=function(){this.writeByte(s.Null);this.writeByte(0)};Writer.prototype.writeEnumeration=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=s.Enumeration;return this.writeInt(e,t)};Writer.prototype.writeBoolean=function(e,t){if(typeof e!=="boolean")throw new TypeError("argument must be a Boolean");if(typeof t!=="number")t=s.Boolean;this._ensure(3);this._buf[this._offset++]=t;this._buf[this._offset++]=1;this._buf[this._offset++]=e?255:0};Writer.prototype.writeString=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string (was: "+typeof e+")");if(typeof t!=="number")t=s.OctetString;var n=i.byteLength(e);this.writeByte(t);this.writeLength(n);if(n){this._ensure(n);this._buf.write(e,this._offset);this._offset+=n}};Writer.prototype.writeBuffer=function(e,t){if(typeof t!=="number")throw new TypeError("tag must be a number");if(!i.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t);this.writeLength(e.length);this._ensure(e.length);e.copy(this._buf,this._offset,0,e.length);this._offset+=e.length};Writer.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))};Writer.prototype.writeOID=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string");if(typeof t!=="number")t=s.OID;if(!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");function encodeOctet(e,t){if(t<128){e.push(t)}else if(t<16384){e.push(t>>>7|128);e.push(t&127)}else if(t<2097152){e.push(t>>>14|128);e.push((t>>>7|128)&255);e.push(t&127)}else if(t<268435456){e.push(t>>>21|128);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}else{e.push((t>>>28|128)&255);e.push((t>>>21|128)&255);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}}var n=e.split(".");var r=[];r.push(parseInt(n[0],10)*40+parseInt(n[1],10));n.slice(2).forEach((function(e){encodeOctet(r,parseInt(e,10))}));var i=this;this._ensure(2+r.length);this.writeByte(t);this.writeLength(r.length);r.forEach((function(e){i.writeByte(e)}))};Writer.prototype.writeLength=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(4);if(e<=127){this._buf[this._offset++]=e}else if(e<=255){this._buf[this._offset++]=129;this._buf[this._offset++]=e}else if(e<=65535){this._buf[this._offset++]=130;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else if(e<=16777215){this._buf[this._offset++]=131;this._buf[this._offset++]=e>>16;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else{throw f("Length too long (> 4 bytes)")}};Writer.prototype.startSequence=function(e){if(typeof e!=="number")e=s.Sequence|s.Constructor;this.writeByte(e);this._seq.push(this._offset);this._ensure(3);this._offset+=3};Writer.prototype.endSequence=function(){var e=this._seq.pop();var t=e+3;var n=this._offset-t;if(n<=127){this._shift(t,n,-2);this._buf[e]=n}else if(n<=255){this._shift(t,n,-1);this._buf[e]=129;this._buf[e+1]=n}else if(n<=65535){this._buf[e]=130;this._buf[e+1]=n>>8;this._buf[e+2]=n}else if(n<=16777215){this._shift(t,n,1);this._buf[e]=131;this._buf[e+1]=n>>16;this._buf[e+2]=n>>8;this._buf[e+3]=n}else{throw f("Sequence too long")}};Writer.prototype._shift=function(e,t,n){r.ok(e!==undefined);r.ok(t!==undefined);r.ok(n);this._buf.copy(this._buf,e+n,e,e+t);this._offset+=n};Writer.prototype._ensure=function(e){r.ok(e);if(this._size-this._offset<e){var t=this._size*this._options.growthFactor;if(t-this._offset<e)t+=e;var n=i.alloc(t);this._buf.copy(n,0,0,this._offset);this._buf=n;this._size=t}};e.exports=Writer},680:(e,t,n)=>{var r=n(804);e.exports={Ber:r,BerReader:r.Reader,BerWriter:r.Writer}},583:(e,t,n)=>{"use strict";var r=n(328).lowlevel.crypto_hash;var i=0;var Blowfish=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])];this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function F(e,t,n){return(e[0][t[n+3]]+e[1][t[n+2]]^e[2][t[n+1]])+e[3][t[n]]}Blowfish.prototype.encipher=function(e,t){if(t===undefined){t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset)}e[0]^=this.P[0];for(var n=1;n<16;n+=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n+1]}var r=e[0];e[0]=e[1]^this.P[17];e[1]=r};Blowfish.prototype.decipher=function(e){var t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset);e[0]^=this.P[17];for(var n=16;n>0;n-=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n-1]}var r=e[0];e[0]=e[1]^this.P[0];e[1]=r};function stream2word(e,t){var n,r=0;for(n=0;n<4;n++,i++){if(i>=t)i=0;r=r<<8|e[i]}return r}Blowfish.prototype.expand0state=function(e,t){var n=new Uint32Array(2),r,s;var o=new Uint8Array(n.buffer);for(r=0,i=0;r<18;r++){this.P[r]^=stream2word(e,t)}i=0;for(r=0;r<18;r+=2){this.encipher(n,o);this.P[r]=n[0];this.P[r+1]=n[1]}for(r=0;r<4;r++){for(s=0;s<256;s+=2){this.encipher(n,o);this.S[r][s]=n[0];this.S[r][s+1]=n[1]}}};Blowfish.prototype.expandstate=function(e,t,n,r){var s=new Uint32Array(2),o,f;for(o=0,i=0;o<18;o++){this.P[o]^=stream2word(n,r)}for(o=0,i=0;o<18;o+=2){s[0]^=stream2word(e,t);s[1]^=stream2word(e,t);this.encipher(s);this.P[o]=s[0];this.P[o+1]=s[1]}for(o=0;o<4;o++){for(f=0;f<256;f+=2){s[0]^=stream2word(e,t);s[1]^=stream2word(e,t);this.encipher(s);this.S[o][f]=s[0];this.S[o][f+1]=s[1]}}i=0};Blowfish.prototype.enc=function(e,t){for(var n=0;n<t;n++){this.encipher(e.subarray(n*2))}};Blowfish.prototype.dec=function(e,t){for(var n=0;n<t;n++){this.decipher(e.subarray(n*2))}};var s=8,o=32;function bcrypt_hash(e,t,n){var r=new Blowfish,i=new Uint32Array(s),o,f=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);r.expandstate(t,64,e,64);for(o=0;o<64;o++){r.expand0state(t,64);r.expand0state(e,64)}for(o=0;o<s;o++)i[o]=stream2word(f,f.byteLength);for(o=0;o<64;o++)r.enc(i,i.byteLength/8);for(o=0;o<s;o++){n[4*o+3]=i[o]>>>24;n[4*o+2]=i[o]>>>16;n[4*o+1]=i[o]>>>8;n[4*o+0]=i[o]}}function bcrypt_pbkdf(e,t,n,i,s,f,h){var u=new Uint8Array(64),l=new Uint8Array(64),g=new Uint8Array(o),p=new Uint8Array(o),_=new Uint8Array(i+4),E,y,I,b,w,m,C=f;if(h<1)return-1;if(t===0||i===0||f===0||f>g.byteLength*g.byteLength||i>1<<20)return-1;b=Math.floor((f+g.byteLength-1)/g.byteLength);I=Math.floor((f+b-1)/b);for(E=0;E<i;E++)_[E]=n[E];r(u,e,t);for(m=1;f>0;m++){_[i+0]=m>>>24;_[i+1]=m>>>16;_[i+2]=m>>>8;_[i+3]=m;r(l,_,i+4);bcrypt_hash(u,l,p);for(E=g.byteLength;E--;)g[E]=p[E];for(E=1;E<h;E++){r(l,p,p.byteLength);bcrypt_hash(u,l,p);for(y=0;y<g.byteLength;y++)g[y]^=p[y]}I=Math.min(I,f);for(E=0;E<I;E++){w=E*b+(m-1);if(w>=C)break;s[w]=g[E]}f-=E}return 0}e.exports={BLOCKS:s,HASHSIZE:o,hash:bcrypt_hash,pbkdf:bcrypt_pbkdf}},515:(e,t,n)=>{"use strict";var r=n(300);var i=r.Buffer;var s={};var o;for(o in r){if(!r.hasOwnProperty(o))continue;if(o==="SlowBuffer"||o==="Buffer")continue;s[o]=r[o]}var f=s.Buffer={};for(o in i){if(!i.hasOwnProperty(o))continue;if(o==="allocUnsafe"||o==="allocUnsafeSlow")continue;f[o]=i[o]}s.Buffer.prototype=i.prototype;if(!f.from||f.from===Uint8Array.from){f.from=function(e,t,n){if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e)}if(e&&typeof e.length==="undefined"){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}return i(e,t,n)}}if(!f.alloc){f.alloc=function(e,t,n){if(typeof e!=="number"){throw new TypeError('The "size" argument must be of type number. Received type '+typeof e)}if(e<0||e>=2*(1<<30)){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var r=i(e);if(!t||t.length===0){r.fill(0)}else if(typeof n==="string"){r.fill(t,n)}else{r.fill(t)}return r}}if(!s.kStringMaxLength){try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}}if(!s.constants){s.constants={MAX_LENGTH:s.kMaxLength};if(s.kStringMaxLength){s.constants.MAX_STRING_LENGTH=s.kStringMaxLength}}e.exports=s},328:(e,t,n)=>{(function(e){"use strict";var gf=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n};var randombytes=function(){throw new Error("no PRNG")};var t=new Uint8Array(16);var r=new Uint8Array(32);r[0]=9;var i=gf(),s=gf([1]),o=gf([56129,1]),f=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(e,t,n,r){e[t]=n>>24&255;e[t+1]=n>>16&255;e[t+2]=n>>8&255;e[t+3]=n&255;e[t+4]=r>>24&255;e[t+5]=r>>16&255;e[t+6]=r>>8&255;e[t+7]=r&255}function vn(e,t,n,r,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^n[r+s];return(1&o-1>>>8)-1}function crypto_verify_16(e,t,n,r){return vn(e,t,n,r,16)}function crypto_verify_32(e,t,n,r){return vn(e,t,n,r,32)}function core_salsa20(e,t,n,r){var i=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,o=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,f=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,h=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,u=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,l=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,g=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,p=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,_=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,E=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,I=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,b=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,w=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,m=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24;var C=i,B=s,k=o,R=f,v=h,T=u,U=l,P=g,O=p,L=_,D=E,Q=y,x=I,W=b,q=w,G=m,$;for(var Y=0;Y<20;Y+=2){$=C+x|0;v^=$<<7|$>>>32-7;$=v+C|0;O^=$<<9|$>>>32-9;$=O+v|0;x^=$<<13|$>>>32-13;$=x+O|0;C^=$<<18|$>>>32-18;$=T+B|0;L^=$<<7|$>>>32-7;$=L+T|0;W^=$<<9|$>>>32-9;$=W+L|0;B^=$<<13|$>>>32-13;$=B+W|0;T^=$<<18|$>>>32-18;$=D+U|0;q^=$<<7|$>>>32-7;$=q+D|0;k^=$<<9|$>>>32-9;$=k+q|0;U^=$<<13|$>>>32-13;$=U+k|0;D^=$<<18|$>>>32-18;$=G+Q|0;R^=$<<7|$>>>32-7;$=R+G|0;P^=$<<9|$>>>32-9;$=P+R|0;Q^=$<<13|$>>>32-13;$=Q+P|0;G^=$<<18|$>>>32-18;$=C+R|0;B^=$<<7|$>>>32-7;$=B+C|0;k^=$<<9|$>>>32-9;$=k+B|0;R^=$<<13|$>>>32-13;$=R+k|0;C^=$<<18|$>>>32-18;$=T+v|0;U^=$<<7|$>>>32-7;$=U+T|0;P^=$<<9|$>>>32-9;$=P+U|0;v^=$<<13|$>>>32-13;$=v+P|0;T^=$<<18|$>>>32-18;$=D+L|0;Q^=$<<7|$>>>32-7;$=Q+D|0;O^=$<<9|$>>>32-9;$=O+Q|0;L^=$<<13|$>>>32-13;$=L+O|0;D^=$<<18|$>>>32-18;$=G+q|0;x^=$<<7|$>>>32-7;$=x+G|0;W^=$<<9|$>>>32-9;$=W+x|0;q^=$<<13|$>>>32-13;$=q+W|0;G^=$<<18|$>>>32-18}C=C+i|0;B=B+s|0;k=k+o|0;R=R+f|0;v=v+h|0;T=T+u|0;U=U+l|0;P=P+g|0;O=O+p|0;L=L+_|0;D=D+E|0;Q=Q+y|0;x=x+I|0;W=W+b|0;q=q+w|0;G=G+m|0;e[0]=C>>>0&255;e[1]=C>>>8&255;e[2]=C>>>16&255;e[3]=C>>>24&255;e[4]=B>>>0&255;e[5]=B>>>8&255;e[6]=B>>>16&255;e[7]=B>>>24&255;e[8]=k>>>0&255;e[9]=k>>>8&255;e[10]=k>>>16&255;e[11]=k>>>24&255;e[12]=R>>>0&255;e[13]=R>>>8&255;e[14]=R>>>16&255;e[15]=R>>>24&255;e[16]=v>>>0&255;e[17]=v>>>8&255;e[18]=v>>>16&255;e[19]=v>>>24&255;e[20]=T>>>0&255;e[21]=T>>>8&255;e[22]=T>>>16&255;e[23]=T>>>24&255;e[24]=U>>>0&255;e[25]=U>>>8&255;e[26]=U>>>16&255;e[27]=U>>>24&255;e[28]=P>>>0&255;e[29]=P>>>8&255;e[30]=P>>>16&255;e[31]=P>>>24&255;e[32]=O>>>0&255;e[33]=O>>>8&255;e[34]=O>>>16&255;e[35]=O>>>24&255;e[36]=L>>>0&255;e[37]=L>>>8&255;e[38]=L>>>16&255;e[39]=L>>>24&255;e[40]=D>>>0&255;e[41]=D>>>8&255;e[42]=D>>>16&255;e[43]=D>>>24&255;e[44]=Q>>>0&255;e[45]=Q>>>8&255;e[46]=Q>>>16&255;e[47]=Q>>>24&255;e[48]=x>>>0&255;e[49]=x>>>8&255;e[50]=x>>>16&255;e[51]=x>>>24&255;e[52]=W>>>0&255;e[53]=W>>>8&255;e[54]=W>>>16&255;e[55]=W>>>24&255;e[56]=q>>>0&255;e[57]=q>>>8&255;e[58]=q>>>16&255;e[59]=q>>>24&255;e[60]=G>>>0&255;e[61]=G>>>8&255;e[62]=G>>>16&255;e[63]=G>>>24&255}function core_hsalsa20(e,t,n,r){var i=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,o=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,f=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,h=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,u=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,l=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,g=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,p=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,_=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,E=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,I=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,b=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,w=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,m=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24;var C=i,B=s,k=o,R=f,v=h,T=u,U=l,P=g,O=p,L=_,D=E,Q=y,x=I,W=b,q=w,G=m,$;for(var Y=0;Y<20;Y+=2){$=C+x|0;v^=$<<7|$>>>32-7;$=v+C|0;O^=$<<9|$>>>32-9;$=O+v|0;x^=$<<13|$>>>32-13;$=x+O|0;C^=$<<18|$>>>32-18;$=T+B|0;L^=$<<7|$>>>32-7;$=L+T|0;W^=$<<9|$>>>32-9;$=W+L|0;B^=$<<13|$>>>32-13;$=B+W|0;T^=$<<18|$>>>32-18;$=D+U|0;q^=$<<7|$>>>32-7;$=q+D|0;k^=$<<9|$>>>32-9;$=k+q|0;U^=$<<13|$>>>32-13;$=U+k|0;D^=$<<18|$>>>32-18;$=G+Q|0;R^=$<<7|$>>>32-7;$=R+G|0;P^=$<<9|$>>>32-9;$=P+R|0;Q^=$<<13|$>>>32-13;$=Q+P|0;G^=$<<18|$>>>32-18;$=C+R|0;B^=$<<7|$>>>32-7;$=B+C|0;k^=$<<9|$>>>32-9;$=k+B|0;R^=$<<13|$>>>32-13;$=R+k|0;C^=$<<18|$>>>32-18;$=T+v|0;U^=$<<7|$>>>32-7;$=U+T|0;P^=$<<9|$>>>32-9;$=P+U|0;v^=$<<13|$>>>32-13;$=v+P|0;T^=$<<18|$>>>32-18;$=D+L|0;Q^=$<<7|$>>>32-7;$=Q+D|0;O^=$<<9|$>>>32-9;$=O+Q|0;L^=$<<13|$>>>32-13;$=L+O|0;D^=$<<18|$>>>32-18;$=G+q|0;x^=$<<7|$>>>32-7;$=x+G|0;W^=$<<9|$>>>32-9;$=W+x|0;q^=$<<13|$>>>32-13;$=q+W|0;G^=$<<18|$>>>32-18}e[0]=C>>>0&255;e[1]=C>>>8&255;e[2]=C>>>16&255;e[3]=C>>>24&255;e[4]=T>>>0&255;e[5]=T>>>8&255;e[6]=T>>>16&255;e[7]=T>>>24&255;e[8]=D>>>0&255;e[9]=D>>>8&255;e[10]=D>>>16&255;e[11]=D>>>24&255;e[12]=G>>>0&255;e[13]=G>>>8&255;e[14]=G>>>16&255;e[15]=G>>>24&255;e[16]=U>>>0&255;e[17]=U>>>8&255;e[18]=U>>>16&255;e[19]=U>>>24&255;e[20]=P>>>0&255;e[21]=P>>>8&255;e[22]=P>>>16&255;e[23]=P>>>24&255;e[24]=O>>>0&255;e[25]=O>>>8&255;e[26]=O>>>16&255;e[27]=O>>>24&255;e[28]=L>>>0&255;e[29]=L>>>8&255;e[30]=L>>>16&255;e[31]=L>>>24&255}function crypto_core_salsa20(e,t,n,r){core_salsa20(e,t,n,r)}function crypto_core_hsalsa20(e,t,n,r){core_hsalsa20(e,t,n,r)}var p=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(e,t,n,r,i,s,o){var f=new Uint8Array(16),h=new Uint8Array(64);var u,l;for(l=0;l<16;l++)f[l]=0;for(l=0;l<8;l++)f[l]=s[l];while(i>=64){crypto_core_salsa20(h,f,o,p);for(l=0;l<64;l++)e[t+l]=n[r+l]^h[l];u=1;for(l=8;l<16;l++){u=u+(f[l]&255)|0;f[l]=u&255;u>>>=8}i-=64;t+=64;r+=64}if(i>0){crypto_core_salsa20(h,f,o,p);for(l=0;l<i;l++)e[t+l]=n[r+l]^h[l]}return 0}function crypto_stream_salsa20(e,t,n,r,i){var s=new Uint8Array(16),o=new Uint8Array(64);var f,h;for(h=0;h<16;h++)s[h]=0;for(h=0;h<8;h++)s[h]=r[h];while(n>=64){crypto_core_salsa20(o,s,i,p);for(h=0;h<64;h++)e[t+h]=o[h];f=1;for(h=8;h<16;h++){f=f+(s[h]&255)|0;s[h]=f&255;f>>>=8}n-=64;t+=64}if(n>0){crypto_core_salsa20(o,s,i,p);for(h=0;h<n;h++)e[t+h]=o[h]}return 0}function crypto_stream(e,t,n,r,i){var s=new Uint8Array(32);crypto_core_hsalsa20(s,r,i,p);var o=new Uint8Array(8);for(var f=0;f<8;f++)o[f]=r[f+16];return crypto_stream_salsa20(e,t,n,o,s)}function crypto_stream_xor(e,t,n,r,i,s,o){var f=new Uint8Array(32);crypto_core_hsalsa20(f,s,o,p);var h=new Uint8Array(8);for(var u=0;u<8;u++)h[u]=s[u+16];return crypto_stream_salsa20_xor(e,t,n,r,i,h,f)}var poly1305=function(e){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var t,n,r,i,s,o,f,h;t=e[0]&255|(e[1]&255)<<8;this.r[0]=t&8191;n=e[2]&255|(e[3]&255)<<8;this.r[1]=(t>>>13|n<<3)&8191;r=e[4]&255|(e[5]&255)<<8;this.r[2]=(n>>>10|r<<6)&7939;i=e[6]&255|(e[7]&255)<<8;this.r[3]=(r>>>7|i<<9)&8191;s=e[8]&255|(e[9]&255)<<8;this.r[4]=(i>>>4|s<<12)&255;this.r[5]=s>>>1&8190;o=e[10]&255|(e[11]&255)<<8;this.r[6]=(s>>>14|o<<2)&8191;f=e[12]&255|(e[13]&255)<<8;this.r[7]=(o>>>11|f<<5)&8065;h=e[14]&255|(e[15]&255)<<8;this.r[8]=(f>>>8|h<<8)&8191;this.r[9]=h>>>5&127;this.pad[0]=e[16]&255|(e[17]&255)<<8;this.pad[1]=e[18]&255|(e[19]&255)<<8;this.pad[2]=e[20]&255|(e[21]&255)<<8;this.pad[3]=e[22]&255|(e[23]&255)<<8;this.pad[4]=e[24]&255|(e[25]&255)<<8;this.pad[5]=e[26]&255|(e[27]&255)<<8;this.pad[6]=e[28]&255|(e[29]&255)<<8;this.pad[7]=e[30]&255|(e[31]&255)<<8};poly1305.prototype.blocks=function(e,t,n){var r=this.fin?0:1<<11;var i,s,o,f,h,u,l,g,p;var _,E,y,I,b,w,m,C,B,k;var R=this.h[0],v=this.h[1],T=this.h[2],U=this.h[3],P=this.h[4],O=this.h[5],L=this.h[6],D=this.h[7],Q=this.h[8],x=this.h[9];var W=this.r[0],q=this.r[1],G=this.r[2],$=this.r[3],Y=this.r[4],V=this.r[5],j=this.r[6],z=this.r[7],J=this.r[8],ee=this.r[9];while(n>=16){i=e[t+0]&255|(e[t+1]&255)<<8;R+=i&8191;s=e[t+2]&255|(e[t+3]&255)<<8;v+=(i>>>13|s<<3)&8191;o=e[t+4]&255|(e[t+5]&255)<<8;T+=(s>>>10|o<<6)&8191;f=e[t+6]&255|(e[t+7]&255)<<8;U+=(o>>>7|f<<9)&8191;h=e[t+8]&255|(e[t+9]&255)<<8;P+=(f>>>4|h<<12)&8191;O+=h>>>1&8191;u=e[t+10]&255|(e[t+11]&255)<<8;L+=(h>>>14|u<<2)&8191;l=e[t+12]&255|(e[t+13]&255)<<8;D+=(u>>>11|l<<5)&8191;g=e[t+14]&255|(e[t+15]&255)<<8;Q+=(l>>>8|g<<8)&8191;x+=g>>>5|r;p=0;_=p;_+=R*W;_+=v*(5*ee);_+=T*(5*J);_+=U*(5*z);_+=P*(5*j);p=_>>>13;_&=8191;_+=O*(5*V);_+=L*(5*Y);_+=D*(5*$);_+=Q*(5*G);_+=x*(5*q);p+=_>>>13;_&=8191;E=p;E+=R*q;E+=v*W;E+=T*(5*ee);E+=U*(5*J);E+=P*(5*z);p=E>>>13;E&=8191;E+=O*(5*j);E+=L*(5*V);E+=D*(5*Y);E+=Q*(5*$);E+=x*(5*G);p+=E>>>13;E&=8191;y=p;y+=R*G;y+=v*q;y+=T*W;y+=U*(5*ee);y+=P*(5*J);p=y>>>13;y&=8191;y+=O*(5*z);y+=L*(5*j);y+=D*(5*V);y+=Q*(5*Y);y+=x*(5*$);p+=y>>>13;y&=8191;I=p;I+=R*$;I+=v*G;I+=T*q;I+=U*W;I+=P*(5*ee);p=I>>>13;I&=8191;I+=O*(5*J);I+=L*(5*z);I+=D*(5*j);I+=Q*(5*V);I+=x*(5*Y);p+=I>>>13;I&=8191;b=p;b+=R*Y;b+=v*$;b+=T*G;b+=U*q;b+=P*W;p=b>>>13;b&=8191;b+=O*(5*ee);b+=L*(5*J);b+=D*(5*z);b+=Q*(5*j);b+=x*(5*V);p+=b>>>13;b&=8191;w=p;w+=R*V;w+=v*Y;w+=T*$;w+=U*G;w+=P*q;p=w>>>13;w&=8191;w+=O*W;w+=L*(5*ee);w+=D*(5*J);w+=Q*(5*z);w+=x*(5*j);p+=w>>>13;w&=8191;m=p;m+=R*j;m+=v*V;m+=T*Y;m+=U*$;m+=P*G;p=m>>>13;m&=8191;m+=O*q;m+=L*W;m+=D*(5*ee);m+=Q*(5*J);m+=x*(5*z);p+=m>>>13;m&=8191;C=p;C+=R*z;C+=v*j;C+=T*V;C+=U*Y;C+=P*$;p=C>>>13;C&=8191;C+=O*G;C+=L*q;C+=D*W;C+=Q*(5*ee);C+=x*(5*J);p+=C>>>13;C&=8191;B=p;B+=R*J;B+=v*z;B+=T*j;B+=U*V;B+=P*Y;p=B>>>13;B&=8191;B+=O*$;B+=L*G;B+=D*q;B+=Q*W;B+=x*(5*ee);p+=B>>>13;B&=8191;k=p;k+=R*ee;k+=v*J;k+=T*z;k+=U*j;k+=P*V;p=k>>>13;k&=8191;k+=O*Y;k+=L*$;k+=D*G;k+=Q*q;k+=x*W;p+=k>>>13;k&=8191;p=(p<<2)+p|0;p=p+_|0;_=p&8191;p=p>>>13;E+=p;R=_;v=E;T=y;U=I;P=b;O=w;L=m;D=C;Q=B;x=k;t+=16;n-=16}this.h[0]=R;this.h[1]=v;this.h[2]=T;this.h[3]=U;this.h[4]=P;this.h[5]=O;this.h[6]=L;this.h[7]=D;this.h[8]=Q;this.h[9]=x};poly1305.prototype.finish=function(e,t){var n=new Uint16Array(10);var r,i,s,o;if(this.leftover){o=this.leftover;this.buffer[o++]=1;for(;o<16;o++)this.buffer[o]=0;this.fin=1;this.blocks(this.buffer,0,16)}r=this.h[1]>>>13;this.h[1]&=8191;for(o=2;o<10;o++){this.h[o]+=r;r=this.h[o]>>>13;this.h[o]&=8191}this.h[0]+=r*5;r=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=r;r=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=r;n[0]=this.h[0]+5;r=n[0]>>>13;n[0]&=8191;for(o=1;o<10;o++){n[o]=this.h[o]+r;r=n[o]>>>13;n[o]&=8191}n[9]-=1<<13;i=(r^1)-1;for(o=0;o<10;o++)n[o]&=i;i=~i;for(o=0;o<10;o++)this.h[o]=this.h[o]&i|n[o];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;s=this.h[0]+this.pad[0];this.h[0]=s&65535;for(o=1;o<8;o++){s=(this.h[o]+this.pad[o]|0)+(s>>>16)|0;this.h[o]=s&65535}e[t+0]=this.h[0]>>>0&255;e[t+1]=this.h[0]>>>8&255;e[t+2]=this.h[1]>>>0&255;e[t+3]=this.h[1]>>>8&255;e[t+4]=this.h[2]>>>0&255;e[t+5]=this.h[2]>>>8&255;e[t+6]=this.h[3]>>>0&255;e[t+7]=this.h[3]>>>8&255;e[t+8]=this.h[4]>>>0&255;e[t+9]=this.h[4]>>>8&255;e[t+10]=this.h[5]>>>0&255;e[t+11]=this.h[5]>>>8&255;e[t+12]=this.h[6]>>>0&255;e[t+13]=this.h[6]>>>8&255;e[t+14]=this.h[7]>>>0&255;e[t+15]=this.h[7]>>>8&255};poly1305.prototype.update=function(e,t,n){var r,i;if(this.leftover){i=16-this.leftover;if(i>n)i=n;for(r=0;r<i;r++)this.buffer[this.leftover+r]=e[t+r];n-=i;t+=i;this.leftover+=i;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}if(n>=16){i=n-n%16;this.blocks(e,t,i);t+=i;n-=i}if(n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=e[t+r];this.leftover+=n}};function crypto_onetimeauth(e,t,n,r,i,s){var o=new poly1305(s);o.update(n,r,i);o.finish(e,t);return 0}function crypto_onetimeauth_verify(e,t,n,r,i,s){var o=new Uint8Array(16);crypto_onetimeauth(o,0,n,r,i,s);return crypto_verify_16(e,t,o,0)}function crypto_secretbox(e,t,n,r,i){var s;if(n<32)return-1;crypto_stream_xor(e,0,t,0,n,r,i);crypto_onetimeauth(e,16,e,32,n-32,e);for(s=0;s<16;s++)e[s]=0;return 0}function crypto_secretbox_open(e,t,n,r,i){var s;var o=new Uint8Array(32);if(n<32)return-1;crypto_stream(o,0,32,r,i);if(crypto_onetimeauth_verify(t,16,t,32,n-32,o)!==0)return-1;crypto_stream_xor(e,0,t,0,n,r,i);for(s=0;s<32;s++)e[s]=0;return 0}function set25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function car25519(e){var t,n,r=1;for(t=0;t<16;t++){n=e[t]+r+65535;r=Math.floor(n/65536);e[t]=n-r*65536}e[0]+=r-1+37*(r-1)}function sel25519(e,t,n){var r,i=~(n-1);for(var s=0;s<16;s++){r=i&(e[s]^t[s]);e[s]^=r;t[s]^=r}}function pack25519(e,t){var n,r,i;var s=gf(),o=gf();for(n=0;n<16;n++)o[n]=t[n];car25519(o);car25519(o);car25519(o);for(r=0;r<2;r++){s[0]=o[0]-65517;for(n=1;n<15;n++){s[n]=o[n]-65535-(s[n-1]>>16&1);s[n-1]&=65535}s[15]=o[15]-32767-(s[14]>>16&1);i=s[15]>>16&1;s[14]&=65535;sel25519(o,s,1-i)}for(n=0;n<16;n++){e[2*n]=o[n]&255;e[2*n+1]=o[n]>>8}}function neq25519(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);pack25519(n,e);pack25519(r,t);return crypto_verify_32(n,0,r,0)}function par25519(e){var t=new Uint8Array(32);pack25519(t,e);return t[0]&1}function unpack25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function A(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]+n[r]}function Z(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]-n[r]}function M(e,t,n){var r,i,s=0,o=0,f=0,h=0,u=0,l=0,g=0,p=0,_=0,E=0,y=0,I=0,b=0,w=0,m=0,C=0,B=0,k=0,R=0,v=0,T=0,U=0,P=0,O=0,L=0,D=0,Q=0,x=0,W=0,q=0,G=0,$=n[0],Y=n[1],V=n[2],j=n[3],z=n[4],J=n[5],ee=n[6],te=n[7],ne=n[8],re=n[9],ie=n[10],se=n[11],oe=n[12],ae=n[13],ce=n[14],fe=n[15];r=t[0];s+=r*$;o+=r*Y;f+=r*V;h+=r*j;u+=r*z;l+=r*J;g+=r*ee;p+=r*te;_+=r*ne;E+=r*re;y+=r*ie;I+=r*se;b+=r*oe;w+=r*ae;m+=r*ce;C+=r*fe;r=t[1];o+=r*$;f+=r*Y;h+=r*V;u+=r*j;l+=r*z;g+=r*J;p+=r*ee;_+=r*te;E+=r*ne;y+=r*re;I+=r*ie;b+=r*se;w+=r*oe;m+=r*ae;C+=r*ce;B+=r*fe;r=t[2];f+=r*$;h+=r*Y;u+=r*V;l+=r*j;g+=r*z;p+=r*J;_+=r*ee;E+=r*te;y+=r*ne;I+=r*re;b+=r*ie;w+=r*se;m+=r*oe;C+=r*ae;B+=r*ce;k+=r*fe;r=t[3];h+=r*$;u+=r*Y;l+=r*V;g+=r*j;p+=r*z;_+=r*J;E+=r*ee;y+=r*te;I+=r*ne;b+=r*re;w+=r*ie;m+=r*se;C+=r*oe;B+=r*ae;k+=r*ce;R+=r*fe;r=t[4];u+=r*$;l+=r*Y;g+=r*V;p+=r*j;_+=r*z;E+=r*J;y+=r*ee;I+=r*te;b+=r*ne;w+=r*re;m+=r*ie;C+=r*se;B+=r*oe;k+=r*ae;R+=r*ce;v+=r*fe;r=t[5];l+=r*$;g+=r*Y;p+=r*V;_+=r*j;E+=r*z;y+=r*J;I+=r*ee;b+=r*te;w+=r*ne;m+=r*re;C+=r*ie;B+=r*se;k+=r*oe;R+=r*ae;v+=r*ce;T+=r*fe;r=t[6];g+=r*$;p+=r*Y;_+=r*V;E+=r*j;y+=r*z;I+=r*J;b+=r*ee;w+=r*te;m+=r*ne;C+=r*re;B+=r*ie;k+=r*se;R+=r*oe;v+=r*ae;T+=r*ce;U+=r*fe;r=t[7];p+=r*$;_+=r*Y;E+=r*V;y+=r*j;I+=r*z;b+=r*J;w+=r*ee;m+=r*te;C+=r*ne;B+=r*re;k+=r*ie;R+=r*se;v+=r*oe;T+=r*ae;U+=r*ce;P+=r*fe;r=t[8];_+=r*$;E+=r*Y;y+=r*V;I+=r*j;b+=r*z;w+=r*J;m+=r*ee;C+=r*te;B+=r*ne;k+=r*re;R+=r*ie;v+=r*se;T+=r*oe;U+=r*ae;P+=r*ce;O+=r*fe;r=t[9];E+=r*$;y+=r*Y;I+=r*V;b+=r*j;w+=r*z;m+=r*J;C+=r*ee;B+=r*te;k+=r*ne;R+=r*re;v+=r*ie;T+=r*se;U+=r*oe;P+=r*ae;O+=r*ce;L+=r*fe;r=t[10];y+=r*$;I+=r*Y;b+=r*V;w+=r*j;m+=r*z;C+=r*J;B+=r*ee;k+=r*te;R+=r*ne;v+=r*re;T+=r*ie;U+=r*se;P+=r*oe;O+=r*ae;L+=r*ce;D+=r*fe;r=t[11];I+=r*$;b+=r*Y;w+=r*V;m+=r*j;C+=r*z;B+=r*J;k+=r*ee;R+=r*te;v+=r*ne;T+=r*re;U+=r*ie;P+=r*se;O+=r*oe;L+=r*ae;D+=r*ce;Q+=r*fe;r=t[12];b+=r*$;w+=r*Y;m+=r*V;C+=r*j;B+=r*z;k+=r*J;R+=r*ee;v+=r*te;T+=r*ne;U+=r*re;P+=r*ie;O+=r*se;L+=r*oe;D+=r*ae;Q+=r*ce;x+=r*fe;r=t[13];w+=r*$;m+=r*Y;C+=r*V;B+=r*j;k+=r*z;R+=r*J;v+=r*ee;T+=r*te;U+=r*ne;P+=r*re;O+=r*ie;L+=r*se;D+=r*oe;Q+=r*ae;x+=r*ce;W+=r*fe;r=t[14];m+=r*$;C+=r*Y;B+=r*V;k+=r*j;R+=r*z;v+=r*J;T+=r*ee;U+=r*te;P+=r*ne;O+=r*re;L+=r*ie;D+=r*se;Q+=r*oe;x+=r*ae;W+=r*ce;q+=r*fe;r=t[15];C+=r*$;B+=r*Y;k+=r*V;R+=r*j;v+=r*z;T+=r*J;U+=r*ee;P+=r*te;O+=r*ne;L+=r*re;D+=r*ie;Q+=r*se;x+=r*oe;W+=r*ae;q+=r*ce;G+=r*fe;s+=38*B;o+=38*k;f+=38*R;h+=38*v;u+=38*T;l+=38*U;g+=38*P;p+=38*O;_+=38*L;E+=38*D;y+=38*Q;I+=38*x;b+=38*W;w+=38*q;m+=38*G;i=1;r=s+i+65535;i=Math.floor(r/65536);s=r-i*65536;r=o+i+65535;i=Math.floor(r/65536);o=r-i*65536;r=f+i+65535;i=Math.floor(r/65536);f=r-i*65536;r=h+i+65535;i=Math.floor(r/65536);h=r-i*65536;r=u+i+65535;i=Math.floor(r/65536);u=r-i*65536;r=l+i+65535;i=Math.floor(r/65536);l=r-i*65536;r=g+i+65535;i=Math.floor(r/65536);g=r-i*65536;r=p+i+65535;i=Math.floor(r/65536);p=r-i*65536;r=_+i+65535;i=Math.floor(r/65536);_=r-i*65536;r=E+i+65535;i=Math.floor(r/65536);E=r-i*65536;r=y+i+65535;i=Math.floor(r/65536);y=r-i*65536;r=I+i+65535;i=Math.floor(r/65536);I=r-i*65536;r=b+i+65535;i=Math.floor(r/65536);b=r-i*65536;r=w+i+65535;i=Math.floor(r/65536);w=r-i*65536;r=m+i+65535;i=Math.floor(r/65536);m=r-i*65536;r=C+i+65535;i=Math.floor(r/65536);C=r-i*65536;s+=i-1+37*(i-1);i=1;r=s+i+65535;i=Math.floor(r/65536);s=r-i*65536;r=o+i+65535;i=Math.floor(r/65536);o=r-i*65536;r=f+i+65535;i=Math.floor(r/65536);f=r-i*65536;r=h+i+65535;i=Math.floor(r/65536);h=r-i*65536;r=u+i+65535;i=Math.floor(r/65536);u=r-i*65536;r=l+i+65535;i=Math.floor(r/65536);l=r-i*65536;r=g+i+65535;i=Math.floor(r/65536);g=r-i*65536;r=p+i+65535;i=Math.floor(r/65536);p=r-i*65536;r=_+i+65535;i=Math.floor(r/65536);_=r-i*65536;r=E+i+65535;i=Math.floor(r/65536);E=r-i*65536;r=y+i+65535;i=Math.floor(r/65536);y=r-i*65536;r=I+i+65535;i=Math.floor(r/65536);I=r-i*65536;r=b+i+65535;i=Math.floor(r/65536);b=r-i*65536;r=w+i+65535;i=Math.floor(r/65536);w=r-i*65536;r=m+i+65535;i=Math.floor(r/65536);m=r-i*65536;r=C+i+65535;i=Math.floor(r/65536);C=r-i*65536;s+=i-1+37*(i-1);e[0]=s;e[1]=o;e[2]=f;e[3]=h;e[4]=u;e[5]=l;e[6]=g;e[7]=p;e[8]=_;e[9]=E;e[10]=y;e[11]=I;e[12]=b;e[13]=w;e[14]=m;e[15]=C}function S(e,t){M(e,t,t)}function inv25519(e,t){var n=gf();var r;for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--){S(n,n);if(r!==2&&r!==4)M(n,n,t)}for(r=0;r<16;r++)e[r]=n[r]}function pow2523(e,t){var n=gf();var r;for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--){S(n,n);if(r!==1)M(n,n,t)}for(r=0;r<16;r++)e[r]=n[r]}function crypto_scalarmult(e,t,n){var r=new Uint8Array(32);var i=new Float64Array(80),s,f;var h=gf(),u=gf(),l=gf(),g=gf(),p=gf(),_=gf();for(f=0;f<31;f++)r[f]=t[f];r[31]=t[31]&127|64;r[0]&=248;unpack25519(i,n);for(f=0;f<16;f++){u[f]=i[f];g[f]=h[f]=l[f]=0}h[0]=g[0]=1;for(f=254;f>=0;--f){s=r[f>>>3]>>>(f&7)&1;sel25519(h,u,s);sel25519(l,g,s);A(p,h,l);Z(h,h,l);A(l,u,g);Z(u,u,g);S(g,p);S(_,h);M(h,l,h);M(l,u,p);A(p,h,l);Z(h,h,l);S(u,h);Z(l,g,_);M(h,l,o);A(h,h,g);M(l,l,h);M(h,g,_);M(g,u,i);S(u,p);sel25519(h,u,s);sel25519(l,g,s)}for(f=0;f<16;f++){i[f+16]=h[f];i[f+32]=l[f];i[f+48]=u[f];i[f+64]=g[f]}var E=i.subarray(32);var y=i.subarray(16);inv25519(E,E);M(y,y,E);pack25519(e,y);return 0}function crypto_scalarmult_base(e,t){return crypto_scalarmult(e,t,r)}function crypto_box_keypair(e,t){randombytes(t,32);return crypto_scalarmult_base(e,t)}function crypto_box_beforenm(e,n,r){var i=new Uint8Array(32);crypto_scalarmult(i,r,n);return crypto_core_hsalsa20(e,t,i,p)}var _=crypto_secretbox;var E=crypto_secretbox_open;function crypto_box(e,t,n,r,i,s){var o=new Uint8Array(32);crypto_box_beforenm(o,i,s);return _(e,t,n,r,o)}function crypto_box_open(e,t,n,r,i,s){var o=new Uint8Array(32);crypto_box_beforenm(o,i,s);return E(e,t,n,r,o)}var y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(e,t,n,r){var i=new Int32Array(16),s=new Int32Array(16),o,f,h,u,l,g,p,_,E,I,b,w,m,C,B,k,R,v,T,U,P,O,L,D,Q,x;var W=e[0],q=e[1],G=e[2],$=e[3],Y=e[4],V=e[5],j=e[6],z=e[7],J=t[0],ee=t[1],te=t[2],ne=t[3],re=t[4],ie=t[5],se=t[6],oe=t[7];var ae=0;while(r>=128){for(T=0;T<16;T++){U=8*T+ae;i[T]=n[U+0]<<24|n[U+1]<<16|n[U+2]<<8|n[U+3];s[T]=n[U+4]<<24|n[U+5]<<16|n[U+6]<<8|n[U+7]}for(T=0;T<80;T++){o=W;f=q;h=G;u=$;l=Y;g=V;p=j;_=z;E=J;I=ee;b=te;w=ne;m=re;C=ie;B=se;k=oe;P=z;O=oe;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=(Y>>>14|re<<32-14)^(Y>>>18|re<<32-18)^(re>>>41-32|Y<<32-(41-32));O=(re>>>14|Y<<32-14)^(re>>>18|Y<<32-18)^(Y>>>41-32|re<<32-(41-32));L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;P=Y&V^~Y&j;O=re&ie^~re&se;L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;P=y[T*2];O=y[T*2+1];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;P=i[T%16];O=s[T%16];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;R=Q&65535|x<<16;v=L&65535|D<<16;P=R;O=v;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=(W>>>28|J<<32-28)^(J>>>34-32|W<<32-(34-32))^(J>>>39-32|W<<32-(39-32));O=(J>>>28|W<<32-28)^(W>>>34-32|J<<32-(34-32))^(W>>>39-32|J<<32-(39-32));L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;P=W&q^W&G^q&G;O=J&ee^J&te^ee&te;L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;_=Q&65535|x<<16;k=L&65535|D<<16;P=u;O=w;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=R;O=v;L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;u=Q&65535|x<<16;w=L&65535|D<<16;q=o;G=f;$=h;Y=u;V=l;j=g;z=p;W=_;ee=E;te=I;ne=b;re=w;ie=m;se=C;oe=B;J=k;if(T%16===15){for(U=0;U<16;U++){P=i[U];O=s[U];L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=i[(U+9)%16];O=s[(U+9)%16];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;R=i[(U+1)%16];v=s[(U+1)%16];P=(R>>>1|v<<32-1)^(R>>>8|v<<32-8)^R>>>7;O=(v>>>1|R<<32-1)^(v>>>8|R<<32-8)^(v>>>7|R<<32-7);L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;R=i[(U+14)%16];v=s[(U+14)%16];P=(R>>>19|v<<32-19)^(v>>>61-32|R<<32-(61-32))^R>>>6;O=(v>>>19|R<<32-19)^(R>>>61-32|v<<32-(61-32))^(v>>>6|R<<32-6);L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;i[U]=Q&65535|x<<16;s[U]=L&65535|D<<16}}}P=W;O=J;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[0];O=t[0];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[0]=W=Q&65535|x<<16;t[0]=J=L&65535|D<<16;P=q;O=ee;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[1];O=t[1];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[1]=q=Q&65535|x<<16;t[1]=ee=L&65535|D<<16;P=G;O=te;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[2];O=t[2];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[2]=G=Q&65535|x<<16;t[2]=te=L&65535|D<<16;P=$;O=ne;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[3];O=t[3];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[3]=$=Q&65535|x<<16;t[3]=ne=L&65535|D<<16;P=Y;O=re;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[4];O=t[4];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[4]=Y=Q&65535|x<<16;t[4]=re=L&65535|D<<16;P=V;O=ie;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[5];O=t[5];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[5]=V=Q&65535|x<<16;t[5]=ie=L&65535|D<<16;P=j;O=se;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[6];O=t[6];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[6]=j=Q&65535|x<<16;t[6]=se=L&65535|D<<16;P=z;O=oe;L=O&65535;D=O>>>16;Q=P&65535;x=P>>>16;P=e[7];O=t[7];L+=O&65535;D+=O>>>16;Q+=P&65535;x+=P>>>16;D+=L>>>16;Q+=D>>>16;x+=Q>>>16;e[7]=z=Q&65535|x<<16;t[7]=oe=L&65535|D<<16;ae+=128;r-=128}return r}function crypto_hash(e,t,n){var r=new Int32Array(8),i=new Int32Array(8),s=new Uint8Array(256),o,f=n;r[0]=1779033703;r[1]=3144134277;r[2]=1013904242;r[3]=2773480762;r[4]=1359893119;r[5]=2600822924;r[6]=528734635;r[7]=1541459225;i[0]=4089235720;i[1]=2227873595;i[2]=4271175723;i[3]=1595750129;i[4]=2917565137;i[5]=725511199;i[6]=4215389547;i[7]=327033209;crypto_hashblocks_hl(r,i,t,n);n%=128;for(o=0;o<n;o++)s[o]=t[f-n+o];s[n]=128;n=256-128*(n<112?1:0);s[n-9]=0;ts64(s,n-8,f/536870912|0,f<<3);crypto_hashblocks_hl(r,i,s,n);for(o=0;o<8;o++)ts64(e,8*o,r[o],i[o]);return 0}function add(e,t){var n=gf(),r=gf(),i=gf(),s=gf(),o=gf(),f=gf(),u=gf(),l=gf(),g=gf();Z(n,e[1],e[0]);Z(g,t[1],t[0]);M(n,n,g);A(r,e[0],e[1]);A(g,t[0],t[1]);M(r,r,g);M(i,e[3],t[3]);M(i,i,h);M(s,e[2],t[2]);A(s,s,s);Z(o,r,n);Z(f,s,i);A(u,s,i);A(l,r,n);M(e[0],o,f);M(e[1],l,u);M(e[2],u,f);M(e[3],o,l)}function cswap(e,t,n){var r;for(r=0;r<4;r++){sel25519(e[r],t[r],n)}}function pack(e,t){var n=gf(),r=gf(),i=gf();inv25519(i,t[2]);M(n,t[0],i);M(r,t[1],i);pack25519(e,r);e[31]^=par25519(n)<<7}function scalarmult(e,t,n){var r,o;set25519(e[0],i);set25519(e[1],s);set25519(e[2],s);set25519(e[3],i);for(o=255;o>=0;--o){r=n[o/8|0]>>(o&7)&1;cswap(e,t,r);add(t,e);add(e,e);cswap(e,t,r)}}function scalarbase(e,t){var n=[gf(),gf(),gf(),gf()];set25519(n[0],u);set25519(n[1],l);set25519(n[2],s);M(n[3],u,l);scalarmult(e,n,t)}function crypto_sign_keypair(e,t,n){var r=new Uint8Array(64);var i=[gf(),gf(),gf(),gf()];var s;if(!n)randombytes(t,32);crypto_hash(r,t,32);r[0]&=248;r[31]&=127;r[31]|=64;scalarbase(i,r);pack(e,i);for(s=0;s<32;s++)t[s+32]=e[s];return 0}var I=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(e,t){var n,r,i,s;for(r=63;r>=32;--r){n=0;for(i=r-32,s=r-12;i<s;++i){t[i]+=n-16*t[r]*I[i-(r-32)];n=t[i]+128>>8;t[i]-=n*256}t[i]+=n;t[r]=0}n=0;for(i=0;i<32;i++){t[i]+=n-(t[31]>>4)*I[i];n=t[i]>>8;t[i]&=255}for(i=0;i<32;i++)t[i]-=n*I[i];for(r=0;r<32;r++){t[r+1]+=t[r]>>8;e[r]=t[r]&255}}function reduce(e){var t=new Float64Array(64),n;for(n=0;n<64;n++)t[n]=e[n];for(n=0;n<64;n++)e[n]=0;modL(e,t)}function crypto_sign(e,t,n,r){var i=new Uint8Array(64),s=new Uint8Array(64),o=new Uint8Array(64);var f,h,u=new Float64Array(64);var l=[gf(),gf(),gf(),gf()];crypto_hash(i,r,32);i[0]&=248;i[31]&=127;i[31]|=64;var g=n+64;for(f=0;f<n;f++)e[64+f]=t[f];for(f=0;f<32;f++)e[32+f]=i[32+f];crypto_hash(o,e.subarray(32),n+32);reduce(o);scalarbase(l,o);pack(e,l);for(f=32;f<64;f++)e[f]=r[f];crypto_hash(s,e,n+64);reduce(s);for(f=0;f<64;f++)u[f]=0;for(f=0;f<32;f++)u[f]=o[f];for(f=0;f<32;f++){for(h=0;h<32;h++){u[f+h]+=s[f]*i[h]}}modL(e.subarray(32),u);return g}function unpackneg(e,t){var n=gf(),r=gf(),o=gf(),h=gf(),u=gf(),l=gf(),p=gf();set25519(e[2],s);unpack25519(e[1],t);S(o,e[1]);M(h,o,f);Z(o,o,e[2]);A(h,e[2],h);S(u,h);S(l,u);M(p,l,u);M(n,p,o);M(n,n,h);pow2523(n,n);M(n,n,o);M(n,n,h);M(n,n,h);M(e[0],n,h);S(r,e[0]);M(r,r,h);if(neq25519(r,o))M(e[0],e[0],g);S(r,e[0]);M(r,r,h);if(neq25519(r,o))return-1;if(par25519(e[0])===t[31]>>7)Z(e[0],i,e[0]);M(e[3],e[0],e[1]);return 0}function crypto_sign_open(e,t,n,r){var i,s;var o=new Uint8Array(32),f=new Uint8Array(64);var h=[gf(),gf(),gf(),gf()],u=[gf(),gf(),gf(),gf()];s=-1;if(n<64)return-1;if(unpackneg(u,r))return-1;for(i=0;i<n;i++)e[i]=t[i];for(i=0;i<32;i++)e[i+32]=r[i];crypto_hash(f,e,n);reduce(f);scalarmult(h,u,f);scalarbase(u,t.subarray(32));add(h,u);pack(o,h);n-=64;if(crypto_verify_32(t,0,o,0)){for(i=0;i<n;i++)e[i]=0;return-1}for(i=0;i<n;i++)e[i]=t[i+64];s=n;return s}var b=32,w=24,m=32,C=16,B=32,k=32,R=32,v=32,T=32,U=w,P=m,O=C,L=64,D=32,Q=64,x=32,W=64;e.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:_,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:b,crypto_secretbox_NONCEBYTES:w,crypto_secretbox_ZEROBYTES:m,crypto_secretbox_BOXZEROBYTES:C,crypto_scalarmult_BYTES:B,crypto_scalarmult_SCALARBYTES:k,crypto_box_PUBLICKEYBYTES:R,crypto_box_SECRETKEYBYTES:v,crypto_box_BEFORENMBYTES:T,crypto_box_NONCEBYTES:U,crypto_box_ZEROBYTES:P,crypto_box_BOXZEROBYTES:O,crypto_sign_BYTES:L,crypto_sign_PUBLICKEYBYTES:D,crypto_sign_SECRETKEYBYTES:Q,crypto_sign_SEEDBYTES:x,crypto_hash_BYTES:W};function checkLengths(e,t){if(e.length!==b)throw new Error("bad key size");if(t.length!==w)throw new Error("bad nonce size")}function checkBoxLengths(e,t){if(e.length!==R)throw new Error("bad public key size");if(t.length!==v)throw new Error("bad secret key size")}function checkArrayTypes(){var e,t;for(t=0;t<arguments.length;t++){if((e=Object.prototype.toString.call(arguments[t]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+e+", use Uint8Array")}}function cleanup(e){for(var t=0;t<e.length;t++)e[t]=0}if(!e.util){e.util={};e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}}e.randomBytes=function(e){var t=new Uint8Array(e);randombytes(t,e);return t};e.secretbox=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var r=new Uint8Array(m+e.length);var i=new Uint8Array(r.length);for(var s=0;s<e.length;s++)r[s+m]=e[s];crypto_secretbox(i,r,r.length,t,n);return i.subarray(C)};e.secretbox.open=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var r=new Uint8Array(C+e.length);var i=new Uint8Array(r.length);for(var s=0;s<e.length;s++)r[s+C]=e[s];if(r.length<32)return false;if(crypto_secretbox_open(i,r,r.length,t,n)!==0)return false;return i.subarray(m)};e.secretbox.keyLength=b;e.secretbox.nonceLength=w;e.secretbox.overheadLength=C;e.scalarMult=function(e,t){checkArrayTypes(e,t);if(e.length!==k)throw new Error("bad n size");if(t.length!==B)throw new Error("bad p size");var n=new Uint8Array(B);crypto_scalarmult(n,e,t);return n};e.scalarMult.base=function(e){checkArrayTypes(e);if(e.length!==k)throw new Error("bad n size");var t=new Uint8Array(B);crypto_scalarmult_base(t,e);return t};e.scalarMult.scalarLength=k;e.scalarMult.groupElementLength=B;e.box=function(t,n,r,i){var s=e.box.before(r,i);return e.secretbox(t,n,s)};e.box.before=function(e,t){checkArrayTypes(e,t);checkBoxLengths(e,t);var n=new Uint8Array(T);crypto_box_beforenm(n,e,t);return n};e.box.after=e.secretbox;e.box.open=function(t,n,r,i){var s=e.box.before(r,i);return e.secretbox.open(t,n,s)};e.box.open.after=e.secretbox.open;e.box.keyPair=function(){var e=new Uint8Array(R);var t=new Uint8Array(v);crypto_box_keypair(e,t);return{publicKey:e,secretKey:t}};e.box.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==v)throw new Error("bad secret key size");var t=new Uint8Array(R);crypto_scalarmult_base(t,e);return{publicKey:t,secretKey:new Uint8Array(e)}};e.box.publicKeyLength=R;e.box.secretKeyLength=v;e.box.sharedKeyLength=T;e.box.nonceLength=U;e.box.overheadLength=e.secretbox.overheadLength;e.sign=function(e,t){checkArrayTypes(e,t);if(t.length!==Q)throw new Error("bad secret key size");var n=new Uint8Array(L+e.length);crypto_sign(n,e,e.length,t);return n};e.sign.open=function(e,t){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");checkArrayTypes(e,t);if(t.length!==D)throw new Error("bad public key size");var n=new Uint8Array(e.length);var r=crypto_sign_open(n,e,e.length,t);if(r<0)return null;var i=new Uint8Array(r);for(var s=0;s<i.length;s++)i[s]=n[s];return i};e.sign.detached=function(t,n){var r=e.sign(t,n);var i=new Uint8Array(L);for(var s=0;s<i.length;s++)i[s]=r[s];return i};e.sign.detached.verify=function(e,t,n){checkArrayTypes(e,t,n);if(t.length!==L)throw new Error("bad signature size");if(n.length!==D)throw new Error("bad public key size");var r=new Uint8Array(L+e.length);var i=new Uint8Array(L+e.length);var s;for(s=0;s<L;s++)r[s]=t[s];for(s=0;s<e.length;s++)r[s+L]=e[s];return crypto_sign_open(i,r,r.length,n)>=0};e.sign.keyPair=function(){var e=new Uint8Array(D);var t=new Uint8Array(Q);crypto_sign_keypair(e,t);return{publicKey:e,secretKey:t}};e.sign.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==Q)throw new Error("bad secret key size");var t=new Uint8Array(D);for(var n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}};e.sign.keyPair.fromSeed=function(e){checkArrayTypes(e);if(e.length!==x)throw new Error("bad seed size");var t=new Uint8Array(D);var n=new Uint8Array(Q);for(var r=0;r<32;r++)n[r]=e[r];crypto_sign_keypair(t,n,true);return{publicKey:t,secretKey:n}};e.sign.publicKeyLength=D;e.sign.secretKeyLength=Q;e.sign.seedLength=x;e.sign.signatureLength=L;e.hash=function(e){checkArrayTypes(e);var t=new Uint8Array(W);crypto_hash(t,e,e.length);return t};e.hash.hashLength=W;e.verify=function(e,t){checkArrayTypes(e,t);if(e.length===0||t.length===0)return false;if(e.length!==t.length)return false;return vn(e,0,t,0,e.length)===0?true:false};e.setPRNG=function(e){randombytes=e};(function(){var t=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var r=65536;e.setPRNG((function(e,n){var i,s=new Uint8Array(n);for(i=0;i<n;i+=r){t.getRandomValues(s.subarray(i,i+Math.min(n-i,r)))}for(i=0;i<n;i++)e[i]=s[i];cleanup(s)}))}else if(true){t=n(113);if(t&&t.randomBytes){e.setPRNG((function(e,n){var r,i=t.randomBytes(n);for(r=0;r<n;r++)e[r]=i[r];cleanup(i)}))}}})()})(true&&e.exports?e.exports:self.nacl=self.nacl||{})},605:module=>{module.exports=eval("require")("./crypto/build/Release/sshcrypto.node")},143:module=>{module.exports=eval("require")("cpu-features")},491:e=>{"use strict";e.exports=require("assert")},300:e=>{"use strict";e.exports=require("buffer")},81:e=>{"use strict";e.exports=require("child_process")},113:e=>{"use strict";e.exports=require("crypto")},523:e=>{"use strict";e.exports=require("dns")},361:e=>{"use strict";e.exports=require("events")},147:e=>{"use strict";e.exports=require("fs")},685:e=>{"use strict";e.exports=require("http")},687:e=>{"use strict";e.exports=require("https")},808:e=>{"use strict";e.exports=require("net")},17:e=>{"use strict";e.exports=require("path")},781:e=>{"use strict";e.exports=require("stream")},404:e=>{"use strict";e.exports=require("tls")},837:e=>{"use strict";e.exports=require("util")},796:e=>{"use strict";e.exports=require("zlib")},876:e=>{"use strict";e.exports={i8:"1.16.0"}}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var n=__webpack_module_cache__[e]={exports:{}};var r=true;try{__webpack_modules__[e](n,n.exports,__nccwpck_require__);r=false}finally{if(r)delete __webpack_module_cache__[e]}return n.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(597);module.exports=__webpack_exports__})();